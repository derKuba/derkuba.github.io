<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Spass mit Typescript: Spread-Operator AHA-Moment</title><meta name="description" content="Meine Stolperfalle der Woche"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link href="/template/css/prism.css" rel="stylesheet"><link rel="stylesheet" href="/template/css/bulma.min.css"><link rel="stylesheet" href="/template/css/custom.css"><link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="der_kuba"><link rel="alternate" href="/feed/feed.json" type="application/json" title="der_kuba"><script>document.addEventListener("DOMContentLoaded",()=>{const e=Array.prototype.slice.call(document.querySelectorAll(".navbar-burger"),0);e.length>0&&e.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.target,a=document.getElementById(t);e.classList.toggle("is-active"),a.classList.toggle("is-active")})})});</script></head><body><header><div class="container"><nav class="navbar is-transparent"><div class="navbar-brand"><a class="navbar-item navbar-brand__title" href="/">der_kuba </a><a class="navbar-item" href="https://github.com/derKuba">@Github </a><a class="navbar-item" href="https://twitter.com/der_kuba">@Twitter </a><a class="navbar-item" href="https://www.linkedin.com/in/jacob-pawlik-08a40015b/">@LinkedIn</a><div class="navbar-burger" data-target="navigation-items"><span></span> <span></span> <span></span></div></div><div id="navigation-items" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="/">Home </a><a class="navbar-item" href="/posts/">Archiv </a><a class="navbar-item" href="/content/about/">About Me </a><a class="navbar-item" href="/content/impressum.html">Impressum </a><a class="navbar-item" href="/content/datenschutz.html">Datenschutzerklärung</a></div></div></nav></div></header><section class="section"><div class="container"><div class="columns is-centered"><div class="column is-8"><h1 class="title is-3">Spass mit Typescript: Spread-Operator AHA-Moment</h1><div class="post-detail__tags"><h3 class="subtitle is-6"><time datetime="2021-04-24">24 Apr 2021</time></h3><div class="tags"><a href="/tags/typescript/" class="post-tag"><span class="tag is-black">Typescript</span></a></div></div><div class="content post_detail__content"><p>Diese Woche bin ich über den Spread-Operator gestolpert und möchte diese Erfahrung teilen.</p><p>Folgendes Szenario:<br>Ich möchte ein Objekt erstellen, dass aus einem Key &quot;Name eines Testfalls&quot; und als Value ein weiteres Objekt aus benannnte Zahlenpaaren enthält. Ich habe dazu ein Array aus Namen der Testfälle und ein ein Objekt, das ein Objektschema enthält.</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">const</span> testCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">,</span> <span class="token string">"testcase 1"</span><span class="token punctuation">,</span> <span class="token string">"testcase 2"</span><span class="token punctuation">,</span> <span class="token string">"testcase 3"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">     <span class="token string-property property">"first"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        c<span class="token operator">:</span> <span class="token number">0</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token string-property property">"second"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        c<span class="token operator">:</span> <span class="token number">0</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token string-property property">"third"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        c<span class="token operator">:</span> <span class="token number">0</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Aus den Namen und dem Schema, soll dann ein großes Objekt entstehen, das wie folgt aussieht.</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">const</span> testDataDefaults <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token string-property property">"testcase 0"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token string-property property">"first"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            c<span class="token operator">:</span> <span class="token number">0</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">         <span class="token string-property property">"second"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            c<span class="token operator">:</span> <span class="token number">0</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">         <span class="token string-property property">"third"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            c<span class="token operator">:</span> <span class="token number">0</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token operator">...</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Man schreibt ganz schnell eine kleine Schleife über die Namen der Testfälle, initiiert das Sammelobjekt und setzt für jeden Testfall das Schema:</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">const</span> testDataDefaults <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line">testCases<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>testCase <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    testDataDefaults<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token operator">...</span>numbers<span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Die Zeile {...numbers} erzeugt ein Klon des Schemas und weißt ihm dann dem Namen des Testfalls zu.</p><p>Dieses DefaultObjekt wird dann im nächsten Schritt mit echten Daten gefüllt. Mein erster Ansatz ohne viel nachzudenken war wie folgt:</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line">testDataDefaults<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span><br><span class="highlight-line">testDataDefaults<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span><br><span class="highlight-line">testDataDefaults<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span></code></pre><p>Meine Erwartung war, dass im ersten Testcase das &quot;first&quot;-Objekt an der Stelle &quot;a&quot; die Zahl 23 enthält. Die Wahrheit sah anders aus:</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 2'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token operator">...</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Waaaaaat.</p><p>Laut <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_f%C3%BCr_objektliterale">https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_für_objektliterale</a> hätte doch alles klappen sollen.</p><p>Schnell mal googeln wie man sonst noch Objekte klonen kann:</p><p><a href="https://www.samanthaming.com/tidbits/70-3-ways-to-clone-objects/">https://www.samanthaming.com/tidbits/70-3-ways-to-clone-objects/</a></p><p>Also nochmal von vorne und das mit allen 3 Lösungen:</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line">tests<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>testCase <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    spreadMapped<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token operator">...</span>numbers<span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    jsonMapped<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">)</span></span><br><span class="highlight-line">    objectAssignMapped<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span><br><span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span><br><span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">jsonMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span><br><span class="highlight-line">jsonMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span><br><span class="highlight-line">jsonMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">objectAssignMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span><br><span class="highlight-line">objectAssignMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span><br><span class="highlight-line">objectAssignMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span></code></pre><p>und das Ergebnis ist auch etwas durchwachsen:</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// spread</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token operator">...</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token comment">// json</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token operator">...</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">// Object assign</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token operator">...</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Der Spreadoperator und das Object.assign halten nicht so ganz was sie im ersten Moment versprechen. Ich bin über die Formulierung &quot;flache Klonen&quot; gestolpert. Es wird zwar das Defaultobjekt geklont, allerdings bleiben die Referenzen von &quot;first&quot;, &quot;second&quot;, &quot;third&quot; erhalten. Das JSON-Konstrukt geht über das flache Klonen hinaus.</p><p>Die Zuweisung über spreadMapped[&quot;testcase 0&quot;].first.a = 23; funktioniert nicht. Man muss das zugewiesene Object mit einem frischen Objekt überschreiben:</p><pre class="language-typescript"><code class="language-typescript"><span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token operator">...</span>spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token operator">...</span>spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">,</span></span><br><span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">23</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">// output</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Das war mein hartes Learning der Woche. Code gibts unter<br><a href="https://github.com/derKuba/fun-with-typescript/tree/main/240121-spread-aha-moment">Code gibts unter</a></p><p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href="https://twitter.com/der_kuba">Twitter</a></p><hr><ul class="post-navigation"><li>Nächster Artikel: <a href="/content/posts/0521/flutter-export-sqlite-db/">How to export SQlite Database File in Flutter (Android)</a></li><li>Vorheriger Artikel: <a href="/content/posts/0421/so-klappt-jedes-vorstellungsgespraech/">So klappt fast jedes Vorstellungsgespräch</a></li></ul></div></div></div></div></section><footer class="footer"><hr><div class="content has-text-centered"><p>der_kuba - 2021-2023 - <a href="/content/impressum.html">Impressum</a> - <a href="/content/datenschutz.html">Datenschutzerklärung</a></p></div></footer></body></html>