<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Storybook im Einsatz</title><meta name="description" content="Wie stellt man Storybook ein?"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link href="/template/css/prism.css" rel="stylesheet"><link rel="stylesheet" href="/template/css/bulma.min.css"><link rel="stylesheet" href="/template/css/custom.css"><link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="der_kuba"><link rel="alternate" href="/feed/feed.json" type="application/json" title="der_kuba"><script>document.addEventListener("DOMContentLoaded",()=>{const e=Array.prototype.slice.call(document.querySelectorAll(".navbar-burger"),0);e.length>0&&e.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.target,a=document.getElementById(t);e.classList.toggle("is-active"),a.classList.toggle("is-active")})})});</script></head><body><header><div class="container"><nav class="navbar is-transparent"><div class="navbar-brand"><a class="navbar-item navbar-brand__title" href="/">der_kuba </a><a class="navbar-item" href="https://github.com/derKuba">@Github </a><a class="navbar-item" href="https://twitter.com/der_kuba">@Twitter</a><div class="navbar-burger" data-target="navigation-items"><span></span> <span></span> <span></span></div></div><div id="navigation-items" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="/">Home </a><a class="navbar-item" href="/posts/">Archive </a><a class="navbar-item" href="/content/about/">About Me </a><a class="navbar-item" href="/content/impressum.html">Impressum </a><a class="navbar-item" href="/content/datenschutz.html">Datenschutzerklärung</a></div></div></nav></div></header><section class="section"><div class="container"><div class="columns is-centered"><div class="column is-8"><h1 class="title is-3">Storybook im Einsatz</h1><div class="post-detail__tags"><h3 class="subtitle is-6"><time datetime="2021-10-15">15 Oct 2021</time></h3><div class="tags"><a href="/tags/stencil/" class="post-tag"><span class="tag is-black">Stencil </span></a><a href="/tags/storybook/" class="post-tag"><span class="tag is-primary">Storybook</span></a></div></div><div class="content post_detail__content"><p>In meinem letzten Artikel habe ich <a href="https://storybook.js.org/">Storybook</a> vorgestellt. Heute möchte ich die Bedienung erklären. Es ist ein tolles Tool mit vielen Möglichkeiten, um eure Komponenten zu entwickeln, zu katalogisieren oder sogar zu testen. Dazu gibt es die Möglichkeit das Programm durch Addons zu erweitern. Es gibt eine große Auswahl an bestehenden Addons und dazu noch eine API, um selber eigenen Addons zu entwickeln. Dazu gibt es bald einen eigenen Artikel.</p><p>Ich stelle euch jetzt vor:</p><ul><li>Wie ist Storybook aufgebaut?</li><li>Wie ist meine Komponente dokumentiert?</li><li>Wie dynamisiere und dokumentiere ich die Properties meiner Komponente?</li><li>Wie installiere ich ein Addon?</li></ul><h4 id="wie-ist-storybook-aufgebaut%3F" tabindex="-1">Wie ist Storybook aufgebaut? <a class="direct-link" href="#wie-ist-storybook-aufgebaut%3F">#</a></h4><p><img src="/content/img/1021/storybook-overview.png" alt="Storybook aufbau" title="Aufbau Storybook"></p><div class="has-text-right image-subline">Bild 1: Aufbau Storybook</div><p>Ich habe Storybook in seine wesentlichen Bereiche eingeteilt:</p><p><strong>Grün - linker Bereich</strong><br>Die Seitenleiste enthält eine <strong><em>Suche</em></strong>, die alle bestehenden Komponenten durchsucht. Dabei wird nach der Zeichenkette innerhalb des Namens gesucht.<br>Über der Suchleiste ist ein Burger-Icon, das ein Menü öffnet. Darin befinden sich Links zu den Releasenotes und der About-Seite. Aber viel wichtiger sind die <strong><em>Shortcuts für die Tastatur</em></strong></p><p><strong>Rot - oberer Bereich</strong><br>Die obere Leiste enthält die <strong><em>Navigation</em></strong> zur Malfläche, in denen die Komponente gerendert wird oder zur Dokumentationsansicht, in der man weitere Informationen zur Komponente hinterlegen kann. Die übrigen Icons enthalten <strong><em>Werkzeuge zur Darstellung</em></strong>.</p><p><img src="/content/img/1021/storybook-tools.gif" alt="Storybook Tools" title="Storybook Tools"></p><p>Sie beinhalten von links nach rechts folgende Funktionen:</p><ul><li>Vergrößern / Zoomen</li><li>Verkleinern / Zoomout</li><li>Zurücksetzen des Zooms</li><li>Hintergrund der Malfläche ändern (hell/dunkel)</li><li>Gitternetz ein/ausblenden</li><li>Anzeige/Größe der Komponente in mobiler Ansicht (klein, groß) oder Tablet</li><li>Messfunktion (Komponenten werden markiert und die Pixelgröße angegeben)</li><li>Umrandung der Komponente anzeigen</li><li>Vollbild</li><li>Komponente im neuen Tab/Reiter öffnen</li><li>Link zur Seite kopieren</li></ul><div class="has-text-right image-subline">Bild 2*: Animation Tools</div><p><br><strong>Blau - mittlerer Bereich</strong><br>In diesem Bereich, das Canvas oder die Malfläche, befindet sich die gerenderte Komponente, mit der man interagieren kann.</p><p><strong>Gelb - unterer Bereich</strong><br>Der gelbe Bereich beinhaltet die Addon-Leiste. Hier sind standardmäßig der Controls und der Actions Tab vorhanden. Ersterer ermöglicht das dynamische Übergeben von Parametern an die Komponente (Beispiel folgt). Der Actions-Tab gibt dem Nutzer die Möglichkeit Events (Click, Mouseover, etc.) auszuloggen. Ich persönliche arbeite nur mit der Controls-Leiste.</p><p>Insgesamt muss man sagen, dass es sehr übersichtlich gestaltet ist.</p><h4 id="wo-ist-meine-komponente-dokumentiert%3F" tabindex="-1">Wo ist meine Komponente dokumentiert? <a class="direct-link" href="#wo-ist-meine-komponente-dokumentiert%3F">#</a></h4><p>Klickt man in dem rot markierten Bereich auf den Knopf <strong><em>Docs</em></strong> kommt man in die Beschreibung der Komponente:</p><p><img src="/content/img/1021/storybook-docs.png" alt="Storybook Docs" title="Storybook Docs"></p><div class="has-text-right image-subline">Bild 3: Dokumenationsansicht</div><p>Der Aufbau ist übersichtlich. Es beginnt mit einer Leiste, die eine Zoom-Funktion hat. Darunter befindet sich die gerenderte Komponente. Diese Ansicht hat im rechten, unteren Rand einen Knopf, der den dazugehörigen Code einblendet (im Bild bereits ausgeklappt). Wiederum unter der Malfläche ist eine Tabelle, in der man die Properties der Komponente konfigurieren kann. Allerdings erscheint diese Tabelle nur, wenn dies konfiguriert wird.</p><h4 id="wie-dynamisiere-und-dokumentiere-ich-die-properties-meiner-komponente%3F" tabindex="-1">Wie dynamisiere und dokumentiere ich die Properties meiner Komponente? <a class="direct-link" href="#wie-dynamisiere-und-dokumentiere-ich-die-properties-meiner-komponente%3F">#</a></h4><p>Zunächst muss man wissen welche Properties die Komponente hat und welche man dynamisieren möchte. Mit Dynamisierung meine ich die Möglichkeit die Properties zur Laufzeit zu verändern. So kann man zum Beispiel das Design herausfordern und extra lange Labels ausprobieren. In den großen Frameworks wie React werden die Controls sogar automatisch erkannt. Ist dies nicht möglich (wie z.B. in StencilJS) muss man dies händisch machen. Dazu erweitert man in der Story der Komponente <em>*.stories.tsx</em> das anonyme Objekt um das Attribut <strong><em>argTypes</em></strong>.</p><pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    title<span class="token operator">:</span> <span class="token string">"Content/My-Component"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    parameters<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    argTypes<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre><p>Jede Property erhält nun einen eigenen Eintrag bestehend aus diesen Feldern:</p><ul><li>name -&gt;</li><li>type -&gt; Datentyp und required</li><li>defaultValue -&gt; vorbelegter Wert</li><li>Beschreibung -&gt; hier wird dokumentiert</li><li>control -&gt; Welcher Input-Type wird benötigt</li></ul><p>Ausgefüllt habe ich es exemplarisch für die StencilJS-Starter-Komponente <strong><em>my-component</em></strong>, die einen Vornamen, Mittelnamen und Namen als Property annimmt, um dann eine Grußformel auszugeben:</p><pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    title<span class="token operator">:</span> <span class="token string">"Content/My-Component"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    parameters<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    argTypes<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        firstname<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            name<span class="token operator">:</span> <span class="token string">"firstname"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            type<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> required<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            defaultValue<span class="token operator">:</span> <span class="token string">"Max"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            description<span class="token operator">:</span> <span class="token string">"der Vorname"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">*</span></span><br><span class="highlight-line">            control<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                type<span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        middlename<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            name<span class="token operator">:</span> <span class="token string">"middlename"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            type<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> required<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            defaultValue<span class="token operator">:</span> <span class="token string">"Dabelju"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            description<span class="token operator">:</span> <span class="token string">"zweiter Vorname"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            control<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                type<span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        lastname<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            name<span class="token operator">:</span> <span class="token string">"lastname"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            type<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> required<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            defaultValue<span class="token operator">:</span> <span class="token string">"Nachname"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            description<span class="token operator">:</span> <span class="token string">"von Adelher"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            control<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                type<span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre><p>Der Code erklärt sich selbst. Wer weitere Input-Felder für Select-Listen, Checkboxes, Radiobuttons etc. benötigt, schaut kurz in die <a href="https://storybook.js.org/docs/html/essentials/controls">Doku</a>.</p><p>Die Control-Ansicht in Aktion sieht so aus:</p><p><img src="/content/img/1021/storybook-controls.gif" alt="Storybook Controls" title="Storybook Controls"></p><div class="has-text-right image-subline">Bild 3*: Animation Eingabe</div><p>Zur Eingabe wird die Komponente neu gerendert.</p><br><h4 id="wie-installiere-ich-ein-addon%3F" tabindex="-1">Wie installiere ich ein Addon? <a class="direct-link" href="#wie-installiere-ich-ein-addon%3F">#</a></h4><p>Storybook bietet eine bunte Palette an Erweiterungen an. Ich empfehle jedem mal durch den <a href="https://storybook.js.org/addons">Katalog</a> zu blättern. Ich habe bei der Vorbereitung für diesen Artikel in der <a href="https://next--storybookjs.netlify.app/official-storybook/">Storybook Demo</a> ein zusätzlichen Addon gesehen, dass ich euch vorstellen möchte: <a href="https://storybook.js.org/addons/@storybook/addon-storysource"><strong>Storysource</strong></a>.</p><p>Es fügt dem Addon-Panel den Reiter <em>Story</em> hinzu. In diesem befindet sich nun der Quellcode der Story. So hat man sofort den Einblick wie Storybook funktioniert und auch wie die Komponente aufgebaut ist. Ja, es redundant, weil es so etwas im <em>Docs</em>-Reiter zu finden gibt. Aber dort ist alles in HTML ummantelt. Hier ist der echte Code.</p><p>Wie füge ich das Addon nun hinzu?</p><p>Erst einmal muss ich es meinem Projekt hinzufügen:</p><pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">npm</span> <span class="token function">install</span> @storybook/addon-storysource</span></code></pre><p>Dann muss es in der <em>.storybook/main.js</em> als Addon hinzugefügt werden:</p><pre class="language-ts"><code class="language-ts"><span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    stories<span class="token operator">:</span> <span class="token punctuation">[</span></span><br><span class="highlight-line">        <span class="token string">"../src/**/*.stories.mdx"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token string">"../src/**/*.stories.@(js|jsx|ts|tsx)"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    addons<span class="token operator">:</span> <span class="token punctuation">[</span></span><br><span class="highlight-line">        <span class="token string">"@storybook/addon-links"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token string">"@storybook/addon-essentials"</span><span class="token punctuation">,</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">        <span class="token comment">// für die Standardkonfiguration anhängen</span></span><br><span class="highlight-line">        <span class="token string">"@storybook/addon-storysource"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre><p>Möchte man Einstellungen der Standardkonfiguration ändern, empfiehlt sich folgende Schreibweise:</p><pre class="language-ts"><code class="language-ts"><span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    stories<span class="token operator">:</span> <span class="token punctuation">[</span></span><br><span class="highlight-line">        <span class="token string">"../src/**/*.stories.mdx"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token string">"../src/**/*.stories.@(js|jsx|ts|tsx)"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    addons<span class="token operator">:</span> <span class="token punctuation">[</span></span><br><span class="highlight-line">        <span class="token string">"@storybook/addon-links"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token string">"@storybook/addon-essentials"</span><span class="token punctuation">,</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">        <span class="token punctuation">{</span></span><br><span class="highlight-line">            name<span class="token operator">:</span> <span class="token string">"@storybook/addon-storysource"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            options<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                rule<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                    <span class="token comment">// test: [/\.stories\.jsx?$/], This is default</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">                    <span class="token comment">// achtung, hier benötigt man noch</span></span><br><span class="highlight-line">                    <span class="token comment">// const path = require('path');</span></span><br><span class="highlight-line">                    include<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"../src"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// You can specify directories</span></span><br><span class="highlight-line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">                loaderOptions<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                    prettierConfig<span class="token operator">:</span> <span class="token punctuation">{</span> printWidth<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> singleQuote<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">                sourceLoaderOptions<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                    injectStoryParameters<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span><br><span class="highlight-line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre><p>Das war auch schon alles. Wenn man alles richtig eingestellt hat, erhält man folgendes Bild:</p><p><img src="/content/img/1021/storybook-story-addon.png" alt="Storybook Story Addon" title="Storybook Story Addon"></p><div class="has-text-right image-subline">Bild 4: Richtig installiert</div><p>Ich habe Storybook aufgsetzt und es bei <a href="https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib">Github</a> für euch zur Verfügung gestellt. Auschecken, npm install und los geht es.</p><h4 id="fazit" tabindex="-1">Fazit <a class="direct-link" href="#fazit">#</a></h4><p>Mit der Beantwortung der oberen Fragen, habe ich versucht einen leichten Einstieg in Storybook zu schaffen. Ich habe es in allen professionellen Projekte, an denen ich arbeiten durfte, im Einsatz und möchte es auch nicht missen. Es ist ein sehr gutes Werkzeug.</p><p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href="https://twitter.com/der_kuba">Twitter</a>.<br><br><br>Tausend Dank fürs Lesen!</p><p>Kuba</p><p>* Die kleinen Gif-Animation wurden mit <a href="https://github.com/phw/peek">Peek erstellt - einem Screen Recorder</a>.</p><hr><ul class="post-navigation"><li>Vorheriger Artikel: <a href="/content/posts/1021/stencil-component-lib/">Component Library mit Storybook und StencilJS</a></li></ul></div></div></div></div></section><footer class="footer"><hr><div class="content has-text-centered"><p>der_kuba - 2021 - <a href="/content/impressum.html">Impressum</a> - <a href="/content/datenschutz.html">Datenschutzerklärung</a></p></div></footer></body></html>