<!doctype html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>Verwendung der Component Library aus dem StencilJS Build</title>
        <meta name="description" content="Wie verwende ich die gebauten Komponenten?">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="der_kuba">
        <link rel="alternate" href="/feed/feed.json" type="application/json" title="der_kuba">
        <link rel="stylesheet" href="/assets/css/prism.css">
        <link rel="stylesheet" href="/assets/css/bulma.css">
        <link rel="stylesheet" href="/assets/css/custom.css">
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const e = Array
                    .prototype
                    .slice
                    .call(document.querySelectorAll(".navbar-burger"), 0);
                e.length > 0 && e.forEach(e => {
                    e.addEventListener("click", () => {
                        const t = e.dataset.target,
                            a = document.getElementById(t);
                        e.classList.toggle("is-active"),
                        a.classList.toggle("is-active")
                    })
                })
                const disableDarkMode = () => {
                    const bodyNode = document.querySelector("body");
                    bodyNode
                        .classList
                        .remove("dark-mode")
                        localStorage
                        .setItem('darkMode', 'disabled');
                }
                const enableDarkMode = () => {
                    const bodyNode = document.querySelector("body");
                    bodyNode
                        .classList
                        .add("dark-mode")
                        localStorage
                        .setItem('darkMode', 'enabled');
                }
                const button = document.getElementById("darkmode");
                button.addEventListener("click", () => {
                    const bodyNode = document.querySelector("body");
                    if (bodyNode.classList.contains("dark-mode")) {
                        disableDarkMode();
                    } else {
                        enableDarkMode();
                    }
                })
                if (localStorage.getItem('darkMode') === 'enabled') {
                    enableDarkMode();
                }
            });
        </script>
    </head>
    <body><header>
    <div class="container">
        <nav class="navbar">
            <div class="navbar-brand">
                <a class="navbar-item navbar-brand__title " href="/">
                    der_kuba
                </a>
                <a class="navbar-item" href="https://github.com/derKuba">
                    @Github
                </a>
                <a class="navbar-item" href="https://twitter.com/der_kuba">
                    @Twitter
                </a>
                <a class="navbar-item" href="https://www.linkedin.com/in/jacob-pawlik-08a40015b/">
                    @LinkedIn
                </a>
                <div class="navbar-burger" data-target="navigation-items">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="navigation-items" class="navbar-menu">
                <div class="navbar-end">
                    
                        <a class="navbar-item " href="/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/11nty/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/bulma/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/prism/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/11ty/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/excerpt/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/blog/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/tutorial/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/recruting/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/job-interview/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/typescript/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/flutter/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/sqllite/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/stenciljs/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/nodejs/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/zertifizierung/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/testing/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/hurl/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/podcast/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/halloweb/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/enterjs/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/storybook/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/web/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/safari/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/jest/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/agile/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/scrum/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/test/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/certification/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/allpostsexceptenglish/">
                            Home
                        </a>
                        <a class="navbar-item " href="/tags/englishposts/">
                            Home
                        </a>
                        <a class="navbar-item " href="/posts/">
                            Archiv
                        </a>
                        <a class="navbar-item " href="/about/">
                            About Me
                        </a>
                        <a class="navbar-item " href="/en/">
                            English
                        </a>
                        <a class="navbar-item " href="/content/impressum.html">
                            Impressum
                        </a>
                        <a class="navbar-item " href="/content/datenschutz.html">
                            Datenschutzerklärung
                        </a>
                    <button id="darkmode" alt="dark mode">
                        <svg width="30" height="30">
                            <circle cx="15" cy="15" r="6" fill="currentColor"/>
                            <line id="ray" stroke="currentColor" stroke-width="2" stroke-linecap="round" x1="15" y1="1" x2="15" y2="4"></line>
                            <use href="#ray" transform="rotate(45 15 15)"/>
                            <use href="#ray" transform="rotate(90 15 15)"/>
                            <use href="#ray" transform="rotate(135 15 15)"/>
                            <use href="#ray" transform="rotate(180 15 15)"/>
                            <use href="#ray" transform="rotate(225 15 15)"/>
                            <use href="#ray" transform="rotate(270 15 15)"/>
                            <use href="#ray" transform="rotate(315 15 15)"/>
                        </svg>
                    </button>
                    <!-- special thanks to https://www.freecodecamp.org/news/how-to-handle-dark-mode-with-css-and-javascript/ -->
                </div>
            </div>
        </nav>
    </div>
</header>
        
<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <h1 class="title is-3">Verwendung der Component Library aus dem StencilJS Build</h1>
        <div class="post-detail__tags">
          <h3 class="subtitle is-6">
            <time datetime="2021-10-31">
              31 Oct 2021
            </time>
          </h3>
          <div class="tags"><a href="/tags/stenciljs/" class="post-tag">
                <span class="tag is-black">
                  Stenciljs
                </span>
              </a><a href="/tags/storybook/" class="post-tag">
                <span class="tag is-primary">
                  Storybook
                </span>
              </a>
          </div>
        </div>
        <div class="content post_detail__content">
          <div class="language-hint">
            
          </div>
          <p>In den letzten beiden Artikeln habe ich gezeigt wie man eine Komponentenbibliothek aufsetzt und wie man Storybook benutzt. Damit ist die Grundlage geschaffen. Was ist der nächste logische Schritt, wenn man einige (oder alle) Komponenten fertig hat? Richtig! Man möchte diese verwenden.
Die Grundidee ist die Arbeitsteilung. Ein Team/Spezialist kümmert sich um die Komponentenbibliothek und stellt diese anderen Teams zur Verfügung.<!-- endOfPreview -->
Die anderen Teams haben dadurch mehr Zeit sich um die Implementierung der Fachlichkeit und Businesslogik zu kümmern.</p>
<p>Ich habe den Artikel in drei Teile gegliedert:</p>
<ol>
<li><a href="#stencil-builds">Was sind die StencilJS-Builds a.k.a. Output-Targets?</a></li>
<li><a href="#wie-wende-ich-diese-an%3F">Wie wende ich diese an?</a></li>
<li><a href="#fazit">Fazit</a></li>
</ol>
<h4>Was sind die StencilJS-Builds, bzw, Output-Targets?</h4>
<p>Langer Rede kurzer Sinn. Die Ausgangslage sieht so aus, dass wir einige Komponenten in <a href="https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib">unserem component-lib Projekt</a> (Kuba-Button, My-Component, Kuba-Input) liegen haben. Diese stellen wir nun zur Verfügung. Dazu müssen wir uns anschauen, wie <a href="https://stenciljs.com/docs/output-targets">StencilJS</a> dies ermöglicht.</p>
<table>
<thead>
<tr>
<th>Build parameter</th>
<th style="text-align:center">Output</th>
<th>Funktion</th>
</tr>
</thead>
<tbody>
<tr>
<td>dist</td>
<td style="text-align:center">- cjs, collection, component-lib, types, index.js</td>
<td>Komponenten als wiederverwendbare Bibliothek inklusive Lazy Loading</td>
</tr>
<tr>
<td>dist-custom-elements</td>
<td style="text-align:center">- index.js, *.js (jede einzelne Komponente.js)</td>
<td>Empfohlene Einstellung zur Verwendung der Komponenten in Frameworks. tree-shaking-optimiert. Jede Komponente wird einzeln importierbar aus ihrer eigenen Datei</td>
</tr>
<tr>
<td>dist-custom-elements-bundle</td>
<td style="text-align:center">- index.js, *.js (jede einzelne Komponente.js)</td>
<td>Dasselbe wie zuvor, nur dass die Komponenten in einem großen Bundle zusammen sind.</td>
</tr>
<tr>
<td>www</td>
<td style="text-align:center">./www</td>
<td>Eine fertig gepackte Webseite. Dient zum Debugging, aber auch zum adaptieren zum eingen Zweck. Die Einbindung und Benutzung der Komponenten wird hier am Beispiel gezeigt.</td>
</tr>
<tr>
<td>docs-readme</td>
<td style="text-align:center">readme.md</td>
<td>Erzeugt neben jeder Komponente eine Dokumentationsdatei. Die weiteren Docs-Properties erstellen analoge Dokumentationsdateien.</td>
</tr>
</tbody>
</table>
<p>Wenn man sich diese breite Palette an Build-Optionen anschaut, wird man im ersten Moment erschlagen. Man muss ganz genau wissen, welchen Zweck man verfolgt. Benutze ich Komponenten in einem Web-Framework oder in einer Webanwendung. Benötige ich die Komponenten zum Bauen einer Webseite?
Jede Variante hat seine Vor- und Nachteile.</p>
<p><strong>dist</strong></p>
<p><strong>+</strong> Große Auswahl an Einbindungsmöglichkeiten
<b>-</b> Es wird mehr erzeugt als man wohl möglich benötigt
<b>-</b> sehr unspezifisch</p>
<p><strong>dist-custom-elements</strong>
<strong>+</strong> Gute Möglichkeit einzelne Komponenten zu bauen
<strong>+</strong> Man hat nur den Code den man braucht
<b>-</b> Benötigt einen Bundler, damit es im Browser läuft
<b>-</b> stencil-core wird benötigt</p>
<p><strong>dist-custom-elements-bundle</strong>
<strong>+</strong> Stellt alle Komponenten zur Verfügung
<b>-</b> Benötigt einen Bundler, damit es im Browser läuft
<b>-</b> stencil-core wird benötigt</p>
<p><strong>www</strong>
<strong>+</strong> Erzeugt einen Webseiten-Skeleton
<strong>+</strong> Benötigt keinen Bundler, keinen zusätzlichen Code
<strong>+</strong> Lazy Loading optimiert
<b>-</b> Keine einzelnen Komponenten extrahierbar
<b>-</b> Erzeugt sehr viele Dateien, die einzeln nachgeladen werden (automagisch)</p>
<h4>Wie wende ich diese an?</h4>
<p>Für die Präsentation der Anwendung habe ich im Beispielprojekt einen Unterordner <a href="https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib-usage">&quot;component-lib-usage&quot; angelegt</a>. In diesem befinden sich die Beispiel HTML-Seiten, die das jeweilige Build-Ziel einbinden. Dazu gibt es noch den Bundling-Code.</p>
<p>Die Anwendung umfasst immer drei Teile:</p>
<ol>
<li>Konfiguration Build-Ziel</li>
<li>optional Bundling</li>
<li>Einbindung in eine HTML</li>
</ol>
<p>Für das Bundling verwende ich <a href="https://webpack.js.org/">Webpack</a> und zum Anzeigen der Webseite (um das Nachladen der Module zu simulieren) den Python SimpleHTTPServer. Aber es ist total egal was man hier verwendet. Das Bundling muss das Importieren von Modulen ermöglichen und ein Webserver muss Dateien an den Browser ausliefern können.</p>
<h4>Konfiguration der Builds</h4>
<p>Die Konfiguration der Build-Ziele erfolgt in der StencilJS-Konfigurationsdatei und wird unter dem Key <em>outputTargets</em> gesteuert. Da das <em>dist</em> quasi die folgenden drei Möglichkeiten umfasst, beschreibe ich diese einzeln.</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token comment">// stencil.config.ts</span></span>
<span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Config <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@stencil/core"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">const</span> config<span class="token operator">:</span> Config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    namespace<span class="token operator">:</span> <span class="token string">"component-lib"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    outputTargets<span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="highlight-line">        <span class="token punctuation">{</span></span>
<span class="highlight-line">            type<span class="token operator">:</span> <span class="token string">"dist"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            esmLoaderPath<span class="token operator">:</span> <span class="token string">"../loader"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">{</span></span>
<span class="highlight-line">            type<span class="token operator">:</span> <span class="token string">"dist-custom-elements"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">{</span></span>
<span class="highlight-line">            type<span class="token operator">:</span> <span class="token string">"dist-custom-elements-bundle"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">{</span></span>
<span class="highlight-line">            type<span class="token operator">:</span> <span class="token string">"www"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            serviceWorker<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// disable service workers</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">{</span></span>
<span class="highlight-line">            type<span class="token operator">:</span> <span class="token string">"docs-readme"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line">npm run build</span>
<span class="highlight-line"><span class="token comment">// oder</span></span>
<span class="highlight-line">stencil build</span></code></pre>
<p>Den Inhalt des dist-Verzeichnissen, kopiere ich unter component-lib-usage.</p>
<p><strong>dist-custom-elements</strong>
Wenn man den Stencil-Bau-Befehl ausführt, erhält man unter /dist/components/ alle Komponenten als einzelne Dateien. Im Beispielprojekt erscheinen so die Dateien <em>kuba-button.js, kuba-input.js, kuba-wizard.js, ...</em> . Durch das Kopieren befinden sich dieser Dateien nun unter /component-lib-usage/components.
Laut der Dokumentation von Stenciljs können diese über folgenden Code geladen werden:</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token comment">// init_kuba_button.js</span></span>
<span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> KubaButton <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./kuba-button"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">"kuba-button"</span><span class="token punctuation">,</span> KubaButton<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Das stellt dem Browser die neuen Elemente vor und diese können dann einfach im HTML aufgerufen werden. Wenn man das so naiv macht, wie ich das gemacht habe, spuckt der Browser (Chrome) den Fehler aus, dass er <em>import</em> nicht kennt. Hier kommt Webpack zum Einsatz. Als Beispiel möchte ich den Kuba-Button verwenden.
Ein Bundler braucht eine Einstiegsdatei, um alle Imports aufzulösen. Dazu kopieren ich den Code in die neue Datei <em>init_kuba_button.js</em>. Jetzt benötige ich eine Webpack-Konfig und einen NPM befehl, um webpack zu starten:</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token comment">// webpack.component.config</span></span>
<span class="highlight-line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    entry<span class="token operator">:</span> <span class="token string">"./components/init_kuba_button.js"</span><span class="token punctuation">,</span> <span class="token comment">// Entry File</span></span>
<span class="highlight-line">    output<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//Output Directory</span></span>
<span class="highlight-line">        filename<span class="token operator">:</span> <span class="token string">"components/bundle.js"</span><span class="token punctuation">,</span> <span class="token comment">//Output file</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// package.json script</span></span>
<span class="highlight-line"> <span class="token string-property property">"build_single_component"</span><span class="token operator">:</span> <span class="token string">"webpack --mode production --config=webpack.component.config.js"</span></span></code></pre>
<p>Dies erzeugt unter dist/components/ eine <em>bundle.js</em>. Diese Datei müssen wir jetzt in ein HTML-Skeleton einbinden:</p>
<pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span></span>
<span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
<span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>
<span class="highlight-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="highlight-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Custom Component<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>
<span class="highlight-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./dist/components/bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
<span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span>
<span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span>
<span class="highlight-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello Welt components<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kuba-button</span><span class="token punctuation">></span></span>Hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kuba-button</span><span class="token punctuation">></span></span></span>
<span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span>
<span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span></code></pre>
<p>In Zeile 6 sehen wir die Einbindung der <em>bundle.js</em> im script-Tag. Das Besondere zeigt die Zeile 11. Hier verwenden wir die Kuba-Komponente als wäre sie ein existierendes HTML Tag.
Schauen wir uns die Datei nun über den Browser an, der auf den Python-Webserver zugreift an, sehen wir, dass auch funktioniert:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">python <span class="token parameter variable">-m</span> SimpleHTTPServer</span>
<span class="highlight-line"></span>
<span class="highlight-line">// im browser unter</span>
<span class="highlight-line">http://localhost:8000</span></code></pre>
<p><img src="/img/1021/index_component.png" alt="component einstieg" title="component einstieg"><div class="has-text-right image-subline">Bild 1: Einzelne Komponente</div></p>
<p><strong>dist-custom-elements-bundle</strong>
Nach dem build-Befehl entsteht ein Ordner unter /dist/custom-elements mit jeweils einer <em>index.ts</em>-Datei und der dazugehörigen <em>index.d.ts</em>-Datei. Diesmal sind alle gebauten Komponenten in der Datei gepackt. Aber auch hier bitte ich um Vorsicht. Es ist für Frameworks, bzw. für das moderne JS optimiert und läuft nicht out-of-the-box im Browser. Wir müssen auch hier erst einmal mit Hilfe von Webpack ein browserfähiges Bundle bauen.
Wir kopieren den Inhalt des Ordners in unser neues Projekt.
Auch hier brauchen wir ein Einstiegsdatei:</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token comment">// custom-elements/bundler.js</span></span>
<span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> defineCustomElements <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./index"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token function">defineCustomElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>und die dazugehörige Webpack-Config mitsamt package.json Skriptbefehl:</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token comment">// webpack.component.config</span></span>
<span class="highlight-line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">  entry<span class="token operator">:</span> <span class="token string">"./custom-elements/bundler.js"</span><span class="token punctuation">,</span> <span class="token comment">// Entry File</span></span>
<span class="highlight-line">  output<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//Output Directory</span></span>
<span class="highlight-line">    filename<span class="token operator">:</span> <span class="token string">"custom-elements/bundle.js"</span><span class="token punctuation">,</span> <span class="token comment">//Output file</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// package.json script</span></span>
<span class="highlight-line">  <span class="token string-property property">"build_custom_elements"</span><span class="token operator">:</span> <span class="token string">"webpack --mode production --config=webpack.custom-elements.config.js"</span><span class="token punctuation">,</span></span></code></pre>
<p>Wenn wir diesen Befehl ausführen erhalten wir unter /dist/custom-elements eine bundle.js. Diese referenzieren nun in unserem neuen HTML-Skeleton.</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span></span>
<span class="highlight-line"><span class="token operator">&lt;</span>html dir<span class="token operator">=</span><span class="token string">"ltr"</span> lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span>head<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span> <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>title<span class="token operator">></span>Mein <span class="token constant">HTML</span> Projekt<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"./dist/custom-elements/bundle.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span>body<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello Welt custom<span class="token operator">-</span>elements<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>my<span class="token operator">-</span>component</span>
<span class="highlight-line">            first<span class="token operator">=</span><span class="token string">"Stencil"</span></span>
<span class="highlight-line">            last<span class="token operator">=</span><span class="token string">"'Don't call me a framework' JS"</span></span>
<span class="highlight-line">        <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>component<span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>kuba<span class="token operator">-</span>button<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>button<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></span>
<span class="highlight-line"><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></span></code></pre>
<p>Analog zu dem vorherigen Beispiel sieht man in Zeile 7 die Einbindung und ab Zeile 11 die Verwendung der &quot;neuen&quot; HTML-Tags.</p>
<p><img src="/img/1021/custom-element-index.png" alt="Custom Elements Bundle" title="Custom Elements Bundle"><div class="has-text-right image-subline">Bild 2: Custom Elements Bundle</div></p>
<p><br>
<strong>www build</strong>
Nach dem build-Befehl hat man einen Ordner <em>www</em>. Diesen kopieren wir in das neue Projekt. Hier ist schon alles fertig transpiliert. Es ist lauffähig im Browser. Wir benötigen nur einen neuen HTML-Skeleton:</p>
<pre class="language-ts"><code class="language-ts"><span class="highlight-line"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span></span>
<span class="highlight-line"><span class="token operator">&lt;</span>html dir<span class="token operator">=</span><span class="token string">"ltr"</span> lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span>head<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span> <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token constant">WWW</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"module"</span> src<span class="token operator">=</span><span class="token string">"www/build/component-lib.esm.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>script nomodule src<span class="token operator">=</span><span class="token string">"www/build/component-lib.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span>body<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello Welt<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>my<span class="token operator">-</span>component</span>
<span class="highlight-line">            first<span class="token operator">=</span><span class="token string">"Stencil"</span></span>
<span class="highlight-line">            last<span class="token operator">=</span><span class="token string">"'Don't call me a framework' JS"</span></span>
<span class="highlight-line">        <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>component<span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token operator">&lt;</span>kuba<span class="token operator">-</span>button<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>button<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></span>
<span class="highlight-line"><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></span></code></pre>
<p>In Zeile 7 und 8 sieht man die Einbindung. Danach hat man Zugriff auf seinen Komponentenkatalog (Zeile 11-14). Die Darstellung im Browser ist Analog zu Bild 2.</p>
<h4>Fazit</h4>
<p>In diesem Artikel habe ich gezeigt wie man seine eigene Komponentenbibliothek ausliefert und integriert anhand der verschiedenem Builds von StencilJS. Ab jetzt sollte jeder in der Lage sein das Projekt nachzustellen. Vielleicht habe ich die Lust geweckt auf so eine Komponentenbibliothek zu setzen. Wir haben damit bereits sehr gute Erfahrungen gesammelt und folgen diesem Pattern sehr gerne. Ich finde es ist eine tolle Technologie und Methodik.</p>
<p>Der Code liegt wie immer auf <a href="https://github.com/derKuba/stenciljs-tutorial">Github</a>.</p>
<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href="https://twitter.com/der_kuba">Twitter</a>.
<br>
<br>
Tausend Dank fürs Lesen!</p>
<p>Kuba</p>

            <hr>
              <ul class="post-navigation">
                  <li>Nächster Artikel:
                    <a href="/posts/1121/storybook-addon/">Storybook Addon erstellen und veröffentlichen</a>
                  </li>
                
                  <li>Vorheriger Artikel:
                    <a href="/posts/1021/component-lib-storybook/">Storybook im Einsatz</a>
                  </li>
                
              </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
        <!-- Current page: /posts/1021/stencil-builds-for-using-component-lib/ -->
        <footer class="footer">
    <hr/>
    <div class="content has-text-centered">
        <p>
            der_kuba - 2021-2024 -
            <a href="/content/impressum.html">Impressum</a>
            -
            <a href="/content/datenschutz.html">Datenschutzerklärung</a>
        </p>
    </div>
</footer>
    </body>
</html>