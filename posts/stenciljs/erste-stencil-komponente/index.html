<!doctype html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>StencilJS-Tutorial: Die erste Komponente</title>
        <meta name="description" content="Erste Komponenten">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="der_kuba">
        <link rel="alternate" href="/feed/feed.json" type="application/json" title="der_kuba">
        <link rel="stylesheet" href="/assets/css/prism.css">
        <link rel="stylesheet" href="/assets/css/bulma.css">
        <link rel="stylesheet" href="/assets/css/custom.css">
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const e = Array
                    .prototype
                    .slice
                    .call(document.querySelectorAll(".navbar-burger"), 0);
                e.length > 0 && e.forEach(e => {
                    e.addEventListener("click", () => {
                        const t = e.dataset.target,
                            a = document.getElementById(t);
                        e.classList.toggle("is-active"),
                        a.classList.toggle("is-active")
                    })
                })
                const disableDarkMode = () => {
                    const bodyNode = document.querySelector("body");
                    bodyNode
                        .classList
                        .remove("dark-mode")
                        localStorage
                        .setItem('darkMode', 'disabled');
                }
                const enableDarkMode = () => {
                    const bodyNode = document.querySelector("body");
                    bodyNode
                        .classList
                        .add("dark-mode")
                        localStorage
                        .setItem('darkMode', 'enabled');
                }
                const button = document.getElementById("darkmode");
                button.addEventListener("click", () => {
                    const bodyNode = document.querySelector("body");
                    if (bodyNode.classList.contains("dark-mode")) {
                        disableDarkMode();
                    } else {
                        enableDarkMode();
                    }
                })
                if (localStorage.getItem('darkMode') === 'enabled') {
                    enableDarkMode();
                }
            });
        </script>
    </head>
    <body><header>
    <div class="container">
        <nav class="navbar">
            <div class="navbar-brand">
                <a class="navbar-item navbar-brand__title " href="/">
                    der_kuba
                </a>
                <a class="navbar-item is-size-7-mobile" href="https://github.com/derKuba">
                    @Github
                </a>
                <a class="navbar-item is-size-7-mobile" href="https://twitter.com/der_kuba">
                    @Twitter
                </a>
                <a class="navbar-item is-size-7-mobile" href="https://www.linkedin.com/in/jacob-pawlik-08a40015b/">
                    @LinkedIn
                </a>
                <div class="navbar-burger" data-target="navigation-items">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="navigation-items" class="navbar-menu">
                <div class="navbar-end">
                    
                        <a class="navbar-item " href="/">
                            Home
                        </a>
                        <a class="navbar-item " href="/posts/">
                            Archiv
                        </a>
                        <a class="navbar-item " href="/about/">
                            About Me
                        </a>
                        <a class="navbar-item " href="/en/">
                            English
                        </a>
                        <a class="navbar-item " href="/content/impressum.html">
                            Impressum
                        </a>
                        <a class="navbar-item " href="/content/datenschutz.html">
                            Datenschutzerklärung
                        </a>
                    <button id="darkmode" alt="dark mode">
                        <svg width="30" height="30">
                            <circle cx="15" cy="15" r="6" fill="currentColor"/>
                            <line id="ray" stroke="currentColor" stroke-width="2" stroke-linecap="round" x1="15" y1="1" x2="15" y2="4"></line>
                            <use href="#ray" transform="rotate(45 15 15)"/>
                            <use href="#ray" transform="rotate(90 15 15)"/>
                            <use href="#ray" transform="rotate(135 15 15)"/>
                            <use href="#ray" transform="rotate(180 15 15)"/>
                            <use href="#ray" transform="rotate(225 15 15)"/>
                            <use href="#ray" transform="rotate(270 15 15)"/>
                            <use href="#ray" transform="rotate(315 15 15)"/>
                        </svg>
                    </button>
                    <!-- special thanks to https://www.freecodecamp.org/news/how-to-handle-dark-mode-with-css-and-javascript/ -->
                </div>
            </div>
        </nav>
    </div>
</header>
        
<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <h1 class="title is-3">StencilJS-Tutorial: Die erste Komponente</h1>
        <div class="post-detail__tags">
          <h3 class="subtitle is-6">
            <time datetime="2021-06-11">
              11 Jun 2021
            </time>
          </h3>
          <div class="tags"><a href="/tags/stenciljs/" class="post-tag">
                <span class="tag is-black">
                  Stenciljs
                </span>
              </a>
          </div>
        </div>
        <div class="content post_detail__content">
          <div class="language-hint">
            
          </div>
          <p>Wir haben eine funktionsfähige Umgebung und können endlich mit der Entwicklung starten. <!-- endOfPreview --> In der <strong>package.json</strong> ist ein Skript zum Hinzufügen von Komponenten vorhanden: <em>generate</em>.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">npm</span> run generate kuba-input</span></code></pre>
<p>Der Befehl startet eine Art Wizard und fragt ab was wir erzeugen möchten:</p>
<p><img src="/content/img/stenciljs-tutorial/generate.png" alt="generate" title="generate"><div class="has-text-right image-subline">Bild 1: Generator</div></p>
<p>Ich habe mich für Stylesheet und Unit-Test entschieden. Die E2E Tests lasse ich erstmal außen vor.</p>
<p><img src="/content/img/stenciljs-tutorial/kuba-input.png" alt="kuba-input" title="kuba input"><div class="has-text-right image-subline">Bild 2: Meine erste Komponente</div></p>
<p>&quot;kuba-input&quot; ist meine erste Komponente. Der Name setzt sich aus [namespace]-[Komponentenname] zusammen und entspricht dem zukünftigen HTML-Tag. Man findet einen Ordner kuba-input unter src/components/kuba-input, in dem sich drei Dateien befinden. Die eigentliche Komponente <em>kuba-input.tsx</em>, die dazugehörige CSS <em>kuba-input.css</em> und der Unit-Test <em>kuba-input.spec.tsx</em>. Wer sich jetzt über die Dateiendung <em>.tsx</em> wundert, sollte sich nicht abschrecken lassen. TSX bedeutet, dass es sich um eine Typescript Datei handelt, in der sich HTML innerhalb des Codes befindet.</p>
<p>Der Inhalt der kuba-input.tsx setzt sich zusammen wie folgt:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Host<span class="token punctuation">,</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@stencil/core"</span><span class="token punctuation">;</span> <span class="token comment">// hole die Komponente aus dem Stencil-Kern</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Annotation die anzeigt, dass es sich um eine Komponente handelt, ...</span></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="highlight-line">    tag<span class="token operator">:</span> <span class="token string">"kuba-input"</span><span class="token punctuation">,</span> <span class="token comment">// die mit diesem Tag aufgerufen werden kann,</span></span>
<span class="highlight-line">    styleUrl<span class="token operator">:</span> <span class="token string">"kuba-input.css"</span><span class="token punctuation">,</span> <span class="token comment">// ihr CSS aus dieser Datei speißt</span></span>
<span class="highlight-line">    shadow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// und im Shadow-Dom gekapselt ist.</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">KubaInput</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token comment">// das TSX muss innerhalb von Komponenten immer in der render-methode zurückgegeben werden. Ausnahme hiervon sind sogenannte functional components.</span></span>
<span class="highlight-line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">return</span> <span class="token operator">&lt;</span>Host<span class="token operator">></span>Hallo<span class="token punctuation">,</span> ich bin die erste Komponente<span class="token operator">&lt;</span><span class="token operator">/</span>Host<span class="token operator">></span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>Wollen wir diese Komponente nun sehen, müssen wir sie als Knoten in unseren DOM hängen. Die aktuelle Starter-App ist aufgebaut wie folgt:</p>
<ul>
<li>&lt; app-root /&gt; ist der Einstiegspunkt in der index.html
-&gt; in dieser ist Router eingebunden. Für diese Tutorial habe ich es auskommentiert, weil es hier noch nicht benötigt wird.</li>
</ul>
<p>Fügt man nun innerhalb der render-Methode der app-root.tsx <kuba-input/>, bekommt man das &quot;Hallo, ich bin die erste Komponente&quot; zu sehen.</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@stencil/core"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="highlight-line">    tag<span class="token operator">:</span> <span class="token string">"app-root"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    styleUrl<span class="token operator">:</span> <span class="token string">"app-root.css"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    shadow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppRoot</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span>div<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>header<span class="token operator">></span></span>
<span class="highlight-line">                    <span class="token operator">&lt;</span>h1<span class="token operator">></span>Adressbuch<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>main<span class="token operator">></span></span>
<span class="highlight-line">                    <span class="token operator">&lt;</span>kuba<span class="token operator">-</span>input<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>input<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">></span></span>
<span class="highlight-line"></span>
                <span class="token punctuation">{</span><span class="token comment">/* 
<span class="highlight-line">          &lt;stencil-router></span>
<span class="highlight-line">            &lt;stencil-route-switch scrollTopOffset={0}></span>
<span class="highlight-line">              &lt;stencil-route url="/" component="app-home" exact={true} /></span>
<span class="highlight-line">              &lt;stencil-route url="/profile/:name" component="app-profile" /></span>
<span class="highlight-line">            &lt;/stencil-route-switch></span>
<span class="highlight-line">          &lt;/stencil-router></span>
       */</span><span class="token punctuation">}</span>
<span class="highlight-line">            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>Für dieses Tutorial möchte ich folgenden Fall umsetzen. Wir legen Komponente an, die ein Inputfeld und einen Button besitzt. Wenn ich den Button drücke, bekomme ich den Inhalt in einem Alert angezeigt.</p>
<p><img src="/content/img/stenciljs-tutorial/simple-input.png" alt="simple-input" title="simple input"><div class="has-text-right image-subline">Bild 3: Use-Case</div></p>
<p>Dazu brauchen wir drei Komponenten:</p>
<ol>
<li>Kontakt-Formular</li>
<li>Inputfeld inklusive Label</li>
<li>Button.</li>
</ol>
<p>Diese werden über den &quot;generate&quot;-Befehl erstellt:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">npm</span> run generate kuba-address-form</span>
<span class="highlight-line"><span class="token function">npm</span> run generate kuba-button</span>
<span class="highlight-line"><span class="token comment"># falls es bisher nicht angelegt wurde</span></span>
<span class="highlight-line"><span class="token function">npm</span> run generate kuba-input</span></code></pre>
<p>Die Einbindung erfolgt über die app-root.tsx und gliedert sich wie folgt:</p>
<ul>
<li>app-root
<ul>
<li>kuba-address-form
<ul>
<li>kuba-input</li>
<li>kuba-button</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Anhand von kuba-input möchte ich vier grundlegenden Funktionen einer StencilJS-Komponente erklären und im Anschluss erkläre ich wie die Komponenten zusammengesteckt werden.</p>
<ol>
<li>Props bzw. Properties ( oder wie übergebe ich Daten an die Komponente ?)</li>
<li>Slots</li>
<li>Events ( oder wie versende ich Nachrichten und Interaktionen? )</li>
<li>State ( oder wie halte ich den Zustand meiner Komponente).</li>
</ol>
<h3>Props</h3>
<p>Wir bauen HTML Tags. Diese nutzen zur Übergabe von Parametern und Daten Attribute. StencilJS nennt diese Attribute Properties.
Nehmen wir jetzt die kuba-input Komponente. Diese braucht als Parameter ein Label für das Inputfeld, eine ID und den Typ des Inputfeldes (Text oder Zahl). Eine Property ist ein Klassenattribut mit einer <em>@Prop()</em>-Annotation. Ich empfehle an dieser Stelle einen Blick <a href="https://stenciljs.com/docs/properties">in die offizielle Doku</a> zu werfen.</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> componentId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> label<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Akzeptiere nur inputType text oder number</span></span>
<span class="highlight-line"><span class="token comment">// und belege es mit text vor</span></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> inputType<span class="token operator">:</span> <span class="token string">"text"</span> <span class="token operator">|</span> <span class="token string">"number"</span> <span class="token operator">=</span> <span class="token string">"text"</span><span class="token punctuation">;</span></span></code></pre>
<p>Als Property können sämtliche Datentypen und Funktionen übergeben werden. Hier ein Beispiel für eine übergebene Funktion:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">/* kuba-button.tsx */</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Ganz normale Property, die eine Funktion beinhaltet</span></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> handleSubmit<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// wird an das native onClick des Buttons übergeben.</span></span>
<span class="highlight-line"><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">/* kuba-address-form.tsx */</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Definition der Funktion, die übergeben werden soll-</span></span>
<span class="highlight-line"><span class="token keyword">private</span> <span class="token function-variable function">onSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Überreichung der Funktion</span></span>
<span class="highlight-line"><span class="token operator">&lt;</span>kuba<span class="token operator">-</span>button handleSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit<span class="token punctuation">}</span><span class="token operator">></span>speichern<span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>button<span class="token operator">></span></span></code></pre>
<h3>Slots</h3>
<p>Als <a href="https://stenciljs.com/docs/templating-jsx#slotshttps://stenciljs.com/docs/templating-jsx#slots">Slot</a> werden HTML-Tags bezeichnet, die im Bauch der angelegten Komponente platziert sind. Wenn ich ein HTML tag...</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token operator">&lt;</span>kuba<span class="token operator">-</span>input<span class="token operator">></span></span>
<span class="highlight-line">    <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token operator">...</span> hier platzieren möchte<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span></span>
<span class="highlight-line"><span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>input<span class="token operator">></span></span></code></pre>
<p>... kann ich es nicht so tun wie hier beschrieben. Der Span-Block würde ignoriert werden. Damit das nicht passiert muss ich meiner Komponente mitteilen, an welcher Stelle diese &quot;Kinder-Knoten&quot; platziert werden sollen. Die einfachste Variante sind unbenannte Slots:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">/* kuba-button.tsx */</span></span>
<span class="highlight-line"> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token operator">&lt;</span>slot<span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">/* kuba-address-form.tsx */</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"> <span class="token operator">&lt;</span>kuba<span class="token operator">-</span>button<span class="token operator">></span>speichern<span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>button<span class="token operator">></span></span></code></pre>
<p>Der &quot;speichern&quot;-Text wird an der Stelle des Slots platziert. Um mehrere Slots innerhalb einer Komponente zu platzieren, werden benannte Slots angeboten. Diese werden innerhalt der Komponente mit einem name-Attribut versehen:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">"beliebiger-name"</span> <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line"><span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">"zweiter"</span> <span class="token operator">/</span><span class="token operator">></span></span></code></pre>
<p>und können dann an ein beliebiges HTML-Tag gepinnt werden:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"> <span class="token operator">&lt;</span>p slot<span class="token operator">=</span><span class="token string">"beliebiger-name"</span><span class="token operator">></span>Das ist der zu übertragende Inhalt<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span></span>
<span class="highlight-line"> <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">"zweiter"</span><span class="token operator">></span> Neuer Inhalt<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span></code></pre>
<h3>Events</h3>
<p>Als Events werden z.B. Tastaturanschläge, Mausklicks, das Verlassen des Inputfeldes bezeichnet, aber auch Nachrichten, die man an andere Komponenten schicken kann, die sich nicht unmittelbar über dem eigenen Knoten befinden.
Im konkreten Fall möchte ich in der Elternkomponente <em>kuba-address-form</em> über Änderungen innerhalb des Inputfeldes von <em>kuba-input</em> informiert werden. Dazu benötigt die Kindkomponente <em>kuba-input</em> einen Event, samt EventEmitter. Die Elternkomponente <em>kuba-address-form</em> benötigt einen Listener auf das Event:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">/* kuba-input.tsx */</span></span>
<span class="highlight-line"> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Event</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> bubbles<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> inputEvent<span class="token operator">:</span> EventEmitter<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// interner Listener auf onInput des input-tags</span></span>
<span class="highlight-line"><span class="token keyword">private</span> <span class="token function-variable function">onInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token comment">// schicke die Nachricht weiter</span></span>
<span class="highlight-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>inputEvent<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token operator">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// innerhalb der render-methode</span></span>
<span class="highlight-line"><span class="token operator">...</span></span>
<span class="highlight-line"><span class="token operator">&lt;</span>input</span>
<span class="highlight-line">    <span class="token operator">...</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token comment">// hier reicht als Parameter die Referenz, da es sich um eine</span></span>
<span class="highlight-line">    <span class="token comment">// Arrow-Funktion handelt. Ohne Arrow-Funktion fehlt der</span></span>
<span class="highlight-line">    <span class="token comment">// this-context und es wird ein Fehler geworfen.</span></span>
<span class="highlight-line">    onInput<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onInput<span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token operator">/</span><span class="token operator">></span></span></code></pre>
<p>Damit die Elternkomponente nun die Nachricht bekommt, muss diese drauf lauschen:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">/* kuba-address-form.tsx */</span></span>
<span class="highlight-line"><span class="token keyword">private</span> <span class="token function-variable function">onChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> detail<span class="token operator">:</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> detail<span class="token operator">:</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> value<span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// innerhalb der render-methode</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token operator">&lt;</span>kuba<span class="token operator">-</span>input</span>
<span class="highlight-line">    <span class="token operator">...</span></span>
<span class="highlight-line">    onInputEvent<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>input<span class="token operator">></span></span></code></pre>
<p>Jetzt bekommt die kuba-address-form mit, wenn etwas in das kuba-input getippt wird und das bei jedem Tastaturanschlag. Dies kann man auch ändern, wenn man z.B. statt auf onInput auf onBlur lauscht.</p>
<h3>States</h3>
<p>Die Elternkomponente wird im weiteren Verlauf viel mehr Inputfelder besitzen und um die Informationen aus diesen Feldern weiterzugeben, muss sich die Komponente Informationen merken.
Dazu wird in StencilJS <em>@State()</em> verwendet. Hierbei handelt es sich um den Zustand der einzelnen Komponente. Möchte man sich applikationsweit den Zustand merken, wird ein <em>Store</em> benötigt. Darauf gehe ich in einem späteren Tutorial ein.</p>
<p>Initialisiert, geschrieben und gelesen wird ein State folgendermaßen:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// Initalisierung als Klassenattribut</span></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">State</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> innerText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// innerhalb einer Methode</span></span>
<span class="highlight-line"><span class="token keyword">this</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> value<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Auslesen innerhalb der render-methode</span></span>
<span class="highlight-line">Name<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerText<span class="token punctuation">}</span></span></code></pre>
<p>In konkretem Fall schreibe ich den eingetippten Wert bei jedem Tastenanschlag in den State.</p>
<h3>Zusammenführung</h3>
<p>Die zusammengesteckten Komponenten funktionieren nun wie im Use-Case definiert. Die <em>kuba-address-form</em> definiert den Rahmen und inkludiert das <em>kuba-input</em> und den <em>kuba-button</em>. Die eingegeben Informationen werden per Event an die Elternkomponente weitergereicht, geloggt, gespeichert und dann beim Betätigen des <em>kuba-buttons</em> via Alert ausgegeben.</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// kuba-addres-form.tsx</span></span>
<span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Host<span class="token punctuation">,</span> h<span class="token punctuation">,</span> State <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@stencil/core"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="highlight-line">    tag<span class="token operator">:</span> <span class="token string">"kuba-address-form"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    styleUrl<span class="token operator">:</span> <span class="token string">"kuba-address-form.css"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    shadow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">KubaAddressForm</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token decorator"><span class="token at operator">@</span><span class="token function">State</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> innerText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token keyword">private</span> <span class="token function-variable function">onChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="highlight-line">        detail<span class="token operator">:</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        detail<span class="token operator">:</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> value<span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token keyword">private</span> <span class="token function-variable function">onSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span>Host<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>h2<span class="token operator">></span>Adress<span class="token operator">-</span>Formular<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>kuba<span class="token operator">-</span>input</span>
<span class="highlight-line">                    componentId<span class="token operator">=</span><span class="token string">"name"</span></span>
<span class="highlight-line">                    label<span class="token operator">=</span><span class="token string">"Name:"</span></span>
<span class="highlight-line">                    onInputEvent<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">}</span></span>
<span class="highlight-line">                <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>input<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>kuba<span class="token operator">-</span>button handleSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit<span class="token punctuation">}</span><span class="token operator">></span></span>
<span class="highlight-line">                    speichern</span>
<span class="highlight-line">                <span class="token operator">&lt;</span><span class="token operator">/</span>kuba<span class="token operator">-</span>button<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>hr <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>h3<span class="token operator">></span>Eingegebene Daten<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span></span>
<span class="highlight-line">                Name<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerText<span class="token punctuation">}</span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span><span class="token operator">/</span>Host<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// kuba-input.tsx</span></span>
<span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Host<span class="token punctuation">,</span> h<span class="token punctuation">,</span> Event<span class="token punctuation">,</span> EventEmitter<span class="token punctuation">,</span> Prop <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@stencil/core"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="highlight-line">    tag<span class="token operator">:</span> <span class="token string">"kuba-input"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    styleUrl<span class="token operator">:</span> <span class="token string">"kuba-input.css"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    shadow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">KubaInput</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> componentId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> label<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> inputType<span class="token operator">:</span> <span class="token string">"text"</span> <span class="token operator">|</span> <span class="token string">"number"</span> <span class="token operator">=</span> <span class="token string">"text"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Event</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> inputEvent<span class="token operator">:</span> EventEmitter<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token keyword">private</span> <span class="token function-variable function">onInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>inputEvent<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token operator">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span>Host<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"kuba-input"</span><span class="token operator">></span></span>
<span class="highlight-line">                    <span class="token operator">&lt;</span>label htmlFor<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>componentId<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>label<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></span>
<span class="highlight-line">                    <span class="token operator">&lt;</span>input</span>
<span class="highlight-line">                        type<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>componentId<span class="token punctuation">}</span></span>
<span class="highlight-line">                        id<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>componentId<span class="token punctuation">}</span></span>
<span class="highlight-line">                        value<span class="token operator">=</span><span class="token string">""</span></span>
<span class="highlight-line">                        onInput<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onInput<span class="token punctuation">}</span></span>
<span class="highlight-line">                    <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span><span class="token operator">/</span>Host<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// kuba-button.tsx</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Host<span class="token punctuation">,</span> h<span class="token punctuation">,</span> Prop <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@stencil/core"</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="highlight-line">    tag<span class="token operator">:</span> <span class="token string">"kuba-button"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    styleUrl<span class="token operator">:</span> <span class="token string">"kuba-button.css"</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    shadow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">KubaButton</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Prop</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> handleSubmit<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span>Host<span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">></span></span>
<span class="highlight-line">                    <span class="token operator">&lt;</span>slot <span class="token operator">/</span><span class="token operator">></span></span>
<span class="highlight-line">                <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span></span>
<span class="highlight-line">            <span class="token operator">&lt;</span><span class="token operator">/</span>Host<span class="token operator">></span></span>
<span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>Der Code hierzu liegt auf <a href="https://github.com/derKuba/stenciljs-tutorial">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 1.0.0 auschecken:</p>
<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href="https://twitter.com/der_kuba">Twitter</a>.
<br>
<br>
Tausend Dank fürs Lesen!</p>
<p>Kuba</p>

            <hr>
              <ul class="post-navigation">
                  <li>Nächster Artikel:
                    <a href="/posts/stenciljs/tabellen-komponente/">StencilJS-Tutorial: Tabellen-Komponente</a>
                  </li>
                
                  <li>Vorheriger Artikel:
                    <a href="/posts/stenciljs/entwicklerwerkzeuge/">StencilJS-Tutorial: Entwicklungswerkzeuge einrichten</a>
                  </li>
                
              </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
        <!-- Current page: /posts/stenciljs/erste-stencil-komponente/ -->
        <footer class="footer">
    <hr/>
    <div class="content has-text-centered">
        <p>
            der_kuba - 2021-2024 -
            <a href="/content/impressum.html">Impressum</a>
            -
            <a href="/content/datenschutz.html">Datenschutzerklärung</a>
        </p>
    </div>
</footer>
    </body>
</html>