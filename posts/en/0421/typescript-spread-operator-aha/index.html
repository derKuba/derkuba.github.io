<!doctype html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>Fun with TypeScript: Spread Operator AHA Moment</title>
        <meta name="description" content="My stumbling block of the week">
        <meta property="og:title" content="Speakaoke – Spontane Präsentationen mit KI"/>
        <meta property="og:image" content="/android-chrome-384x384.png"/>
        <meta property="og:url" content="https://derkuba.de/posts/0225/speakaoke/"/>
        <meta property="og:type" content="website"/>
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="der_kuba">
        <link rel="alternate" href="/feed/feed.json" type="application/json" title="der_kuba">
        <link rel="stylesheet" href="/assets/css/prism.css">
        <link rel="stylesheet" href="/assets/css/bulma.css">
        <link rel="stylesheet" href="/assets/css/custom.css">
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const e = Array
                    .prototype
                    .slice
                    .call(document.querySelectorAll(".navbar-burger"), 0);
                e.length > 0 && e.forEach(e => {
                    e.addEventListener("click", () => {
                        const t = e.dataset.target,
                            a = document.getElementById(t);
                        e.classList.toggle("is-active"),
                        a.classList.toggle("is-active")
                    })
                })
                const disableDarkMode = () => {
                    const bodyNode = document.querySelector("body");
                    bodyNode
                        .classList
                        .remove("dark-mode")
                        localStorage
                        .setItem('darkMode', 'disabled');
                }
                const enableDarkMode = () => {
                    const bodyNode = document.querySelector("body");
                    bodyNode
                        .classList
                        .add("dark-mode")
                        localStorage
                        .setItem('darkMode', 'enabled');
                }
                const button = document.getElementById("darkmode");
                button.addEventListener("click", () => {
                    const bodyNode = document.querySelector("body");
                    if (bodyNode.classList.contains("dark-mode")) {
                        disableDarkMode();
                    } else {
                        enableDarkMode();
                    }
                })
                if (localStorage.getItem('darkMode') === 'enabled') {
                    enableDarkMode();
                }
            });
        </script>
    </head>
    <body><header>
    <div class="container">
        <nav class="navbar">
            <div class="navbar-brand">
                <a class="navbar-item navbar-brand__title " href="/">
                    der_kuba
                </a>
                <a class="navbar-item is-size-7-mobile" href="https://github.com/derKuba">
                    @Github
                </a>
                <a class="navbar-item is-size-7-mobile" href="https://twitter.com/der_kuba">
                    @Twitter
                </a>
                <a class="navbar-item is-size-7-mobile" href="https://www.linkedin.com/in/jacob-pawlik-08a40015b/">
                    @LinkedIn
                </a>
                <div class="navbar-burger" data-target="navigation-items">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="navigation-items" class="navbar-menu">
                <div class="navbar-end">
                    
                        <a class="navbar-item " href="/">
                            Home
                        </a>
                        <a class="navbar-item " href="/posts/">
                            Archiv
                        </a>
                        <a class="navbar-item " href="/about/">
                            About Me
                        </a>
                        <a class="navbar-item " href="/en/">
                            English
                        </a>
                        <a class="navbar-item " href="/content/impressum.html">
                            Impressum
                        </a>
                        <a class="navbar-item " href="/content/datenschutz.html">
                            Datenschutzerklärung
                        </a>
                    <button id="darkmode" alt="dark mode">
                        <svg width="30" height="30">
                            <circle cx="15" cy="15" r="6" fill="currentColor"/>
                            <line id="ray" stroke="currentColor" stroke-width="2" stroke-linecap="round" x1="15" y1="1" x2="15" y2="4"></line>
                            <use href="#ray" transform="rotate(45 15 15)"/>
                            <use href="#ray" transform="rotate(90 15 15)"/>
                            <use href="#ray" transform="rotate(135 15 15)"/>
                            <use href="#ray" transform="rotate(180 15 15)"/>
                            <use href="#ray" transform="rotate(225 15 15)"/>
                            <use href="#ray" transform="rotate(270 15 15)"/>
                            <use href="#ray" transform="rotate(315 15 15)"/>
                        </svg>
                    </button>
                    <!-- special thanks to https://www.freecodecamp.org/news/how-to-handle-dark-mode-with-css-and-javascript/ -->
                </div>
            </div>
        </nav>
    </div>
</header>
        
<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <h1 class="title is-3">Fun with TypeScript: Spread Operator AHA Moment</h1>
        <div class="post-detail__tags">
          <h3 class="subtitle is-6">
            <time datetime="2021-04-24">
              24 Apr 2021
            </time>
          </h3>
          <div class="tags"><a href="/tags/typescript/" class="post-tag">
                <span class="tag is-black">
                  Typescript
                </span>
              </a>
          </div>
        </div>
        <div class="content post_detail__content">
          <div class="language-hint">
            
              <a href="/posts/0421/typescript-spread-operator-aha">Auf Deutsch lesen <img width="25" src="/assets/images/de.png"/></a>
            
          </div>
          <p>This week, I stumbled over the spread operator and wanted to share my experience. <!-- endOfPreview --></p>
<p>Here's the scenario:
I want to create an object with a key &quot;name of a test case&quot; and a value that contains an object with named pairs of numbers. I have an array of test case names and an object that contains a schema.</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">const</span> testCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">,</span> <span class="token string">"testcase 1"</span><span class="token punctuation">,</span> <span class="token string">"testcase 2"</span><span class="token punctuation">,</span> <span class="token string">"testcase 3"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        c<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        c<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">        c<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span></code></pre>
<p>From the names and schema, I want to create a large object that looks like this:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">const</span> testDataDefaults <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token string-property property">"testcase 0"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token string-property property">"first"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">            a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            c<span class="token operator">:</span> <span class="token number">0</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">         <span class="token string-property property">"second"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">            a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            c<span class="token operator">:</span> <span class="token number">0</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">         <span class="token string-property property">"third"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">            a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="highlight-line">            c<span class="token operator">:</span> <span class="token number">0</span></span>
<span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token operator">...</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>You quickly write a small loop over the test case names, initiate the collection object, and set the schema for each test case:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token keyword">const</span> testDataDefaults <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line">testCases<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>testCase<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    testDataDefaults<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token operator">...</span>numbers<span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>The line <code>...numbers</code> creates a clone of the schema and assigns it to the test case name.</p>
<p>This default object is then filled with real data in the next step. My initial approach, without thinking too much, looked like this:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line">testDataDefaults<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span>
<span class="highlight-line">testDataDefaults<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span>
<span class="highlight-line">testDataDefaults<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span></code></pre>
<p>I expected that the &quot;first&quot; object in the first test case would have the number 23 at position &quot;a&quot;. But the reality looked different:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token punctuation">{</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 2'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token operator">...</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>Whaaaat?</p>
<p>According to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_in_object_literals">MDN's spread operator documentation</a>, everything should have worked.</p>
<p>A quick Google search on how to clone objects:</p>
<p><a href="https://www.samanthaming.com/tidbits/70-3-ways-to-clone-objects/">3 Ways to Clone Objects - Samantha Ming</a></p>
<p>So let's try again with all three solutions:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line">tests<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>testCase<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    spreadMapped<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token operator">...</span>numbers<span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    jsonMapped<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    objectAssignMapped<span class="token punctuation">[</span>testCase<span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span>
<span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span>
<span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">jsonMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span>
<span class="highlight-line">jsonMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span>
<span class="highlight-line">jsonMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">objectAssignMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span></span>
<span class="highlight-line">objectAssignMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></span>
<span class="highlight-line">objectAssignMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span></span></code></pre>
<p>And the result was still mixed:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// spread</span></span>
<span class="highlight-line"><span class="token punctuation">{</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token operator">...</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token comment">// json</span></span>
<span class="highlight-line"><span class="token punctuation">{</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    <span class="token operator">...</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// Object assign</span></span>
<span class="highlight-line"><span class="token punctuation">{</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token operator">...</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>The spread operator and Object.assign don’t deliver as promised at first glance. I came across the term &quot;shallow clone.&quot; While the default object is cloned, the references to &quot;first&quot;, &quot;second&quot;, and &quot;third&quot; remain intact. The JSON method goes beyond shallow cloning.</p>
<p>The assignment via <code>spreadMapped[&quot;testcase 0&quot;].first.a = 23;</code> doesn't work. You need to overwrite the assigned object with a fresh one:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line">spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    <span class="token operator">...</span>spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token operator">...</span>spreadMapped<span class="token punctuation">[</span><span class="token string">"testcase 0"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">,</span></span>
<span class="highlight-line">        a<span class="token operator">:</span> <span class="token number">23</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment">// output</span></span>
<span class="highlight-line"><span class="token punctuation">{</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 0'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">  <span class="token string-property property">'testcase 1'</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">    first<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    second<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line">    third<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span></span>
<span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>That was my tough learning of the week. You can find the code at: <a href="https://github.com/derKuba/fun-with-typescript/tree/main/240121-spread-aha-moment">Code here</a></p>
<p>Do you have questions or feedback? Reach out to me on <a href="https://twitter.com/der_kuba">Twitter</a></p>

            <hr>
              <ul class="post-navigation">
                  <li>Nächster Artikel:
                    <a href="/posts/0521/flutter-export-sqlite-db/">How to export SQlite Database File in Flutter (Android)</a>
                  </li>
                
                  <li>Vorheriger Artikel:
                    <a href="/posts/0421/typescript-spread-operator-aha/">Spass mit Typescript: Spread-Operator AHA-Moment</a>
                  </li>
                
              </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
        <!-- Current page: /posts/en/0421/typescript-spread-operator-aha/ -->
        <footer class="footer">
    <hr/>
    <div class="content has-text-centered">
        <p>
            der_kuba - 2021-2024 -
            <a href="/content/impressum.html">Impressum</a>
            -
            <a href="/content/datenschutz.html">Datenschutzerklärung</a>
        </p>
    </div>
</footer>
    </body>
</html>