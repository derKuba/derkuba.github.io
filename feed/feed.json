{
  "version": "https://jsonfeed.org/version/1.1",
  "title": "der_kuba",
  "language": "de",
  "home_page_url": "https://derkuba.de/",
  "feed_url": "https://derkuba.de/feed/feed.json",
  "description": "IT Blog mit Tipps und Tricks aus dem Arbeitsalltag eines Software-Enwicklers",
  "author": {
    "name": "Jacob Pawlik",
    "url": "https://derkuba/about-me/"
  },
  "items": [{
      "id": "https://derkuba.de/content/posts/1121/storybook-addon/",
      "url": "https://derkuba.de/content/posts/1121/storybook-addon/",
      "title": "Storybook Addon erstellen und veröffentlichen",
      "content_html": "<p>Heute zeige ich wie man ein Storybook Addon schreibt. Jedes Projekt ist individuell und einzigartig sind auch die Anforderungen. Storybook bietet einen breiten Katalog an <a href=\"https://storybook.js.org/addons\">Addons</a> an. Ein tolles Feature, das das Entwicklungsteam anbietet, ist die Möglichkeit weitere Addons selber zu schreiben. <!-- endOfPreview -->Dabei kann man dann selber entscheiden, ob man es in den Katalog aufnehmen lassen möchte, oder ob man es einfach nur in sein Projekt integriert. Aber wie erstellt man nun ein Addon?<br>\nDazu gibt es <a href=\"https://storybook.js.org/docs/react/addons/writing-addons/\">eine Anleitung und auch eine API</a>. Es zum Starten zwei Möglichkeiten. Man kann auf einer grünen Wiese starten oder man klont das <a href=\"https://github.com/storybookjs/addon-kit\">Starterprojekt</a> und ergänzt dieses. Wir machen heute ersteres.</p>\n<h4 id=\"initiales-setup\" tabindex=\"-1\">Initiales Setup <a class=\"direct-link\" href=\"#initiales-setup\">#</a></h4>\n<p>Analog zu den vorherigen Artikeln legen wir einen Ordner an, initalisieren ein NPM-Projekt und beginnen dann die Storybook Addons dependencies hinzuzufügen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">mkdir</span> storybook-addon-hello-world</span><br><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> storybook-addon-hello-world</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> init</span></code></pre>\n<p>Damit steht das Gerüst. Unser Addon wird in React geschrieben und mit Hilfe von Babel transpiliert. Als nächstes fügen wir Babel zum Projekt hinzu.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -D @babel/cli @babel/preset-env @babel/preset-react</span></code></pre>\n<p>Anschließend legen wir eine Babel-Konfigurationsdatei (.babelrc.js_) an und füllen diese mit Leben.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">touch</span> .babelrc.js</span></code></pre>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    presets<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"@babel/preset-env\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"@babel/preset-react\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>In Zeile 2 sehen wir nun, dass die zuvor installierten Presets zum Zug kommen. Ein Preset ist eine kleine Sammlung von Plugins, um eine Sprache zu unterstützen. In unserem Fall <a href=\"https://www.w3schools.com/js/js_es6.asp\">ES6+</a>.</p>\n<p>Jetzt tragen wir den Babel-Befehl, das Babel-Skript, in unsere package.json ein.</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"highlight-line\">...</span><br><span class=\"highlight-line\">scripts<span class=\"token operator\">:</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"><span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"babel ./src --out-dir ./dist --ignore '**/*.spec.jsx'\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">....</span></code></pre>\n<p>In Zeile 3 sehen wir den Befehl. Der erste Parameter ist das Quellverzeichnis <em>/src</em>. Es folgt das Zielverzeichnis, <em>/dist</em>. Daneben gesellt sich eine Ignorierliste: die Tests. Diese müssen nicht transpiliert werden. Um es zu testen benötigen wir noch etwas Code und das Quellverzeichnis.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">mkdir</span> src</span><br><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> src</span><br><span class=\"highlight-line\"><span class=\"token function\">touch</span> presets.js</span><br><span class=\"highlight-line\"><span class=\"token function\">touch</span> register.js</span></code></pre>\n<p>Jetzt existiert das Quellverzeichnis und wir haben die Einstiegsdatei <em>presets.js</em>. Diese Datei sucht Storybook für den Einstieg. In dieser registrieren wir unser Plugin. In der <em>register.js</em>-Datei beginnt React.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// presets.js</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">managerEntries</span><span class=\"token punctuation\">(</span>entry <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>entry<span class=\"token punctuation\">,</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./register\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> managerEntries <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Jetzt können wir mal den build-Befehl ausführen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run build</span></code></pre>\n<p>Es entsteht ein Ordner <em>/dist</em> in dem sich die Datei <em>presets.js</em> und hat nun etwas mehr Inhalt.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">_toConsumableArray</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">_arrayWithoutHoles</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">_iterableToArray</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">_unsupportedIterableToArray</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">_nonIterableSpread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">_nonIterableSpread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TypeError</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">_unsupportedIterableToArray</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o<span class=\"token punctuation\">,</span> minLen</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>o<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> o <span class=\"token operator\">===</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">_arrayLikeToArray</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">,</span> minLen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> n <span class=\"token operator\">=</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">===</span> <span class=\"token string\">\"Object\"</span> <span class=\"token operator\">&amp;&amp;</span> o<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">)</span> n <span class=\"token operator\">=</span> o<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">===</span> <span class=\"token string\">\"Map\"</span> <span class=\"token operator\">||</span> n <span class=\"token operator\">===</span> <span class=\"token string\">\"Set\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">===</span> <span class=\"token string\">\"Arguments\"</span> <span class=\"token operator\">||</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token function\">_arrayLikeToArray</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">,</span> minLen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">_iterableToArray</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">iter</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> Symbol <span class=\"token operator\">!==</span> <span class=\"token string\">\"undefined\"</span> <span class=\"token operator\">&amp;&amp;</span> iter<span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>iterator<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></span><br><span class=\"highlight-line\">        iter<span class=\"token punctuation\">[</span><span class=\"token string\">\"@@iterator\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">_arrayWithoutHoles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">_arrayLikeToArray</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">_arrayLikeToArray</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arr<span class=\"token punctuation\">,</span> len</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>len <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> len <span class=\"token operator\">></span> arr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> len <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> arr2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span>len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        arr2<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> arr2<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">managerEntries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> entry <span class=\"token operator\">=</span></span><br><span class=\"highlight-line\">        arguments<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> arguments<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token function\">_toConsumableArray</span><span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./register\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    managerEntries<span class=\"token operator\">:</span> managerEntries<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Der Inhalt ist transpiliertes und im Browser lauffähiges Javascript. Damit funktioniert unser Setup. Ich schlage noch eine kleine Erweiterung vor: einen Watcher.<br>\nIm aktuellen Setup muss man nach jeder Änderung den Befehl ausführen, um zu transpilieren. Es gibt ein npm-Modul, das eine Änderung am Sourcecode erkennt und den Build-Befehl ausführt.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -D npm-watch</span></code></pre>\n<p>In die <em>package.json</em> fügen wir noch die Watch-Konfiguration.</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"highlight-line\"><span class=\"token comment\">// package.json</span></span><br><span class=\"highlight-line\"> <span class=\"token property\">\"watch\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      <span class=\"token property\">\"patterns\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"src\"</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">      <span class=\"token property\">\"extensions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"js,jsx\"</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">]</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span></code></pre>\n<p>Unter watch kommt der Befehl, der nach einer Änderung ausgeführt werden soll. Es ist der bekannte, und oben genannte Build-Befehl. Um das Watching zu starten, benötigen wir einen weiteren Skritpbefehl.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token string\">\"dev\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"npm-watch build\"</span>,</span></code></pre>\n<p>Ich hab mir angewöhnt meine Arbeitstasks immer &quot;dev&quot; zu nennen.<br>\nMit <em>npm run dev</em>. Starte ich damit den Watcher, der beobachtet die Dateien unter <em>patterns</em> mit der Dateiendung (<em>extensions</em>) <em>.js, .jsx</em>.</p>\n<p>Das erhöht ungemein die Arbeitsgeschwindigkeit und den Komfort.</p>\n<h4 id=\"plugin-development\" tabindex=\"-1\">Plugin Development <a class=\"direct-link\" href=\"#plugin-development\">#</a></h4>\n<p>Jetzt geht es an die Fachlichkeit. Wie bereits erwähnt ist die <em>register.js</em> die Einstiegsdatei für das UI.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token comment\">// register.js</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> addons<span class=\"token punctuation\">,</span> types <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@storybook/addons\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AddonPanel <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@storybook/components\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token constant\">ADDON_ID</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"myaddon\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token constant\">PANEL_ID</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">ADDON_ID</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/panel</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">addons<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADDON_ID</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">api</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    addons<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PANEL_ID</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        type<span class=\"token operator\">:</span> types<span class=\"token punctuation\">.</span><span class=\"token constant\">PANEL</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        title<span class=\"token operator\">:</span> <span class=\"token string\">\"My Hello World\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> active<span class=\"token punctuation\">,</span> key <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>AddonPanel active<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>active<span class=\"token punctuation\">}</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span> hello world <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>AddonPanel<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die ersten vier Zeilen beinhalten die imports der Kernbibliothek React und die Elemente von Storybook. Das Addon benötigt eine ID um sich aufzubauen. In dem Callback der <em>register</em>-Funktion hat man nun die Möglichkeit <a href=\"https://storybook.js.org/docs/react/addons/addon-types#ui-based-addons\">drei Hauptelemente</a> zu erweitern:</p>\n<ul>\n<li><a href=\"https://derkuba.de/content/posts/1021/component-lib-storybook/\">das Panel</a> zu gestalten.</li>\n<li>die Toolbar</li>\n<li>die Tabs</li>\n</ul>\n<p>In unserem Fall erweitern wir das Panel. In den Zeilen 14-16 sehen wir die Storybook-Panelkomponente. Im Bauch dieser Komponente beginnt unsere grüne Wiese. Dort platzieren wir das DIV mit Hello-World.</p>\n<h4 id=\"addon-im-einsatz\" tabindex=\"-1\">Addon im Einsatz <a class=\"direct-link\" href=\"#addon-im-einsatz\">#</a></h4>\n<p>Wir haben jetzt eine erste lauffähige Version. Doch wie bekommen wir diese nun zu sehen. Ich habe dafür mein bestehendes <a href=\"https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib\">Storybook-Projekt</a> genutzt. Aber jedes andere bestehende Storybook-Projekt ist dafür geeignet.</p>\n<p>Um das Addon nicht auf NPM zu packen und es erstmal lokal zu testen, gibt es einen Trick: <strong>npm link</strong>.</p>\n<p>Man linkt das Addon-Projekt mit dem bestehenden Projekt. Dafür muss man jeweils im Addonprojekt und im &quot;Zielprojekt&quot; einen npm Befehl ausführen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">//addonverzeichnis</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">(</span>sudo<span class=\"token punctuation\">)</span> <span class=\"token function\">npm</span> <span class=\"token function\">link</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">// im Zielverzeichnis</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">(</span>sudo<span class=\"token punctuation\">)</span> <span class=\"token function\">npm</span> <span class=\"token function\">link</span> <span class=\"token punctuation\">[</span>NAME IM PACKAGE.JSON<span class=\"token punctuation\">]</span></span></code></pre>\n<p>Ich habe sudo in Klammern geschrieben, weil es auf meiner Kiste nicht funktioniert. Auf anderen Rechnern soll es auch ohne funktionieren. Einfach mal ausprobieren.</p>\n<p>Jetzt muss das Addon nur noch im Zielprojekt in der Storybook-Konfiguration eingetragen werden.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token comment\">// .storybook/main.js</span></span><br><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    stories<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"../src/**/*.stories.mdx\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"../src/**/*.stories.@(js|jsx|ts|tsx)\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    addons<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-links\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-essentials\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// einfach unter die eingetragenen Addons hinzufügen</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"NAME-DES_ADDONS/dist\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wenn man nun das Zielprojekt startet, sollte man in jeder Story ein drittes Paneltab sehen, in dem Hello World steht. Durch das Watchskript sieht man nun auch jede Änderung am Addonquellcode direkt beim Neuladen der Seite. Ein Traum zum Entwickeln.</p>\n<p>Jetzt steht euren Ideen nichts mehr im Weg.</p>\n<h4 id=\"ver%C3%B6ffentlichung\" tabindex=\"-1\">Veröffentlichung <a class=\"direct-link\" href=\"#ver%C3%B6ffentlichung\">#</a></h4>\n<p>Um das Plugin in den <a href=\"https://storybook.js.org/docs/react/addons/addon-catalog\">Storybook Addon Katalog</a> zu bekommen, muss man noch zwei Dinge tun:</p>\n<ul>\n<li>die Storybook-Metainformation in die package.json ergänzen</li>\n<li>das Addon bei NPM hosten</li>\n</ul>\n<h4 id=\"storybook-metainformation\" tabindex=\"-1\">Storybook Metainformation <a class=\"direct-link\" href=\"#storybook-metainformation\">#</a></h4>\n<p>Damit Storybook euer Addon findet müsst erstmal in der <em>package.json</em> die Felder <em>name</em>, <em>description</em>, <em>author</em>, <em>keywords</em>, <em>repository</em> ausfüllen.</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"highlight-line\"><span class=\"token comment\">// Beispiel aus meinem Addon</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"storybook-addon-custom-event-broadcaster\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"storybook addon for broadcasting custom events\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/preset.js\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"keywords\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"storybook-addons\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"custom-events\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"code\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"debug\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Jacob Pawlik &lt;jacob@derkuba.de> (http://derkuba.de)\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">     <span class=\"token property\">\"repository\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"git\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"git+https://github.com/derKuba/storybook-custom-event-broadcaster.git\"</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  ...</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Für die richtige Anzeige im Katalog werden noch die Attribute <em>displayName</em>, <em>icon</em>, <em>unsupportedFrameworks</em>, <em>supportedFrameworks</em> zur Verfügung gestellt. Diese sind aber Optional.</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"highlight-line\"><span class=\"token comment\">// Beispiel aus meinem Addon</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"storybook\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"displayName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Custom Events Broadcaster\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"supportedFrameworks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">      <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">      <span class=\"token string\">\"angular\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">      <span class=\"token string\">\"stenciljs\"</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"icon\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">```</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">#### NPM</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">Um ein package (so heißen dort die Pakete - es handelt sich aber um euer Addon) bei <span class=\"token punctuation\">[</span>npmjs<span class=\"token punctuation\">]</span>(https<span class=\"token operator\">:</span><span class=\"token comment\">//www.npmjs.com/) abzulegen, benötigt man ein Konto dort. Man registriert sich und (WICHTIG) bestätigt die E-Mailadresse. Wenn man dies nicht tut bekommt man eine kryptische Fehlermeldung.</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">```ts</span><br><span class=\"highlight-line\">pm ERR! code E403</span><br><span class=\"highlight-line\">npm ERR! <span class=\"token number\">403</span> <span class=\"token number\">403</span> Forbidden - GET</span><br><span class=\"highlight-line\">npm ERR! <span class=\"token number\">403</span> In most cases<span class=\"token punctuation\">,</span> you or one of your dependencies are requesting</span><br><span class=\"highlight-line\">npm ERR! <span class=\"token number\">403</span> a package version that is forbidden by your security policy.</span></code></pre>\n<p>Nein, ihr habt dann keine verbotenen Pakete, sondern eure E-Mailadresse wurde nicht bestätigt ( dankt mir später :-) ).</p>\n<p>Als nächstes müsst ihr euch per npm einloggen. Auch hier gibts 2 Möglichkeiten.</p>\n<ol>\n<li>ihr führt <em>npm login</em> aus und gibt eure Credentials ein</li>\n<li>ihr hinterlegt eure Credentials in eurer globalen (im Homeverzeichnis) ~/.npmrc</li>\n</ol>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">registry<span class=\"token operator\">=</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">registry.npmjs.com</span><span class=\"token regex-delimiter\">/</span></span></span><br><span class=\"highlight-line\">_auth<span class=\"token operator\">=</span><span class=\"token string\">\"&lt;token>\"</span></span><br><span class=\"highlight-line\">email<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>email<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">always<span class=\"token operator\">-</span>auth<span class=\"token operator\">=</span><span class=\"token boolean\">true</span></span></code></pre>\n<p>Den Token könnt ihr in eurem Benutzerprofil auf der Webseite erstellen.</p>\n<p>Wenn das alles geklappt hat, muss man es noch veröffentlichen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">// für die vorsichtigen</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> publish -- dry run</span></code></pre>\n<p>Das simuliert eine Veröffentlichung und man bekommt Feedback ob alles passt.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> publish --access public</span></code></pre>\n<p>Veröffentlicht euer package. Ihr findet das nun unter eurem Benutzerkonto unter <em>packages</em>. Manchmal benötigt es einige Zeit, bis ihr über die NPM-Suche fündig werdet. Ein bisschen Geduld ist gefragt. Um sicher zu gehen gibt es die Möglichkeit zu versuchen das Paket anzuzeigen oder zu installieren.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">npm install packageName</span><br><span class=\"highlight-line\">npm show packagename</span></code></pre>\n<p>Das wars. Bei mir hat es gut 30 Stunden gedauert und mein Plugin war im Katalog zu finden.</p>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>Ich hoffe, dass dieser Artikel helfen kann weitere tolle Addons für Storybook zu schreiben und Storybook helfen noch besser zu werden. Es ist sehr einfach und schafft einen Spielplatz für viele Möglichkeiten und Ideen.</p>\n<p>Schaut gerne mal in unser Addon rein und gebt mir gerne Feedback.</p>\n<p><a href=\"https://storybook.js.org/addons/storybook-addon-custom-event-broadcaster/\">https://storybook.js.org/addons/storybook-addon-custom-event-broadcaster/</a></p>\n<p><a href=\"https://www.npmjs.com/package/storybook-addon-custom-event-broadcaster\">https://www.npmjs.com/package/storybook-addon-custom-event-broadcaster</a></p>\n<p><br>\nDer Code hierzu liegt auf <a href=\"https://github.com/derKuba/\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a> oder per <a href=\"mailto:jacob@derkuba.de\"> E-Mail</a> .</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-11-09T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/1021/stencil-builds-for-using-component-lib/",
      "url": "https://derkuba.de/content/posts/1021/stencil-builds-for-using-component-lib/",
      "title": "Verwendung der Component Library aus dem StencilJS Build",
      "content_html": "<p>In den letzten beiden Artikeln habe ich gezeigt wie man eine Komponentenbibliothek aufsetzt und wie man Storybook benutzt. Damit ist die Grundlage geschaffen. Was ist der nächste logische Schritt, wenn man einige (oder alle) Komponenten fertig hat? Richtig! Man möchte diese verwenden.<br>\nDie Grundidee ist die Arbeitsteilung. Ein Team/Spezialist kümmert sich um die Komponentenbibliothek und stellt diese anderen Teams zur Verfügung.<!-- endOfPreview --><br>\nDie anderen Teams haben dadurch mehr Zeit sich um die Implementierung der Fachlichkeit und Businesslogik zu kümmern.</p>\n<p>Ich habe den Artikel in drei Teile gegliedert:</p>\n<ol>\n<li><a href=\"#stencil-builds\">Was sind die StencilJS-Builds a.k.a. Output-Targets?</a></li>\n<li><a href=\"#wie-wende-ich-diese-an%3F\">Wie wende ich diese an?</a></li>\n<li><a href=\"#fazit\">Fazit</a></li>\n</ol>\n<h4 id=\"was-sind-die-stenciljs-builds%2C-bzw%2C-output-targets%3F\" tabindex=\"-1\">Was sind die StencilJS-Builds, bzw, Output-Targets? <a class=\"direct-link\" href=\"#was-sind-die-stenciljs-builds%2C-bzw%2C-output-targets%3F\">#</a></h4>\n<p>Langer Rede kurzer Sinn. Die Ausgangslage sieht so aus, dass wir einige Komponenten in <a href=\"https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib\">unserem component-lib Projekt</a> (Kuba-Button, My-Component, Kuba-Input) liegen haben. Diese stellen wir nun zur Verfügung. Dazu müssen wir uns anschauen, wie <a href=\"https://stenciljs.com/docs/output-targets\">StencilJS</a> dies ermöglicht.</p>\n<table>\n<thead>\n<tr>\n<th>Build parameter</th>\n<th style=\"text-align:center\">Output</th>\n<th>Funktion</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>dist</td>\n<td style=\"text-align:center\">- cjs, collection, component-lib, types, index.js</td>\n<td>Komponenten als wiederverwendbare Bibliothek inklusive Lazy Loading</td>\n</tr>\n<tr>\n<td>dist-custom-elements</td>\n<td style=\"text-align:center\">- index.js, *.js (jede einzelne Komponente.js)</td>\n<td>Empfohlene Einstellung zur Verwendung der Komponenten in Frameworks. tree-shaking-optimiert. Jede Komponente wird einzeln importierbar aus ihrer eigenen Datei</td>\n</tr>\n<tr>\n<td>dist-custom-elements-bundle</td>\n<td style=\"text-align:center\">- index.js, *.js (jede einzelne Komponente.js)</td>\n<td>Dasselbe wie zuvor, nur dass die Komponenten in einem großen Bundle zusammen sind.</td>\n</tr>\n<tr>\n<td>www</td>\n<td style=\"text-align:center\">./www</td>\n<td>Eine fertig gepackte Webseite. Dient zum Debugging, aber auch zum adaptieren zum eingen Zweck. Die Einbindung und Benutzung der Komponenten wird hier am Beispiel gezeigt.</td>\n</tr>\n<tr>\n<td>docs-readme</td>\n<td style=\"text-align:center\"><a href=\"http://readme.md\">readme.md</a></td>\n<td>Erzeugt neben jeder Komponente eine Dokumentationsdatei. Die weiteren Docs-Properties erstellen analoge Dokumentationsdateien.</td>\n</tr>\n</tbody>\n</table>\n<p>Wenn man sich diese breite Palette an Build-Optionen anschaut, wird man im ersten Moment erschlagen. Man muss ganz genau wissen, welchen Zweck man verfolgt. Benutze ich Komponenten in einem Web-Framework oder in einer Webanwendung. Benötige ich die Komponenten zum Bauen einer Webseite?<br>\nJede Variante hat seine Vor- und Nachteile.</p>\n<p><strong>dist</strong></p>\n<p><strong>+</strong> Große Auswahl an Einbindungsmöglichkeiten<br>\n<b>-</b> Es wird mehr erzeugt als man wohl möglich benötigt<br>\n<b>-</b> sehr unspezifisch</p>\n<p><strong>dist-custom-elements</strong><br>\n<strong>+</strong> Gute Möglichkeit einzelne Komponenten zu bauen<br>\n<strong>+</strong> Man hat nur den Code den man braucht<br>\n<b>-</b> Benötigt einen Bundler, damit es im Browser läuft<br>\n<b>-</b> stencil-core wird benötigt</p>\n<p><strong>dist-custom-elements</strong><br>\n<strong>+</strong> Stellt alle Komponenten zur Verfügung<br>\n<b>-</b> Benötigt einen Bundler, damit es im Browser läuft<br>\n<b>-</b> stencil-core wird benötigt</p>\n<p><strong>www</strong><br>\n<strong>+</strong> Erzeugt einen Webseiten-Skeleton<br>\n<strong>+</strong> Benötigt keinen Bundler, keinen zusätzlichen Code<br>\n<strong>+</strong> Lazy Loading optimiert<br>\n<b>-</b> Keine einzelnen Komponenten extrahierbar<br>\n<b>-</b> Erzeugt sehr viele Dateien, die einzeln nachgeladen werden (automagisch)</p>\n<h4 id=\"wie-wende-ich-diese-an%3F\" tabindex=\"-1\">Wie wende ich diese an? <a class=\"direct-link\" href=\"#wie-wende-ich-diese-an%3F\">#</a></h4>\n<p>Für die Präsentation der Anwendung habe ich im Beispielprojekt einen Unterordner <a href=\"https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib-usage\">&quot;component-lib-usage&quot; angelegt</a>. In diesem befinden sich die Beispiel HTML-Seiten, die das jeweilige Build-Ziel einbinden. Dazu gibt es noch den Bundling-Code.</p>\n<p>Die Anwendung umfasst immer drei Teile:</p>\n<ol>\n<li>Konfiguration Build-Ziel</li>\n<li>optional Bundling</li>\n<li>Einbindung in eine HTML</li>\n</ol>\n<p>Für das Bundling verwende ich <a href=\"https://webpack.js.org/\">Webpack</a> und zum Anzeigen der Webseite (um das Nachladen der Module zu simulieren) den Python SimpleHTTPServer. Aber es ist total egal was man hier verwendet. Das Bundling muss das Importieren von Modulen ermöglichen und ein Webserver muss Dateien an den Browser ausliefern können.</p>\n<h4 id=\"konfiguration-der-builds\" tabindex=\"-1\">Konfiguration der Builds <a class=\"direct-link\" href=\"#konfiguration-der-builds\">#</a></h4>\n<p>Die Konfiguration der Build-Ziele erfolgt in der StencilJS-Konfigurationsdatei und wird unter dem Key <em>outputTargets</em> gesteuert. Da das <em>dist</em> quasi die folgenden drei Möglichkeiten umfasst, beschreibe ich diese einzeln.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// stencil.config.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Config <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> config<span class=\"token operator\">:</span> Config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    namespace<span class=\"token operator\">:</span> <span class=\"token string\">\"component-lib\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    outputTargets<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            esmLoaderPath<span class=\"token operator\">:</span> <span class=\"token string\">\"../loader\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token string\">\"dist-custom-elements\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token string\">\"dist-custom-elements-bundle\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token string\">\"www\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            serviceWorker<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// disable service workers</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token string\">\"docs-readme\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">npm run build</span><br><span class=\"highlight-line\"><span class=\"token comment\">// oder</span></span><br><span class=\"highlight-line\">stencil build</span></code></pre>\n<p>Den Inhalt des dist-Verzeichnissen, kopiere ich unter component-lib-usage.</p>\n<p><strong>dist-custom-elements</strong><br>\nWenn man den Stencil-Bau-Befehl ausführt, erhält man unter /dist/components/ alle Komponenten als einzelne Dateien. Im Beispielprojekt erscheinen so die Dateien <em>kuba-button.js, kuba-input.js, kuba-wizard.js, ...</em> . Durch das Kopieren befinden sich dieser Dateien nun unter /component-lib-usage/components.<br>\nLaut der Dokumentation von Stenciljs können diese über folgenden Code geladen werden:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// init_kuba_button.js</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> KubaButton <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./kuba-button\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">customElements<span class=\"token punctuation\">.</span><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">,</span> KubaButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Das stellt dem Browser die neuen Elemente vor und diese können dann einfach im HTML aufgerufen werden. Wenn man das so naiv macht, wie ich das gemacht habe, spuckt der Browser (Chrome) den Fehler aus, dass er <em>import</em> nicht kennt. Hier kommt Webpack zum Einsatz. Als Beispiel möchte ich den Kuba-Button verwenden.<br>\nEin Bundler braucht eine Einstiegsdatei, um alle Imports aufzulösen. Dazu kopieren ich den Code in die neue Datei <em>init_kuba_button.js</em>. Jetzt benötige ich eine Webpack-Konfig und einen NPM befehl, um webpack zu starten:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// webpack.component.config</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    entry<span class=\"token operator\">:</span> <span class=\"token string\">\"./components/init_kuba_button.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Entry File</span></span><br><span class=\"highlight-line\">    output<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        path<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//Output Directory</span></span><br><span class=\"highlight-line\">        filename<span class=\"token operator\">:</span> <span class=\"token string\">\"components/bundle.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//Output file</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// package.json script</span></span><br><span class=\"highlight-line\"> <span class=\"token string\">\"build_single_component\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack --mode production --config=webpack.component.config.js\"</span></span></code></pre>\n<p>Dies erzeugt unter dist/components/ eine <em>bundle.js</em>. Diese Datei müssen wir jetzt in ein HTML-Skeleton einbinden:</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"highlight-line\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">dir</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ltr<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Custom Component<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>./dist/components/bundle.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>Hello Welt components<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-button</span><span class=\"token punctuation\">></span></span>Hello<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-button</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></span></code></pre>\n<p>In Zeile 6 sehen wir die Einbindung der <em>bundle.js</em> im script-tab. Das Besondere zeigt die Zeile 11. Hier verwenden wir die Kuba-Komponente als wäre sie ein existierendes HTML Tag.<br>\nSchauen wir uns die Datei nun über den Browser an, der auf den Python-Webserver zugreift an, sehen wir, dass auch funktioniert:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">python -m SimpleHTTPServer</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">// im browser unter</span><br><span class=\"highlight-line\">http://localhost:8000</span></code></pre>\n<p><img src=\"/content/img/1021/index_component.png\" alt=\"component einstieg\" title=\"component einstieg\"><div class=\"has-text-right image-subline\">Bild 1: Einzelne Komponente</div></p>\n<p><strong>dist-custom-elements-bundle</strong><br>\nNach dem build-Befehl entsteht ein Ordner unter /dist/custom-elements mit jeweils einer <em>index.ts</em>-Datei und der dazugehörigen <em>index.d.ts</em>-Datei. Diesmal sind alle gebauten Komponenten in der Datei gepackt. Aber auch hier bitte ich um Vorsicht. Es ist für Frameworks, bzw. für das moderne JS optimiert und läuft nicht out-of-the-box im Browser. Wir müssen auch hier erst einmal mit Hilfe von Webpack ein browserfähiges Bundle bauen.<br>\nWir kopieren den Inhalt des Ordners in unser neues Projekt.<br>\nAuch hier brauchen wir ein Einstiegsdatei:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// custom-elements/bundler.js</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defineCustomElements <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./index\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">defineCustomElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>und die dazugehörige Webpack-Config mitsamt package.json Skriptbefehl:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// webpack.component.config</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  entry<span class=\"token operator\">:</span> <span class=\"token string\">\"./custom-elements/bundler.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Entry File</span></span><br><span class=\"highlight-line\">  output<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    path<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//Output Directory</span></span><br><span class=\"highlight-line\">    filename<span class=\"token operator\">:</span> <span class=\"token string\">\"custom-elements/bundle.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//Output file</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// package.json script</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">\"build_custom_elements\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack --mode production --config=webpack.custom-elements.config.js\"</span><span class=\"token punctuation\">,</span></span></code></pre>\n<p>Wenn wir diesen Befehl ausführen erhalten wir unter /dist/custom-elements eine bundle.js. Diese referenzieren nun in unserem neuen HTML-Skeleton.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token constant\">DOCTYPE</span> html<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>html dir<span class=\"token operator\">=</span><span class=\"token string\">\"ltr\"</span> lang<span class=\"token operator\">=</span><span class=\"token string\">\"en\"</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string\">\"utf-8\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>Mein <span class=\"token constant\">HTML</span> Projekt<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"./dist/custom-elements/bundle.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello Welt custom<span class=\"token operator\">-</span>elements<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>my<span class=\"token operator\">-</span>component</span><br><span class=\"highlight-line\">            first<span class=\"token operator\">=</span><span class=\"token string\">\"Stencil\"</span></span><br><span class=\"highlight-line\">            last<span class=\"token operator\">=</span><span class=\"token string\">\"'Don't call me a framework' JS\"</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>my<span class=\"token operator\">-</span>component<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span>Hello<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span></span></code></pre>\n<p>Analog zu dem vorherigen Beispiel sieht man in Zeile 7 die Einbindung und ab Zeile 11 die Verwendung der &quot;neuen&quot; HTML-Tags.</p>\n<p><img src=\"/content/img/1021/custom-element-index.png\" alt=\"Custom Elements Bundle\" title=\"Custom Elements Bundle\"><div class=\"has-text-right image-subline\">Bild 2: Custom Elements Bundle</div></p>\n<p><br>\n<strong>www build</strong><br>\nNach dem build-Befehl hat man einen Ordner <em>www</em>. Diesen kopieren wir in das neue Projekt. Hier ist schon alles fertig transpiliert. Es ist lauffähig im Browser. Wir benötigen nur einen neuen HTML-Skeleton:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token constant\">DOCTYPE</span> html<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>html dir<span class=\"token operator\">=</span><span class=\"token string\">\"ltr\"</span> lang<span class=\"token operator\">=</span><span class=\"token string\">\"en\"</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string\">\"utf-8\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span><span class=\"token constant\">WWW</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>script type<span class=\"token operator\">=</span><span class=\"token string\">\"module\"</span> src<span class=\"token operator\">=</span><span class=\"token string\">\"www/build/component-lib.esm.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>script nomodule src<span class=\"token operator\">=</span><span class=\"token string\">\"www/build/component-lib.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello Welt<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>my<span class=\"token operator\">-</span>component</span><br><span class=\"highlight-line\">            first<span class=\"token operator\">=</span><span class=\"token string\">\"Stencil\"</span></span><br><span class=\"highlight-line\">            last<span class=\"token operator\">=</span><span class=\"token string\">\"'Don't call me a framework' JS\"</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>my<span class=\"token operator\">-</span>component<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span>Hello<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span></span></code></pre>\n<p>In Zeile 7 und 8 sieht man die Einbindung. Danach hat man Zugriff auf seinen Komponentenkatalog (Zeile 11-14). Die Darstellung im Browser ist Analog zu Bild 2.</p>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>In diesem Artikel habe ich gezeigt wie man seine eigene Komponentenbibliothek ausliefert und integriert anhand der verschiedenem Builds von StencilJS. Ab jetzt sollte jeder in der Lage sein das Projekt nachzustellen. Vielleicht habe ich die Lust geweckt auf so eine Komponentenbibliothek zu setzen. Wir haben damit bereits sehr gute Erfahrungen gesammelt und folgen diesem Pattern sehr gerne. Ich finde es ist eine tolle Technologie und Methodik.</p>\n<p>Der Code liegt wie immer auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-10-31T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/1021/component-lib-storybook/",
      "url": "https://derkuba.de/content/posts/1021/component-lib-storybook/",
      "title": "Storybook im Einsatz",
      "content_html": "<p>In meinem letzten Artikel habe ich <a href=\"https://storybook.js.org/\">Storybook</a> vorgestellt. Heute möchte ich die Bedienung erklären. Es ist ein tolles Tool mit vielen Möglichkeiten, um eure Komponenten zu entwickeln, zu katalogisieren oder sogar zu testen.<!-- endOfPreview --> Dazu gibt es die Möglichkeit das Programm durch Addons zu erweitern. Es gibt eine große Auswahl an bestehenden Addons und dazu noch eine API, um selber eigenen Addons zu entwickeln. Dazu gibt es bald einen eigenen Artikel.</p>\n<p>Ich stelle euch jetzt vor:</p>\n<ul>\n<li>Wie ist Storybook aufgebaut?</li>\n<li>Wie ist meine Komponente dokumentiert?</li>\n<li>Wie dynamisiere und dokumentiere ich die Properties meiner Komponente?</li>\n<li>Wie installiere ich ein Addon?</li>\n</ul>\n<h4 id=\"wie-ist-storybook-aufgebaut%3F\" tabindex=\"-1\">Wie ist Storybook aufgebaut? <a class=\"direct-link\" href=\"#wie-ist-storybook-aufgebaut%3F\">#</a></h4>\n<p><img src=\"/content/img/1021/storybook-overview.png\" alt=\"Storybook aufbau\" title=\"Aufbau Storybook\"></p>\n<div class=\"has-text-right image-subline\">Bild 1: Aufbau Storybook</div>\n<p>Ich habe Storybook in seine wesentlichen Bereiche eingeteilt:</p>\n<p><strong>Grün - linker Bereich</strong><br>\nDie Seitenleiste enthält eine <strong><em>Suche</em></strong>, die alle bestehenden Komponenten durchsucht. Dabei wird nach der Zeichenkette innerhalb des Namens gesucht.<br>\nÜber der Suchleiste ist ein Burger-Icon, das ein Menü öffnet. Darin befinden sich Links zu den Releasenotes und der About-Seite. Aber viel wichtiger sind die <strong><em>Shortcuts für die Tastatur</em></strong></p>\n<p><strong>Rot - oberer Bereich</strong><br>\nDie obere Leiste enthält die <strong><em>Navigation</em></strong> zur Malfläche, in denen die Komponente gerendert wird oder zur Dokumentationsansicht, in der man weitere Informationen zur Komponente hinterlegen kann. Die übrigen Icons enthalten <strong><em>Werkzeuge zur Darstellung</em></strong>.</p>\n<p><img src=\"/content/img/1021/storybook-tools.gif\" alt=\"Storybook Tools\" title=\"Storybook Tools\"></p>\n<p>Sie beinhalten von links nach rechts folgende Funktionen:</p>\n<ul>\n<li>Vergrößern / Zoomen</li>\n<li>Verkleinern / Zoomout</li>\n<li>Zurücksetzen des Zooms</li>\n<li>Hintergrund der Malfläche ändern (hell/dunkel)</li>\n<li>Gitternetz ein/ausblenden</li>\n<li>Anzeige/Größe der Komponente in mobiler Ansicht (klein, groß) oder Tablet</li>\n<li>Messfunktion (Komponenten werden markiert und die Pixelgröße angegeben)</li>\n<li>Umrandung der Komponente anzeigen</li>\n<li>Vollbild</li>\n<li>Komponente im neuen Tab/Reiter öffnen</li>\n<li>Link zur Seite kopieren</li>\n</ul>\n<div class=\"has-text-right image-subline\">Bild 2*: Animation Tools</div>\n<p><br>\n<strong>Blau - mittlerer Bereich</strong><br>\nIn diesem Bereich, das Canvas oder die Malfläche, befindet sich die gerenderte Komponente, mit der man interagieren kann.</p>\n<p><strong>Gelb - unterer Bereich</strong><br>\nDer gelbe Bereich beinhaltet die Addon-Leiste. Hier sind standardmäßig der Controls und der Actions Tab vorhanden. Ersterer ermöglicht das dynamische Übergeben von Parametern an die Komponente (Beispiel folgt). Der Actions-Tab gibt dem Nutzer die Möglichkeit Events (Click, Mouseover, etc.) auszuloggen. Ich persönliche arbeite nur mit der Controls-Leiste.</p>\n<p>Insgesamt muss man sagen, dass es sehr übersichtlich gestaltet ist.</p>\n<h4 id=\"wo-ist-meine-komponente-dokumentiert%3F\" tabindex=\"-1\">Wo ist meine Komponente dokumentiert? <a class=\"direct-link\" href=\"#wo-ist-meine-komponente-dokumentiert%3F\">#</a></h4>\n<p>Klickt man in dem rot markierten Bereich auf den Knopf <strong><em>Docs</em></strong> kommt man in die Beschreibung der Komponente:</p>\n<p><img src=\"/content/img/1021/storybook-docs.png\" alt=\"Storybook Docs\" title=\"Storybook Docs\"></p>\n<div class=\"has-text-right image-subline\">Bild 3: Dokumenationsansicht</div>\n<p>Der Aufbau ist übersichtlich. Es beginnt mit einer Leiste, die eine Zoom-Funktion hat. Darunter befindet sich die gerenderte Komponente. Diese Ansicht hat im rechten, unteren Rand einen Knopf, der den dazugehörigen Code einblendet (im Bild bereits ausgeklappt). Wiederum unter der Malfläche ist eine Tabelle, in der man die Properties der Komponente konfigurieren kann. Allerdings erscheint diese Tabelle nur, wenn dies konfiguriert wird.</p>\n<h4 id=\"wie-dynamisiere-und-dokumentiere-ich-die-properties-meiner-komponente%3F\" tabindex=\"-1\">Wie dynamisiere und dokumentiere ich die Properties meiner Komponente? <a class=\"direct-link\" href=\"#wie-dynamisiere-und-dokumentiere-ich-die-properties-meiner-komponente%3F\">#</a></h4>\n<p>Zunächst muss man wissen welche Properties die Komponente hat und welche man dynamisieren möchte. Mit Dynamisierung meine ich die Möglichkeit die Properties zur Laufzeit zu verändern. So kann man zum Beispiel das Design herausfordern und extra lange Labels ausprobieren. In den großen Frameworks wie React werden die Controls sogar automatisch erkannt. Ist dies nicht möglich (wie z.B. in StencilJS) muss man dies händisch machen. Dazu erweitert man in der Story der Komponente <em>*.stories.tsx</em> das anonyme Objekt um das Attribut <strong><em>argTypes</em></strong>.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    title<span class=\"token operator\">:</span> <span class=\"token string\">\"Content/My-Component\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    parameters<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    argTypes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Jede Property erhält nun einen eigenen Eintrag bestehend aus diesen Feldern:</p>\n<ul>\n<li>name -&gt;</li>\n<li>type -&gt; Datentyp und required</li>\n<li>defaultValue -&gt; vorbelegter Wert</li>\n<li>Beschreibung -&gt; hier wird dokumentiert</li>\n<li>control -&gt; Welcher Input-Type wird benötigt</li>\n</ul>\n<p>Ausgefüllt habe ich es exemplarisch für die StencilJS-Starter-Komponente <strong><em>my-component</em></strong>, die einen Vornamen, Mittelnamen und Namen als Property annimmt, um dann eine Grußformel auszugeben:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    title<span class=\"token operator\">:</span> <span class=\"token string\">\"Content/My-Component\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    parameters<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    argTypes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        firstname<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"firstname\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">,</span> required<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            defaultValue<span class=\"token operator\">:</span> <span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            description<span class=\"token operator\">:</span> <span class=\"token string\">\"der Vorname\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token operator\">*</span></span><br><span class=\"highlight-line\">            control<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                type<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        middlename<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"middlename\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">,</span> required<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            defaultValue<span class=\"token operator\">:</span> <span class=\"token string\">\"Dabelju\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            description<span class=\"token operator\">:</span> <span class=\"token string\">\"zweiter Vorname\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            control<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                type<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        lastname<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"lastname\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            type<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">,</span> required<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            defaultValue<span class=\"token operator\">:</span> <span class=\"token string\">\"Nachname\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            description<span class=\"token operator\">:</span> <span class=\"token string\">\"von Adelher\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            control<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                type<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Der Code erklärt sich selbst. Wer weitere Input-Felder für Select-Listen, Checkboxes, Radiobuttons etc. benötigt, schaut kurz in die <a href=\"https://storybook.js.org/docs/html/essentials/controls\">Doku</a>.</p>\n<p>Die Control-Ansicht in Aktion sieht so aus:</p>\n<p><img src=\"/content/img/1021/storybook-controls.gif\" alt=\"Storybook Controls\" title=\"Storybook Controls\"></p>\n<div class=\"has-text-right image-subline\">Bild 3*: Animation Eingabe</div>\n<p>Zur Eingabe wird die Komponente neu gerendert.</p>\n<br/>\n<h4 id=\"wie-installiere-ich-ein-addon%3F\" tabindex=\"-1\">Wie installiere ich ein Addon? <a class=\"direct-link\" href=\"#wie-installiere-ich-ein-addon%3F\">#</a></h4>\n<p>Storybook bietet eine bunte Palette an Erweiterungen an. Ich empfehle jedem mal durch den <a href=\"https://storybook.js.org/addons\">Katalog</a> zu blättern. Ich habe bei der Vorbereitung für diesen Artikel in der <a href=\"https://next--storybookjs.netlify.app/official-storybook/\">Storybook Demo</a> ein zusätzlichen Addon gesehen, dass ich euch vorstellen möchte: <a href=\"https://storybook.js.org/addons/@storybook/addon-storysource\"><strong>Storysource</strong></a>.</p>\n<p>Es fügt dem Addon-Panel den Reiter <em>Story</em> hinzu. In diesem befindet sich nun der Quellcode der Story. So hat man sofort den Einblick wie Storybook funktioniert und auch wie die Komponente aufgebaut ist. Ja, es redundant, weil es so etwas im <em>Docs</em>-Reiter zu finden gibt. Aber dort ist alles in HTML ummantelt. Hier ist der echte Code.</p>\n<p>Wie füge ich das Addon nun hinzu?</p>\n<p>Erst einmal muss ich es meinem Projekt hinzufügen:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> @storybook/addon-storysource</span></code></pre>\n<p>Dann muss es in der <em>.storybook/main.js</em> als Addon hinzugefügt werden:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    stories<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"../src/**/*.stories.mdx\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"../src/**/*.stories.@(js|jsx|ts|tsx)\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    addons<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-links\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-essentials\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// für die Standardkonfiguration anhängen</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-storysource\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Möchte man Einstellungen der Standardkonfiguration ändern, empfiehlt sich folgende Schreibweise:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    stories<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"../src/**/*.stories.mdx\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"../src/**/*.stories.@(js|jsx|ts|tsx)\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    addons<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-links\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@storybook/addon-essentials\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"@storybook/addon-storysource\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                rule<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                    <span class=\"token comment\">// test: [/\\.stories\\.jsx?$/], This is default</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">                    <span class=\"token comment\">// achtung, hier benötigt man noch</span></span><br><span class=\"highlight-line\">                    <span class=\"token comment\">// const path = require('path');</span></span><br><span class=\"highlight-line\">                    include<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"../src\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// You can specify directories</span></span><br><span class=\"highlight-line\">                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                loaderOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                    prettierConfig<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> printWidth<span class=\"token operator\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> singleQuote<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                sourceLoaderOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                    injectStoryParameters<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Das war auch schon alles. Wenn man alles richtig eingestellt hat, erhält man folgendes Bild:</p>\n<p><img src=\"/content/img/1021/storybook-story-addon.png\" alt=\"Storybook Story Addon\" title=\"Storybook Story Addon\"></p>\n<div class=\"has-text-right image-subline\">Bild 4: Richtig installiert</div>\n<p>Ich habe Storybook aufgsetzt und es bei <a href=\"https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib\">Github</a> für euch zur Verfügung gestellt. Auschecken, npm install und los geht es.</p>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>Mit der Beantwortung der oberen Fragen, habe ich versucht einen leichten Einstieg in Storybook zu schaffen. Ich habe es in allen professionellen Projekte, an denen ich arbeiten durfte, im Einsatz und möchte es auch nicht missen. Es ist ein sehr gutes Werkzeug.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n<p>* Die kleinen Gif-Animation wurden mit <a href=\"https://github.com/phw/peek\">Peek erstellt - einem Screen Recorder</a>.</p>\n",
      "date_published": "2021-10-15T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/1021/stencil-component-lib/",
      "url": "https://derkuba.de/content/posts/1021/stencil-component-lib/",
      "title": "Component Library mit Storybook und StencilJS",
      "content_html": "<p>Heute zeige ich wie man mit Hilfe von StencilJS und <a href=\"https://storybook.js.org/\">Storybook</a> eine wiederverwendbare Komponenten-Bibliothek aufbaut, die aus Web-Components besteht. Im ertsten Teil setzen wir das Projekt auf und verbinden die StencilJS mit Storybook. Im nächsten Teil zeige ich dann wie man die Webcomponents installiert und benutzt. <!-- endOfPreview --></p>\n<p>Zunächst klären wir was Storybook ist. Es beschreibt sich selbst als Entwicklungsumgebung für UI-Komponenten (<em>Storybook is a development environment for UI components</em>). Genauso würde ich es auch beschreiben. Es ist Framework, das einen Rahmen um deine Komponenten legt. Es hilft bei der Darstellung oder Katalogisierung, Entwicklung, Dokumentation und sogar beim Testen. Ich habe 2017 einige Alternativen ausprobiert, die es mittlerweile nicht mehr gibt. Aber Storybook hatte die besten Features. Es ist schnell aufgesetzt und konfiguriert. Um einen ersten Eindruck von den Fähigkeiten zu erhalten, empfehle ich <a href=\"https://next--storybookjs.netlify.app/official-storybook/?path=/story/addons-a11y-basebutton--default\">die offizielle Storybook Komponentenbibliothek</a>.</p>\n<p>Genug geredet. Hands on!</p>\n<h4 id=\"vorgehen\" tabindex=\"-1\">Vorgehen <a class=\"direct-link\" href=\"#vorgehen\">#</a></h4>\n<ol>\n<li>Installation StencilJS</li>\n<li>Installation Storybook</li>\n<li>Verdrahtung und Stories</li>\n</ol>\n<h4 id=\"installation-stenciljs-projekt\" tabindex=\"-1\">Installation StencilJS Projekt <a class=\"direct-link\" href=\"#installation-stenciljs-projekt\">#</a></h4>\n<p>Für die Installation habe ich <a href=\"https://derkuba.de/content/posts/stenciljs/projekt-aufsetzen/\">mein eigenes Tutorial genutzt</a>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> init stencil</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># wir wählen die dritte Option:</span></span><br><span class=\"highlight-line\">component     Collection of web components</span><br><span class=\"highlight-line\">              that can be used anywhere</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">Pick a starter › component</span><br><span class=\"highlight-line\">✔ Project name › comp-lib</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">✔ All setup  <span class=\"token keyword\">in</span> <span class=\"token number\">21</span> ms</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> comp-lib</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># stencil starten für die Hello-World Anwendung</span></span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> run start</span></code></pre>\n<h4 id=\"installation-storybook\" tabindex=\"-1\">Installation Storybook <a class=\"direct-link\" href=\"#installation-storybook\">#</a></h4>\n<p>Wir wählen als Projektgrundlage die Entwicklung von Komponenten (3. Option), vergeben einen Namen &quot;comp-lib&quot;, bestätigen, gehen in den Ordner und installieren die Abhängigkeiten:</p>\n<p>Genau in diesen Ordner installieren wir auch Storybook.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">npx sb init</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">? Do you want to manually choose a Storybook project <span class=\"token builtin class-name\">type</span> to install? Y</span><br><span class=\"highlight-line\">? Please choose a project <span class=\"token builtin class-name\">type</span> from the following list:</span><br><span class=\"highlight-line\">    ember</span><br><span class=\"highlight-line\">    web_components</span><br><span class=\"highlight-line\">    mithril</span><br><span class=\"highlight-line\">    marionette</span><br><span class=\"highlight-line\">    marko</span><br><span class=\"highlight-line\">❯   html <span class=\"token operator\">&lt;</span>-------</span><br><span class=\"highlight-line\">    riot</span><br><span class=\"highlight-line\">    preact</span><br><span class=\"highlight-line\">    svelte</span><br><span class=\"highlight-line\">  ↓ rax</span><br><span class=\"highlight-line\"></span></code></pre>\n<p>Wir wählen die manuelle Auswahl, um den Projekttyp zu bestimmen. Storybook kennt StencilJS nicht. Wer dasselbe mit einem React-Projekt ausführt, bekommt alles automatisch erstellt.<br>\nWir wählen deswegen HTML als Projekttyp. Wenn man versehentlich <em>web-components</em> auswählt, läuft in einen Dependency-Fehler <em>storybook Module not found: Error: Can't resolve 'lit-html' mit web components</em> und muss erneut den Wizard ausführen. Anschließend lädt der Wizard das halbe Internet herunter. Anschließend lässt sich Storybook starten:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run storybook</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">╭─────────────────────────────────────────────────────╮</span><br><span class=\"highlight-line\">│                                                     │</span><br><span class=\"highlight-line\">│   Storybook <span class=\"token number\">6.3</span>.10 started                          │</span><br><span class=\"highlight-line\">│   <span class=\"token number\">5.46</span> s <span class=\"token keyword\">for</span> preview                                │</span><br><span class=\"highlight-line\">│                                                     │</span><br><span class=\"highlight-line\">│    Local:            http://localhost:6006/         │</span><br><span class=\"highlight-line\">│    On your network:  http://192.168.178.48:6006/    │</span><br><span class=\"highlight-line\">│                                                     │</span><br><span class=\"highlight-line\">╰─────────────────────────────────────────────────────╯</span></code></pre>\n<p>Ruft man die URL im Browser auf sieht man dies:</p>\n<p><img src=\"/content/img/1021/storybook.png\" alt=\"Storybook Start\" title=\"Storybook\"><div class=\"has-text-right image-subline\">Bild 1: Aufruf <a href=\"http://localhost:6006\">http://localhost:6006</a></div></p>\n<p>Man bekommt diese Oberfläche geschenkt. Sie ist übersichtlich aufgebaut. Im linken Bereich sieht man die angelegten Komponenten. Button, Header und Page kommen aus dem Storybook-Starter. Es befindet sich eine Suche oben links, die die bestehenden Komponenten filtert. Rechts sieht man dann die Komponenten. Unter Canvas ist die gerenderte Komponente. Unter Docs kann man zusätzliche Informationen sehen, die man selber anlegen kann. Die restlichen Icons dienen der Veränderung der Darstellung. Bitte einmal alles an- und durchklickern.</p>\n<h4 id=\"verdrahtung\" tabindex=\"-1\">Verdrahtung <a class=\"direct-link\" href=\"#verdrahtung\">#</a></h4>\n<p>Da wir jetzt beide Applikation installiert haben und starten können, wollen wir diese beiden jetzt verbinden. Ich stelle mir folgenden Entwicklungsablauf vor.</p>\n<ol>\n<li>Erstellen/Verändern einer StencilJS Komponente</li>\n<li>Building-Process</li>\n<li>Aktualisierung in Storybook ohne Neustart</li>\n</ol>\n<p>Ich habe noch nichts über die angelegten Dateien erzählt. Man findet sich im StencilJS-Projekt zurecht. Storybook legt zwei wesentliche Ordner an:</p>\n<ul>\n<li><em>.storybook</em> =&gt; enthält die Konfiguration</li>\n<li><em>src/stories</em> =&gt; enthält das Beispielskeleton (lösche ich direkt)</li>\n</ul>\n<p>Für den ersten Punkt müssen wir nichts tun. Es ist bereits eine Beispielkomponente vorhanden. Der zweite Schritt erfolgt über den bereits angelegten Befehl:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">// inital einmal</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> run build</span></code></pre>\n<p>Es gibt auch einen Befehl, der die Dateien von StencilJS bewacht und automatisch bauen lässt. Aber diesen habe ich etwas abgeändert, weil der Parameter <em>--dev</em> keine Dateien anlegt.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">  <span class=\"token string\">\"dev:stencil\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"stencil build --watch\"</span>,</span></code></pre>\n<p>Parallel dazu gibt es den Befehl um Storybook zu starten:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">  <span class=\"token string\">\"storybook\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"start-storybook -p 6006\"</span>,</span></code></pre>\n<p>Jetzt müsste man zwei Konsolen öffnen, in den Ordner navigieren und beide Befehle parallel ausführen. Achtung. Es muss mindestens vorher einmal <em>npm run build</em> ausgeführt werden, sonst kommt es zu einem Fehler, da eine Dateistruktur erwartet wird, die initial nicht vorhanden ist.<br>\nDa dies aber kein pragmatischer Weg ist, empfehle ich folgendes Paket zu installieren: <strong>npm-run-all</strong>. Mit diesem kleinen Tool, kann man zwei Befehle parallel ausführen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">    // run-p ist nur ein shortcut</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"dev\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"run-p dev:stencil storybook\"</span>,</span></code></pre>\n<p>Über <strong>npm run dev</strong> haben wir jetzt genau das, was wir haben wollten. Wir könnten jetzt bequem mit der Arbeit starten und Komponenten schreiben. Aber eine Kleinigkeit fehlt noch. Wir müssen die gebauten Web-Components mit Storybook bekannt machen. Dazu öffnen wir die date <em>.storybook/preview.js</em> und ergänzen das Initialskript:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defineCustomElements <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../dist/esm/loader\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">defineCustomElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Damit haben wir jetzt auch die Frameworks verheiratet.</p>\n<p>Damit Storybook die Komponenten findet, benötigen wir Stories. Eine Story ist eine Datei, die man neben seine Komponente legt. In dieser hat man die Möglichkeit die Komponente mit dynamischen Eingaben/Properties zu füttern und diese noch zu Dokumentieren. Nehmen wir die bestehende <em>my-component</em> und versuchen diese in Storybook darzustellen.<br>\nDazu legen wir die Story-Datei an mit der Namenskonvention <em>-stories.tsx</em>.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// my-component.stories.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    title<span class=\"token operator\">:</span> <span class=\"token string\">\"Content/My-Component\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    parameters<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    argTypes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Template</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span></span><br><span class=\"highlight-line\">    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;my-component first=\"Max\" middle=\"Wolfgang\" last=\"Muster\">&lt;/my-component></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> MyComponent <span class=\"token operator\">=</span> <span class=\"token function\">Template</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Diese kleine Code-Snippet sorgt dafür, dass Storybook dies einsammelt und uns eine Seite erstellt.</p>\n<p>Im nächsten Artikel zeige ich wie man die Properties dynamisch erzeugt, weitere Punkte dokumentieren kann und auch die gebauten Web-Components in einem eigenen, weiteren Projekt verwenden kann.</p>\n<p><br>\nDer Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial/tree/main/component-lib\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-10-08T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/1021/flutter-e2e/",
      "url": "https://derkuba.de/content/posts/1021/flutter-e2e/",
      "title": "End to End Tests in Flutter",
      "content_html": "<p>Aktuell arbeite ich an einer APP mit Flutter. Letzte Woche habe ich einen ersten Prototypen auf mein Handy überspielt. Stolz habe ich es jemanden gegeben, um zuzuschauen wie mit der APP interagiert wird. Nach drei Klicks wurde der Bildschirm rot. Crash. <!-- endOfPreview --> Ende der Präsentation. Ich habe vorher zigfach durch die Applikation geklickt. Aber den einen Pfad habe ich ausgelassen. Jetzt kann man natürlich von dem bekannten Vorführeffekt sprechen. Schön und gut. Aber wie kann man so eine Situation vermeiden?<br>\nRichtig! Testen Testen Testen. :-)</p>\n<p>Mir hätte ein Unit-Testing an der Stelle nicht geholfen. Die Komponenten funktionierten geschlossen in sich perfekt. Allerdings das Zusammenspiel krachte. Ich brauche End2End Tests. Als alter Webentwickler habe ich natürlich an Selenium gedacht. Jedoch habe ich ein Google-Framework vor mir. Es wäre gelacht, wenn die nicht etwas in diese Richtung gebaut hätten. <a href=\"https://flutter.dev/docs/cookbook/testing/integration/introduction\">Siehe da, das haben sie getan.</a>. Es gibt dazu eine <a href=\"https://flutter.dev/docs/testing/integration-tests\">zweite Doku</a>, die sich etwas unterscheidet. Da es aber verschiedene Versionen gibt und die Dokumentation für mich etwas verwirrend war, beschreibe ich in diesem Artikel wie ich ans Ziel gekommen bin.</p>\n<h4 id=\"ausgangslage\" tabindex=\"-1\">Ausgangslage <a class=\"direct-link\" href=\"#ausgangslage\">#</a></h4>\n<p>Mein aktuelles Setup sieht so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">~</span> flutter <span class=\"token operator\">--</span>version</span><br><span class=\"highlight-line\">Flutter <span class=\"token number\">2.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">12.0</span><span class=\"token punctuation\">.</span>pre<span class=\"token punctuation\">.</span><span class=\"token number\">59</span> • channel master •</span><br><span class=\"highlight-line\">https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>flutter<span class=\"token operator\">/</span>flutter<span class=\"token punctuation\">.</span>git</span><br><span class=\"highlight-line\">Framework • revision <span class=\"token number\">64161</span><span class=\"token function\">b6caa</span> <span class=\"token punctuation\">(</span>vor <span class=\"token number\">9</span> Tagen<span class=\"token punctuation\">)</span> • <span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">09</span><span class=\"token operator\">-</span><span class=\"token number\">22</span> <span class=\"token number\">18</span><span class=\"token operator\">:</span><span class=\"token number\">38</span><span class=\"token operator\">:</span><span class=\"token number\">04</span> <span class=\"token operator\">-</span><span class=\"token number\">0400</span></span><br><span class=\"highlight-line\">Engine • revision dd28b6f1c8</span><br><span class=\"highlight-line\">Tools • Dart <span class=\"token number\">2.15</span><span class=\"token number\">.0</span> <span class=\"token punctuation\">(</span>build <span class=\"token number\">2.15</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">137.0</span><span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">)</span></span></code></pre>\n<h4 id=\"installation\" tabindex=\"-1\">Installation <a class=\"direct-link\" href=\"#installation\">#</a></h4>\n<p>Vorab die Info, dass man zwar noch auf den <em>flutter_driver</em> setzt. Dieser aber nicht mehr aus dem Paket heraus referenziert wird. Dazu schreibe ich gleich noch etwas.</p>\n<p>Man benötigt folgende Dependencies/Paketabhängigkeiten, die man in die <em>pubspec.yaml</em> schreibt als <em>dev-dependencies</em>:</p>\n<pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"highlight-line\"><span class=\"token key atrule\">dev_dependencies</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">integration_test</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">        <span class=\"token key atrule\">sdk</span><span class=\"token punctuation\">:</span> flutter</span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">flutter_test</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">        <span class=\"token key atrule\">sdk</span><span class=\"token punctuation\">:</span> flutter</span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">flutter_driver</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">        <span class=\"token key atrule\">sdk</span><span class=\"token punctuation\">:</span> flutter</span></code></pre>\n<p>Je nach IDE werden diese automatisch nachgeladen. Händisch geht dies im Projektverzeichnis so:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">flutter pub get</span></code></pre>\n<h4 id=\"ordner--und-dateistruktur\" tabindex=\"-1\">Ordner- und Dateistruktur <a class=\"direct-link\" href=\"#ordner--und-dateistruktur\">#</a></h4>\n<p>Es werden folgende Ordner benötigt:</p>\n<ul>\n<li>/integration_test</li>\n<li>/test</li>\n<li>/test_driver</li>\n</ul>\n<p>Der erste Ordner beinhaltet die Integration-/E2E-Tests. Im zweiten Ordner befinden sich die Unit-Tests ( spielt in diesem Artikel keine Rolle -&gt; aber ich hoffe sie sind da :-) ). Der dritte Ordner beinhaltet ein bisschen Konfiguration, bzw. Setup für die Integrationstests.</p>\n<p>Der Ordner <em>test_driver</em> beinhaltet die Datei <strong>test-driver.dart</strong> und hat diesen Inhalt:</p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token string\">'package:integration_test/integration_test_driver.dart'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token function\">integrationDriver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<h4 id=\"testfall\" tabindex=\"-1\">Testfall <a class=\"direct-link\" href=\"#testfall\">#</a></h4>\n<p>Im Ordner /integration<em>test liegen die Testfälle. Als Konvention hat man sich auf das Suffix (die Endung) test.dart geeinigt. Hier würde ich empfehlen noch ein &quot;unit</em>&quot; oder &quot;integration_&quot; davor hängen. Als Dateinamen ergibt sich <strong>happy-path_integration_test.dart</strong>. Die Syntax orientiert sich an bekannten BDD-Frameworks, wie z.B. <a href=\"https://jestjs.io/\">Jest</a>.</p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token string\">'package:flutter/material.dart'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token string\">'package:flutter_test/flutter_test.dart'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token string\">'package:integration_test/integration_test.dart'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"package:myApp/main.dart\"</span> <span class=\"token operator\">as</span> app<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token class-name\">IntegrationTestWidgetsFlutterBinding</span><span class=\"token punctuation\">.</span><span class=\"token function\">ensureInitialized</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Example'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">testWidgets</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should add new contact'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">WidgetTester</span> tester<span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      app<span class=\"token punctuation\">.</span><span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">pumpAndSettle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">final</span> <span class=\"token class-name\">Finder</span> addButton <span class=\"token operator\">=</span> find<span class=\"token punctuation\">.</span><span class=\"token function\">byKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Key</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"add_new\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">tap</span><span class=\"token punctuation\">(</span>addButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">pumpAndSettle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">final</span> <span class=\"token class-name\">Finder</span> inputField <span class=\"token operator\">=</span> find<span class=\"token punctuation\">.</span><span class=\"token function\">byKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Key</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">enterText</span><span class=\"token punctuation\">(</span>inputField<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ExampleName\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">pumpAndSettle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">final</span> <span class=\"token class-name\">Finder</span> saveButton <span class=\"token operator\">=</span> find<span class=\"token punctuation\">.</span><span class=\"token function\">byKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Key</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"save_button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">tap</span><span class=\"token punctuation\">(</span>saveButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">await</span> tester<span class=\"token punctuation\">.</span><span class=\"token function\">pumpAndSettle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>find<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ExampleName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> findsOneWidget<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Die erste Zeile importiert das Hauptpaket, weil ich auf Widgets zugreifen möchte. Die nächsten zwei Zeilen importieren die Testbibliotheken.<br>\nDie erste individuelle Zeile ist die fünfte Zeile. Hier wird die <em>main.dart</em>-Datei der zu testenden Applikation importiert.</p>\n<p>Man findet sich sehr schnell zurecht. Die Testfälle sind in der Main-Funktion gekapselt.</p>\n<p>Das <em>IntegrationTestWidgetsFlutterBinding</em> kümmert sich laut der Doku darum, dass die Testergebnisse eingesammelt werden. Die Methode <em>ensureInitialized</em> initialisiert dies.</p>\n<p>Analog zum Modell <em>describe</em> und <em>test/it</em> kommt hier <em>group</em> und <em>testWidgets</em> daher. Group gibt den Tests einen Rahmen, in dem die Testfälle unter gebündelt werden. Man findet sich auch hier schnell zurecht.</p>\n<p>Wer andere Frameworks kennt, kennt das Vorgehen.</p>\n<ul>\n<li>Initialisiere den Test</li>\n<li>Finde eine/n Knoten/Komponente.</li>\n<li>Führe darauf eine (Steuerungs-)Aktion aus.</li>\n<li>Erwarte eine Änderung der Oberfläche</li>\n</ul>\n<p>Nach genau diesem Schema läuft der Test auch ab.</p>\n<p>In Zeile 13 startet man die App. Man hat das Objekt <a href=\"https://api.flutter.dev/flutter/flutter_test/WidgetTester-class.html\"><em>WidgetTester tester</em></a> zur Verfügung. In anderen Frameworks ist dies häufig der <em>driver</em> oder die <em>page</em>. Dabei handelt es sich um das Interface für die Oberfläche. Mit anderen Worten die Schnittstelle oder Steuerung des Browsers oder in diesem Fall des Smartphones.</p>\n<p>Zum Finden der Komponente gibt es das globale Objekt vom Typ <a href=\"https://api.flutter.dev/flutter/flutter_test/CommonFinders-class.html\">CommonFinders</a>. Über das globale <em>find</em> kann man z.B. die Methoden <em>byKey</em>, <em>byTooltip</em> oder <em>byWidget</em> aufrufen. Diese suchen dann in der App nach einem bestimmten Key, Tooltip oder nach einem spezifischen Widget und geben eine Instanz der Klasse <em>Finder</em> zurück.<br>\nIch hab meinen Widgets eindeutige <a href=\"https://api.flutter.dev/flutter/foundation/Key-class.html\">Keys</a> gegeben, und kann so einfach danach suchen. Wenn ein Widget gefunden wird, übergibt man dieses als Parameter an eine Interaktionsmethode des <em>testers</em>.<br>\nDieser verfügt über Operationen wie z.B. <em>.enterText(finder, text)</em>, <em>.tap(finder)</em>, <em>showKeyboard(finder)</em>. Ich empfehle den Blick in die <a href=\"https://api.flutter.dev/flutter/flutter_test/WidgetTester-class.html\">Doku</a>.</p>\n<p>Der aufmerksamer Leser wird sich über das vermehrte Aufrufen der Funktion <em>pumpAndSettle</em> wundern. In früheren Versionen stand dort noch ein <em>driver.wait</em>. Diese Funktion wartet eigenständig bis alle Operationen, bzw. sich veränderten Frames auf der Oberfläche zum Stillstand gekommen sind. Das brauchen, um die jeweils nächste Operation zu starten (damit sich keine Operation in die Quere kommt) und um das Endresultat abzufragen.</p>\n<p>Das letzte Vorgehe im Test ist auch etwas kniffelig. Was erwartet man nun und wie prüft man es. In meinem kleinen Codebeispiel teste ich ein Inputfeld. Ein Knopf öffnet die Editierseite (Zeile 15), füllt das Formular aus (Zeile 21), speichert (Zeile 26) und kehrt damit zur Listenansicht zurück. Ich suche dann global nach dem neuen Text, den ich ersetzt habe (Zeile 30). Hier wäre es natürlich möglich über die oben genannten Keys oder Tooltips zu suchen.</p>\n<p>Damit wäre der erste einfach Test geschrieben. Wie ruft man diesen nun auf?</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">flutter drive</span><br><span class=\"highlight-line\">  --driver<span class=\"token operator\">=</span>test_driver/integration_test.dart</span><br><span class=\"highlight-line\">  --target<span class=\"token operator\">=</span>integration_test/happy-path_integration_test.dart</span><br><span class=\"highlight-line\">  -d emulator-5554</span></code></pre>\n<p>Der Befehl zum Auführen lautet <strong>flutter drive</strong> und bekommt noch einige Parameter mitgegeben. Der erste Parameter gibt den Pfad zum Driver an. Dieser befindet sich im oben genannten Ordner. Der Inhalt wurde bereits behandelt. Der zweite Parameter gibt das Target an. Ich finde es etwas unglücklich ausgedrückt. Es handelt sich hierbei um den Testfall, den man starten möchte. Ich habe nach Möglichkeiten gesucht alle Testfälle zu starten. Aber da muss man sich selber helfen und ein eigenes Bash-Skript schreiben. Der letzte Parameter gibt den Ausführungsort an. Hierbei handelt es sich um ein Device, das man unter Flutter einsehen kann.</p>\n<p>Führt man diesen Befehl aus, bekommt man eine Übersicht über die mit Flutter verbundenen &quot;Testgeräte&quot;.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">flutter devices</span><br><span class=\"highlight-line\"><span class=\"token number\">2</span> connected devices:</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">Android SDK built <span class=\"token keyword\">for</span> x86 <span class=\"token punctuation\">(</span>mobile<span class=\"token punctuation\">)</span> • emulator-5554 • android-x86    • Android <span class=\"token number\">10</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">(</span>API <span class=\"token number\">29</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>emulator<span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">Chrome <span class=\"token punctuation\">(</span>web<span class=\"token punctuation\">)</span>                       • chrome        • web-javascript • Google</span><br><span class=\"highlight-line\">Chrome <span class=\"token number\">94.0</span>.4606.71</span></code></pre>\n<p>Das erste Wort nach dem weißen Punkt ist der Devicename. Diesen gibt man als letzten Parameter im Befehl ein: <em>-d emulator-5554</em>. Hierbei handelt es sich um den Android-Emulator aus dem Android-Studio. Im Codebeispiel sieht man noch den Browser Chrome. Auch dieser könnte theoretisch genutzt werden, wenn man eine Flutter-Webanwendung gebaut hätte. Wäre eine physisches Telefon per USB verbunden, würde dieses hier auch auftauchen.</p>\n<p>Führt man diesen Befehl aus, dauert es eine gute Weile. Alles wird kompiliert, die App auf dem Emulator installiert. Man sieht die Klickfolge. Der nachfolgende Text sollte den Test krönen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">I/flutter <span class=\"token punctuation\">(</span> <span class=\"token number\">8223</span><span class=\"token punctuation\">)</span>: 00:03 +2: All tests passed<span class=\"token operator\">!</span></span><br><span class=\"highlight-line\">All tests passed.</span></code></pre>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>Dieser Artikel ist nur der Einstieg in das Testing. Er zeigt die Installation, beschreibt die Ordnerstrukturen und führt einen ersten Test aus. Damit hat man das Handwerkszeug ( und die richtigen Links zur Dokumentation), um weitere Tests zu schreiben und eine hohe Testabdeckung zu erreichen. Ich wünsche viel Spass beim Testen.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-10-01T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/stencil-tutorial/",
      "url": "https://derkuba.de/content/posts/stenciljs/stencil-tutorial/",
      "title": "StencilJS-Tutorial",
      "content_html": "<p>Eine Übersicht über meine StencilJS-Reihe<!-- endOfPreview -->. Sie umfasst folgende Artikel:</p>\n<h4 id=\"einf%C3%BChrung-und-tools\" tabindex=\"-1\">Einführung und Tools <a class=\"direct-link\" href=\"#einf%C3%BChrung-und-tools\">#</a></h4>\n<ul>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/introduction/\">Einführung in Stencil und Motivation</a></li>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/projekt-aufsetzen/\">Wie setze ich das Projekt auf?</a></li>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/entwicklerwerkzeuge/\">Welche Werkzeuge brauche ich?</a></li>\n</ul>\n<h4 id=\"komponenten\" tabindex=\"-1\">Komponenten <a class=\"direct-link\" href=\"#komponenten\">#</a></h4>\n<ul>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/erste-stencil-komponente/\">Wie erstelle ich StencilJS-Komponente?</a></li>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/tabellen-komponente/\">Wie baue ich eine Tabellenkomponente?</a></li>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/functional-component/\">Was ist eine functional component?</a></li>\n</ul>\n<h4 id=\"app-bestandteile\" tabindex=\"-1\">App-Bestandteile <a class=\"direct-link\" href=\"#app-bestandteile\">#</a></h4>\n<ul>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/routing/\">Wie funktioniert das Routing?</a></li>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/stores/\">Wie speichere ich Daten und was ist der Store?</a></li>\n</ul>\n<h4 id=\"zusammensetzung-der-app\" tabindex=\"-1\">Zusammensetzung der App <a class=\"direct-link\" href=\"#zusammensetzung-der-app\">#</a></h4>\n<ul>\n<li><a href=\"https://derkuba.de/content/posts/stenciljs/address-app/\">Wohin mit all dem neuen Wissen? Die Adressenapp</a></li>\n</ul>\n<h4 id=\"testing\" tabindex=\"-1\">Testing <a class=\"direct-link\" href=\"#testing\">#</a></h4>\n<ul>\n<li>\n<p><a href=\"https://derkuba.de/content/posts/stenciljs/jest-intro/\">Wie teste ich mit Javascript?</a></p>\n</li>\n<li>\n<p><a href=\"https://derkuba.de/content/posts/stenciljs/adress-app-tests/\">Wie teste ich die Adressanwendung?</a></p>\n</li>\n<li>\n<p><a href=\"https://derkuba.de/content/posts/stenciljs/adress-app-tests-part-ii/\">Wie teste ich mit Jest?</a></p>\n</li>\n<li>\n<p><a href=\"https://derkuba.de/content/posts/stenciljs/adress-app-tests-part-iii/\">Was kann Jest noch?</a></p>\n</li>\n<li>\n<p><a href=\"https://derkuba.de/content/posts/stenciljs/address-app-e2e/\">Was sind End to End Tests? Was ist Playwright?</a></p>\n</li>\n<li>\n<p><a href=\"https://derkuba.de/content/posts/stenciljs/address-app-e2e-part-ii/\">Wie schreibe ich E2E Tests mit Playwright?</a></p>\n</li>\n</ul>\n<h4 id=\"artikel-in-planung\" tabindex=\"-1\">Artikel in Planung <a class=\"direct-link\" href=\"#artikel-in-planung\">#</a></h4>\n<ul>\n<li>Backend for Frontend?</li>\n<li>Wie funktionier die Feldvalidierung?</li>\n<li>... ich bin für Vorschläge offen?</li>\n</ul>\n",
      "date_published": "2021-09-18T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/address-app-e2e-part-ii/",
      "url": "https://derkuba.de/content/posts/stenciljs/address-app-e2e-part-ii/",
      "title": "StencilJS-Tutorial: E2E Tests mit Playwright - Tests",
      "content_html": "<p>Mit dem Wissen des letzten Artikels können wir uns dem eigentlichen Thema widmen: Tests schreiben. Das Framework ist installiert, der erste Test steht und nach dem Ausführen laufen die Browser los und testen die Anwendung.<!-- endOfPreview --></p>\n<h4 id=\"page-object-model\" tabindex=\"-1\">Page Object Model <a class=\"direct-link\" href=\"#page-object-model\">#</a></h4>\n<p>Meine ersten Erfahrungen mit Playwright waren sehr positiv. Aber die Teststruktur war einfach nur chaotisch. Es gab eine Datei mit Selektoren, eine Datei mit Operationen und die Testdateien, die sich diese importieren und verwenden. Man konnte nicht nachvollziehen welcher Selektor zu welcher Seite gehört und wie es mit den Operationen oder Aktionen auf der Seite zusammenspielt. Hier bietet die <a href=\"https://playwright.dev/docs/test-pom\">Playwright Dokumentation das Page Object Model</a> (kurz POM) an. Die Idee dahinter ist so einfach wie genial. Man teilt die Anwendung in Seiten oder Module ein und erstellt für jedes Teil eine Klasse. In dieser Klasse befinden sich dann die dazugehörigen Selektoren und Operationen. Ohne konkretes Wissen über den strukturellen Aufbau kann man damit die Seite programmatisch bedienen. Nehmen wir als Beispiel die Formularseite zum Anlegen eines Kontaktes. Es besteht aus 3 Feldern (Vorname, Name, Adresse), einem Zurückknopf und einem Speicherknopf. Das dazugehörige POM sieht dann in Pseudocode so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Kontaktformular</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> zurückSelektor <span class=\"token operator\">=</span> <span class=\"token string\">\"link zurück\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> speicherKnopf <span class=\"token operator\">=</span> <span class=\"token string\">\"knopf speichern\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> vornameSelektor <span class=\"token operator\">=</span> <span class=\"token string\">\"eingabefeld vorname\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> nachnameSelektor <span class=\"token operator\">=</span> <span class=\"token string\">\"eingabefeld name\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> adressSelektor <span class=\"token operator\">=</span> <span class=\"token string\">\"eingabeFeld adresse\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">klickeZurück</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> playwright<span class=\"token punctuation\">.</span><span class=\"token function\">klickMagie</span><span class=\"token punctuation\">(</span>zurückSelektor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">klickeSpeichern</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> playwright<span class=\"token punctuation\">.</span><span class=\"token function\">klickMagie</span><span class=\"token punctuation\">(</span>speicherKnopf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">fülleVornameFeldAus</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>vorname<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span></span><br><span class=\"highlight-line\">        playwright<span class=\"token punctuation\">.</span><span class=\"token function\">füllMagie</span><span class=\"token punctuation\">(</span>vornameSelektor<span class=\"token punctuation\">,</span> vorname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span><span class=\"token punctuation\">.</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Man erkennt die Klassenstruktur. Die Klassen haben die Selektoren als private Attribute. Die Interaktionsmöglichkeiten der Seite sind in den Methoden abgebildet und benutzen die gekapselten Selektoren. Ohne die Seite gesehen zu haben kann ich, sobald ich eine Instanz dieser Klasse angelegt habe, die Seite bedienen ohne mir die Struktur anzuschauen. Ich finde mich ohne langes Suchen sofort zurecht. Das ist ein entscheidender Vorteil gegenüber meinem ersten Vorgehen.</p>\n<p>Da die Adressbuchapplikation zwei Seiten besitzt habe ich mich für zwei POMs entschieden. Eine für die <em>Kuba-Home</em> und eine für die <em>Kuba-Address-Form</em>. Die Selektoren und Operationen entsprechen den Interaktionsmöglichkeiten auf der Seite.</p>\n<p><strong>Kuba-Home</strong><br>\nDie Home besteht aus einem Link um einen neuen Kontakt anzulegen und aus der Tabelle aller Kontakte. In jeder Zeile, sofern Kontakt vorhanden, hat man die Möglichkeit die Zeile zu bearbeiten oder zu löschen.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Page <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"playwright\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaHomePom</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> page<span class=\"token operator\">:</span> Page<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>page<span class=\"token operator\">:</span> Page<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page <span class=\"token operator\">=</span> page<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> newButtonSelector <span class=\"token operator\">=</span> <span class=\"token string\">\"app-root >> #addressbook_new_contact >> a\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> tableSelector <span class=\"token operator\">=</span> <span class=\"token string\">\"app-root >> kuba-table-options >> table tbody tr\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">openNewContactForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>newButtonSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">editContact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tableSelector<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> a</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">deleteContact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tableSelector<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> button</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">getTableLocator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">locator</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tableSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> KubaHomePom<span class=\"token punctuation\">;</span></span></code></pre>\n<p>Es handelt sich um eine normale Javascript-Klasse. Das einzige framework-spezifische aus Playwright ist das Attribut page vom Typ Page, welches über den Konstruktor gesetzt wird. Damit habe ich operationellen Zugriff auf den Browser. Die Zeilen 10 und 11 zeigen die Selektoren für den Link und die Tabelle. Es handelt sich um einfache Strings, die eine leicht abgewandelte CSS-Selektor-Syntax verwenden. Dazu empfehle ich <a href=\"https://playwright.dev/docs/selectors\">die Dokumentation zu lesen</a>. Man findet sich schnell zurecht. Als Operationen auf der Seite gibt es den Klick auf den &quot;Neuer Kontakt&quot;-Link, den Klick auf &quot;Editieren&quot; und &quot;Löschen&quot;, sowie das Auslesen der Tabelle.</p>\n<p><strong>Kuba-Form</strong><br>\nDen Aufbau der Seite habe ich oben beschrieben. Sie besteht aus einem Link, drei Eingabefeldern und einem Speicherknopf.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Page <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"playwright\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaFormPom</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> page<span class=\"token operator\">:</span> Page<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>page<span class=\"token operator\">:</span> Page<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page <span class=\"token operator\">=</span> page<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> <span class=\"token constant\">APP_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"app-root\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> backButtonSelector <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APP_NAME</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> >> #backLink >> a</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> firstNameInputSelector <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APP_NAME</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> >> #first-name</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> lastNameInputSelector <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APP_NAME</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> >> #last-name</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> addressInputSelector <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APP_NAME</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> >> #street</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> saveButtonSelector <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APP_NAME</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> >> #saveContactButton</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">goBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>backButtonSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">clickSaveButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>saveButtonSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">fillFirstNameInput</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameInputSelector<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">fillLastNameInput</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameInputSelector<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">async</span> <span class=\"token function\">fillAddressInput</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressInputSelector<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> KubaFormPom<span class=\"token punctuation\">;</span></span></code></pre>\n<p>In der bekannten Klassenstruktur finden wir die Selektoren für die genannten Felder (Zeile 12-16). Auffällig ist der Appname. Ich nehme diesen immer als ersten Knoten, um dann im Shadowdom zu suchen. Sollte sich dieser ändern ist dies leichter in einer Konstante zu bewerkstelligen. Die Pfeile &quot;&gt;&gt;&quot; sind ein Selektor, der die Klassen oder IDs innerhalb des Shadowdoms sucht. Wir dürfen nicht vergessen, dass die Komponenten aus geschützen Web-Components bestehen. Die Operationen sind das Klicken und füllen der Werte.</p>\n<h4 id=\"playwright-interaktionen\" tabindex=\"-1\">Playwright Interaktionen <a class=\"direct-link\" href=\"#playwright-interaktionen\">#</a></h4>\n<p>Über das übergebene page-Objekt haben wir Zugriff auf Browseroperationen. Hier liste ich die verwendeten nochmal auf und erläutere sie.<br>\nAuch hier empfehle ich die <a href=\"https://playwright.dev/docs/input\">Dokumentation zu lesen</a>.</p>\n<table>\n<thead>\n<tr>\n<th>Operation</th>\n<th style=\"text-align:right\">Playwright</th>\n<th style=\"text-align:right\">Funktion</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Klicken</td>\n<td style=\"text-align:right\">page.click(selector);</td>\n<td style=\"text-align:right\">Als Parameter wird ein Selector erwartet. Dieser wird, sofern er gefunden wird, geklickt</td>\n</tr>\n<tr>\n<td>Ausfüllen von Formularfeldern</td>\n<td style=\"text-align:right\">page.fill(selector, value);</td>\n<td style=\"text-align:right\">Als Parameter wird der Selektor und der zu schreibende Wert erwartet.</td>\n</tr>\n</tbody>\n</table>\n<p>Diesen Operationen kann auch noch ein Konfigurationsparameter als letzten Parameter übergeben werden. Dort kann man zum Beispiel mitgeben wie lange man auf das Selektieren warten soll:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>saveButtonSelector<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> timeout<span class=\"token operator\">:</span> <span class=\"token number\">3000</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wenn dies nicht definiert wird, gilt der globale Timeout. Man kann einen Timeout für den einzelnen Test oder für die gesamte Teststrecke in der Konfigurationsdatei definieren:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> config<span class=\"token operator\">:</span> PlaywrightTestConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    globalTimeout<span class=\"token operator\">:</span> <span class=\"token number\">60000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 60sekunden für alle Tests</span></span><br><span class=\"highlight-line\">    timeout<span class=\"token operator\">:</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 5 Sekunden pro Test</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<h4 id=\"matcher-add-on\" tabindex=\"-1\">Matcher Add-on <a class=\"direct-link\" href=\"#matcher-add-on\">#</a></h4>\n<p><a href=\"https://playwright.dev/docs/test-assertions/\">Playwright bietet einige Matcher/Assertions</a> ( .toContainText() ) an. Ich ergänze diese in meinen Projekten noch um das npm-Paket <a href=\"https://github.com/playwright-community/expect-playwright\"><em>expect-playwright</em></a>. Es ergänzt die Matcher noch um die Funktionen:</p>\n<ul>\n<li>toBeChecked</li>\n<li>toBeDisabled</li>\n<li>toBeEnabled</li>\n<li>toHaveFocus</li>\n<li>toHaveSelector</li>\n<li>toHaveSelectorCount</li>\n<li>toMatchAttribute</li>\n<li>toMatchComputedStyle</li>\n<li>toMatchText</li>\n<li>toMatchTitle</li>\n<li>toMatchURL</li>\n<li>toMatchValue</li>\n</ul>\n<p>Um diese zu installieren muss man folgendes tun:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">npm install expect<span class=\"token operator\">-</span>playwright</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// playwright.config.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> matchers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"expect-playwright\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">expect<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>matchers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Und schon haben wir Zugriff auf diese erweiterte Funktionalität.</p>\n<h4 id=\"lucky-path-test\" tabindex=\"-1\">Lucky Path Test <a class=\"direct-link\" href=\"#lucky-path-test\">#</a></h4>\n<p>Der glückliche Pfad ist die Klickfolge in der Anwendung, die zum erfolgreichen Abschluss führt. Dieser kann das Anlegen eines Kontaktes sein, das vollständige Ausfüllen eines Formulars oder was auch immer der Zweck der Applikation ist. Sonderfälle und Edge-Cases werden ignoriert. Diese müssen extra behandelt werden.</p>\n<p>** Test initialisierung**</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">test<span class=\"token punctuation\">.</span><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Lucky Path Test\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">let</span> kubaHomePom<span class=\"token punctuation\">,</span> kubaFormPom<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  test<span class=\"token punctuation\">.</span><span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">goto</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TEST_URL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    kubaHomePom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaHomePom</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    kubaFormPom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaFormPom</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  test<span class=\"token punctuation\">.</span><span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">reload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Das Test-Setup habe ich so aufgebaut, dass die beiden POMs außerhalb der Tests instanziiert werden. Jeweils vor jedem Test. Es würde auch reichen die POMs im Dateikopf zu instanziieren.<br>\nZusätzlich steuern wir den Browser vor jeden Test auf die Seite der Applikation und nach jedem Test lade ich die Seite neu, damit alle Daten verschwinden.</p>\n<p>Die Adressbuch Applikation hat nur drei grundlegende Funktionen:</p>\n<ul>\n<li>Kontakt anlegen</li>\n<li>Kontakt löschen</li>\n<li>Kontakt editieren</li>\n</ul>\n<p>Genau dies sind unsere Tests.</p>\n<p><strong>Kontakt anlegen</strong></p>\n<p>Da man für alle diese Fälle einen Kontakt erst einmal anlegen muss, habe ich dies in eine Funktion ausgelagert, um Redundanz einzusparen.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addNewContact</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>kubaHomePom<span class=\"token punctuation\">,</span> kubaFormPom<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaHomePom<span class=\"token punctuation\">.</span><span class=\"token function\">openNewContactForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">fillFirstNameInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">fillLastNameInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">fillAddressInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Musterstraße 23, 1234 Musterstadt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">clickSaveButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">goBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die Funktion bekommt die zwei POMs übergeben. Zeile 2 öffnet die <em>Kontakt anlegen</em>-Seite. In den Zeilen 4-6 werden die Inputfelder beschrieben. Zeile 7 zeigt wie der Speicherknopf betätigt wird und Zeile 8 führt uns zur Startseite mit der Tabelle. Man könnte noch die Eingabewerte auslagern und von außen reingeben. Aber für die Demonstration reicht es so aus.</p>\n<p>Der erste Test sieht dann so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should add new contact\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token function\">addNewContact</span><span class=\"token punctuation\">(</span>kubaHomePom<span class=\"token punctuation\">,</span> kubaFormPom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> tableLocator <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> kubaHomePom<span class=\"token punctuation\">.</span><span class=\"token function\">getTableLocator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>tableLocator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveCount</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Zeile 2 verwendet die ausgelagerte Funktion. Nach dem Ausführen zähle ich die Tabellenzeilen und erwarte eine neue Zeile. Fertig.</p>\n<p><strong>Kontakt löschen</strong></p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should delete contact\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token function\">addNewContact</span><span class=\"token punctuation\">(</span>kubaHomePom<span class=\"token punctuation\">,</span> kubaFormPom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaHomePom<span class=\"token punctuation\">.</span><span class=\"token function\">deleteContact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> tableLocator <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> kubaHomePom<span class=\"token punctuation\">.</span><span class=\"token function\">getTableLocator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>tableLocator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveCount</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Analog zu dem vorherigen Test wird ein Kontakt angelegt. Die <em>.deleteContact()</em> ist ein bisschen geschummelt. Sie sucht einfach nach dem ersten Button und drückt diesen. Danach wird durchgezählt und keine Zeile mehr in der Tabelle erwartet.</p>\n<p><strong>Kontakt editieren</strong></p>\n<p>Das ist der aufwendigste Test:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should add new contact and edit it\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token function\">addNewContact</span><span class=\"token punctuation\">(</span>kubaHomePom<span class=\"token punctuation\">,</span> kubaFormPom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaHomePom<span class=\"token punctuation\">.</span><span class=\"token function\">editContact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">fillFirstNameInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Heinrich\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">fillLastNameInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Neumuster\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">clickSaveButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> kubaFormPom<span class=\"token punctuation\">.</span><span class=\"token function\">goBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> tableLocator <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> kubaHomePom<span class=\"token punctuation\">.</span><span class=\"token function\">getTableLocator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>tableLocator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toContainText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HeinrichNeumuster\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Dieser Test ist aufwendiger, da erst ein Kontakt angelegt werden muss. Dann muss auf der Hauptseite der Editier-Knopf gedrückt werden, die Werte verändert, zurücknavigiert und dann die neuen Werte erwartet.<br>\nDie Implementierung der Tabelle macht den Vergleich etwas schwerer. Man hätte hier sauberer mit IDs arbeiten müssen. Ich mache mir es leicht und lese den Text der ersten Zeile konkateniert aus. Deswegen sieht mein Vergleichswert auf den ersten Blick merkwürdig aus. Fertig.</p>\n<h4 id=\"warum-sollte-man-das-tun%3F\" tabindex=\"-1\">Warum sollte man das tun? <a class=\"direct-link\" href=\"#warum-sollte-man-das-tun%3F\">#</a></h4>\n<p>Ja, es ist zusätzlicher Code. Ja, es kostet Zeit diesen zu schreiben. Aber es spart diese Zeit wieder ein. In vielen Firmen werden Anwendungen noch aufwendig von Hand getestet. Man stelle sich vor, jemand erstellt einen Testkatalog mit Testdaten und 100 Testfälle. Irgendwer muss sich dann hinsetzen und alle 100 Testfälle per Hand Stück für Stück, Zeile für Zeile, Feld für Feld durchtesten. Jeder Mensch macht auch Fehler. Testfälle werden übersprungen, weil man in der Zeile verrutscht. Die Ergebnisse werden vergessen mitzuteilen.<br>\nDiese Art Tests laufen in der Pipeline und können nach jeder Änderung automatisch durchlaufen werden. Man kann es so konfigurieren, dass nicht erfolgreiche Tests ein Deployment verhindern. Natürlich muss man nicht auf händische Tests verzichten, aber diese E2E-Tests ergänzen diese auf sehr wertvolle Art und Weise.</p>\n<p>Für mich sind diese Tests eine Pflicht in jedem Projekt.</p>\n<p>Dieses Tutorial soll den Einstieg ermöglichen. Es ist keine Musterlösung, sondern bietet den Einstieg in die Materie.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-09-17T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/address-app-e2e/",
      "url": "https://derkuba.de/content/posts/stenciljs/address-app-e2e/",
      "title": "StencilJS-Tutorial: E2E Tests mit Playwright - Intro",
      "content_html": "<p>Mit den End2End-Tests sollte, meiner Meinung nach, sofort begonnen werden, sobald man die erste Seite gebaut hat. Wie der Name schon sagt wird das Zusammenspiel der Komponenten und die Anbindung an Schnittstellen getestet.<!-- endOfPreview --> Dabei geht man davon aus, dass man die Implementierung nicht kennt. Für alle die mit dem Begriff nichts anfangen können, erkläre ich es: Man steuert die Anwendung über den Browser (programmatisch) und zwar genau so wie ein Nutzer sie bedienen würde. Dazu nutzt man verschiedenen Frameworks, die Schnittstellen zum Browser bereitstellen. Das bekannteste Framework hiefür ist <a href=\"https://www.selenium.dev/\">Selenium</a>. Die Programmiersprache ist mittlerweile egal. Es gibt für alle großen Sprachen eine Implementierung. Mein Gedanke beim Thema Full-Stack-Entwickler ist, dass ich gerne alle Bereiche (Frontend, Backend, QA) in derselben Sprache schreiben möchte. Was gibt es hierzu im Bereich Javascript/Typescript. In den letzten Jahren hat sich da wirklich viel getan. Die Browserhersteller haben eingesehen, dass es einen Bedarf an Headless-Browsern ( Browser ohne Benutzeroberfläche ) gibt. PhantomJS hat sehr viel dazu beigetragen (Möge es in Frieden ruhen :-) ). Ich habe mit eine zeit lang mit <a href=\"https://github.com/puppeteer/puppeteer#readme\">Puppeteer</a> gearbeitet. Microsoft hat sich wohl an einigen Entwickler davon bedient und seine Variante davon entwickelt: [Playwright] (<a href=\"https://playwright.dev/\">https://playwright.dev/</a>). Ich benutze gerne Software, die von großen Unternehmen betrieben wird, da sie genug Ressourcen aufbringen können, um es weiterzuentwickeln.</p>\n<p>Playwright tut auch genau was es soll. Es hat eine einfach API, ist komplett mit Typescript kompatibel und einsteigerfreundlich. Ich zeige euch heute wie man es installiert und wie ein erster Test damit aussieht. Wie immer empfehle ich die <a href=\"https://playwright.dev/docs/intro\">hauseigene Dokumentation</a> zu durchstöbern.</p>\n<p>Genug Text, jetzt hauen wir in die Tasten.</p>\n<h4 id=\"installation\" tabindex=\"-1\">Installation <a class=\"direct-link\" href=\"#installation\">#</a></h4>\n<p>Laut Dokumentation reicht ein install-Befehl. Wir legen erstmal einen neuen Ordner an und initialisieren ein node-Projekt und bestätigen und durch den Node-Projekt-Wizard:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">mkdir</span> E2E</span><br><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> E2E</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> init</span></code></pre>\n<p>Im Anschluss installieren wir Playwright:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> i -D @playwright/test</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">// Browser installieren mit</span><br><span class=\"highlight-line\">npx playwright <span class=\"token function\">install</span></span></code></pre>\n<p>Jetzt müssten man über ein <em>package.json</em>-Skript oder direkt über npx starten können:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">// <span class=\"token keyword\">in</span> package.json ergänzen:</span><br><span class=\"highlight-line\"><span class=\"token string\">\"scripts\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"test:local\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"PWDEBUG=console playwright test\"</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run test:local</span><br><span class=\"highlight-line\">// oder</span><br><span class=\"highlight-line\">npx playwright <span class=\"token builtin class-name\">test</span></span></code></pre>\n<p>Bei mir auf der Konsole erschien direkt ein Fehler:<br>\n<strong>Error: Cannot find module 'playwright'</strong></p>\n<p>Dieser Fehler lässt sich einfach weginstallieren:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -D playwright</span></code></pre>\n<p>Jetzt sollte das Ausführen klappen und diese Meldung erscheinen:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span></span><br><span class=\"highlight-line\"> no tests found.</span><br><span class=\"highlight-line\"><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span></span></code></pre>\n<p>Als nächstes legen wir die Konfigurationsdatei an.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">touch</span> playwright.config.ts</span></code></pre>\n<p>Wer keine Befehle mag, kann es gerne in der IDE per &quot;neue Datei&quot; anlegen versuchen.</p>\n<p>Der Inhalt dieser Datei sieht bei mir so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// playwright.config.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> PlaywrightTestConfig<span class=\"token punctuation\">,</span> devices<span class=\"token punctuation\">,</span> expect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@playwright/test\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> config<span class=\"token operator\">:</span> PlaywrightTestConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    forbidOnly<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    retries<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    reporter<span class=\"token operator\">:</span> <span class=\"token string\">\"line\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    use<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// Browser options</span></span><br><span class=\"highlight-line\">        headless<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// Context options</span></span><br><span class=\"highlight-line\">        viewport<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token number\">1280</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">:</span> <span class=\"token number\">1920</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        ignoreHTTPSErrors<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// Artifacts</span></span><br><span class=\"highlight-line\">        screenshot<span class=\"token operator\">:</span> <span class=\"token string\">\"only-on-failure\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        video<span class=\"token operator\">:</span> <span class=\"token string\">\"retry-with-video\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    projects<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"Chrome Stable\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            use<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                browserName<span class=\"token operator\">:</span> <span class=\"token string\">\"chromium\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                <span class=\"token comment\">// Test against Chrome Stable channel.</span></span><br><span class=\"highlight-line\">                channel<span class=\"token operator\">:</span> <span class=\"token string\">\"chrome\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                launchOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                    slowMo<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"Desktop Safari\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            use<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                browserName<span class=\"token operator\">:</span> <span class=\"token string\">\"webkit\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                viewport<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">:</span> <span class=\"token number\">750</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// Test against mobile viewports.</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"Mobile Chrome\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            use<span class=\"token operator\">:</span> devices<span class=\"token punctuation\">[</span><span class=\"token string\">\"Pixel 5\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"Mobile Safari\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            use<span class=\"token operator\">:</span> devices<span class=\"token punctuation\">[</span><span class=\"token string\">\"iPhone 12\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            name<span class=\"token operator\">:</span> <span class=\"token string\">\"Desktop Firefox\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            use<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                browserName<span class=\"token operator\">:</span> <span class=\"token string\">\"firefox\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                viewport<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">:</span> <span class=\"token number\">600</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> config<span class=\"token punctuation\">;</span></span></code></pre>\n<p>Jeder sollte unbedingt in die <a href=\"https://playwright.dev/docs/test-configuration#global-configuration\">Doku</a> schauen. Dort sind die meisten Flags erklärt. Ich gehe aber auch auf meine Auswahl ein:</p>\n<ul>\n<li>forbidOnly: Schutz vor mir selbst, damit ich keine einzelnen Tests erzwinge.</li>\n<li>retries: 3: Das ist eine der Stärken. Failing Tests werden 3 mal wiederholt. Oft ist es einfach ein Timing-Problem</li>\n<li>use: Konfiguration, die für alle folgenden Browser gilt</li>\n<li>headless: Starte den Browser ohne Oberfläche</li>\n<li>viewport: Auflösung des Browsers</li>\n<li>ignoreHTTPSErrors: Lokal umgehe ich damit HTTPS und Zertifikatsprobleme</li>\n<li>screenshots: Fotografiere den Fehler</li>\n<li>video: Schneide den Retry mit</li>\n<li>projects: Ab hier werden die individuellen Browser eingestellt</li>\n<li>name: Mein Name für den Browser</li>\n<li>use: Überschreibt die obere Konfiguration</li>\n<li>browserName: Der wirkliche Name des Browsers</li>\n<li>channel: Installationsquelle</li>\n<li>launchOptions: Browserindividuelle Befhle</li>\n<li>slowMo: Der Browser lässt sich die einstellte Zeit in MS zwischen dem Ausführen der Befehle</li>\n<li>use: devices[&quot;Pixel 5&quot;]: Möglichkeit auch mobile Browser zu verwenden</li>\n</ul>\n<p>Welche Browser man unterstützt möchte ist sehr unterschiedlich. Es gibt kein Richtig oder Falsch. Das muss projektindividuell entschieden werden.</p>\n<p>Playwright sucht beim Start automatisch nach der Datei <strong>playwright.config.ts</strong>. Man kann die Datei benennen wie man möchte. Dies muss man Playwright aber über einen Kommandozeilenparameter mitteilen:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">npx playwright test <span class=\"token operator\">--</span>config<span class=\"token operator\">=</span>meine<span class=\"token punctuation\">.</span>neue<span class=\"token punctuation\">.</span>konfigurationsdatei<span class=\"token punctuation\">.</span>ts</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// oder in der package.json</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\">scripts<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"><span class=\"token string\">\"test:alternative\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"playwright test --config=meine.neue.konfigurationsdatei.ts\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span></code></pre>\n<h4 id=\"erster-test\" tabindex=\"-1\">Erster Test <a class=\"direct-link\" href=\"#erster-test\">#</a></h4>\n<p>Ich fasse zusammen. Es ist alles installiert und konfiguriert. Wir legen jetzt mit dem Testen los.</p>\n<p>Wir legen unter /src/specs eine Datei an. Das machen wir wir analog zu Jest. Die Testdateien enden auf <em>.spec.ts</em> und sehen vom Aufbau auch genauso aus.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> test<span class=\"token punctuation\">,</span> expect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@playwright/test\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// besser in einer env variable aufgehoben</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token constant\">TEST_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"http://localhost:3333\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">test<span class=\"token punctuation\">.</span><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Lucky Path Test\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    test<span class=\"token punctuation\">.</span><span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">goto</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TEST_URL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should check the first page\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> locator <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">locator</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"h1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>locator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toContainText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Kuba-Home\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Man findet sich schnell zurecht. Es ist das Describe-Skelett und das Test-Skelett vorhanden. Der Aufbau ist auch wieder derselbe. Man hat einen Initialisierungsteil, einen Zustandherbeiführungsteil und einen Erwartungsteil. Unterschied zu Jest ist, dass die Describe Methode aus dem &quot;test&quot;-Objekt kommt. Gleichermaßen ist es mit dem &quot;beforeEach&quot;. Die Tests bekommen als Parameter ein <em>page</em>-Objekt injiziert. Mit diesem haben wir Zugriff auf die Webseite.<br>\nWir müssen dem Test sagen, wohin er im Browser navigieren soll. Als Default wird auf einer leeren Webseite gestartet. Vor jedem Test soll er in unserer Applikation starten. Die URL ist hart kodiert. Dies sollte, wie der Kommentar sagt, in eine Environment-Variable ausgelagert werden, damit man die Applikation auf verschiedenen Umgebungen testen kann und diese Parameter von außen einlesen kann. Der eigentliche Test startet nun auf der Seite der Applikation.<br>\nIn Zeile 12 sehen wir einen <em>Locator</em>. Das ist ein HTML-Knoten, der selektiert wird über CSS-Selektoren. Für den ersten einfachen Test suche ich auf der Seite die Überschrift. Den Locator übergebe ich dem expect-Block und erwarte, dass <em>Kuba-Home</em> im Titel steht. Wenn wir nun den Test ausführen, passiert nichts außer, dass in der Konsole das hier erscheint:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">Using config at <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>jacob<span class=\"token operator\">/</span>stenciljs<span class=\"token operator\">-</span>tutorial<span class=\"token operator\">/</span><span class=\"token constant\">E2E</span><span class=\"token operator\">/</span>playwright<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>ts</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">Running <span class=\"token number\">1</span> test using <span class=\"token number\">1</span> worker</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token number\">1</span> <span class=\"token function\">passed</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span>s<span class=\"token punctuation\">)</span></span></code></pre>\n<p>Wollen wir etwas mehr Effekte, können wir den Debug-Modus anschmeißen:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token string\">\"test:local\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"PWDEBUG=console playwright test\"</span></span></code></pre>\n<p>Der Parameter <em>PWDEBUG=console</em> öffnet den Browser und man bekommt etwas mehr Output in der Konsole.</p>\n<p>Das war unser erster Test.</p>\n<h4 id=\"was-haben-wir-gelernt%3F\" tabindex=\"-1\">Was haben wir gelernt? <a class=\"direct-link\" href=\"#was-haben-wir-gelernt%3F\">#</a></h4>\n<ul>\n<li>Wie installiert man Playwright?</li>\n<li>Wie wird es Konfiguriert?</li>\n<li>Was sind die verschiedenen Parameter der Konfiguration?</li>\n<li>Wie verwende ich welche Browser?</li>\n<li>Wie sieht ein Test aus?</li>\n</ul>\n<h4 id=\"ausblick\" tabindex=\"-1\">Ausblick <a class=\"direct-link\" href=\"#ausblick\">#</a></h4>\n<p>Im nächsten Artikel testen wir die Adressbuch-Applikation über Playwright durch.</p>\n<p><br>\nDer Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-09-09T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/adress-app-tests-part-iii/",
      "url": "https://derkuba.de/content/posts/stenciljs/adress-app-tests-part-iii/",
      "title": "StencilJS-Tutorial: Real World Unit Tests Teil 3",
      "content_html": "<p>Im vorherigen Artikel haben wir gelernt wie man einzelne Funktionen wegmockt. In einer Komponente befinden sich häufig auch viele importierte Fremdbibliotheken. Ich verlasse mich immer drauf, dass diese getestet sind und möchte diese auch nicht in meinen Tests erneut testen.<br>\nIn diesem Artikel zeige ich wie man damit umgeht. <!-- endOfPreview -->Als kleinen Zusatz zeige ich noch auf, wie man mit Timeouts umgeht.</p>\n<h4 id=\"module-mocken\" tabindex=\"-1\">Module mocken <a class=\"direct-link\" href=\"#module-mocken\">#</a></h4>\n<p>Jest hat die Möglichkeit den gesamten Import wegzumocken und eine alternative Implementierung anzubieten. Anstatt einen vielleicht komplizierten Algorithmus auszuführen, entscheide ich selber wie die importe Funktion sich verhalten soll.</p>\n<p>Schauen wir uns mal ein Beispiel aus unserer Adressbuch-Applikation an. In der Komponente <em>kuba-address-form</em> benötigen wir beim Anlegen eines neuen Kontakts eine ID, um den Kontakt in den Daten zu identifizieren. Dafür habe ich mir eine Funktion ausgeliehen. Wie sie funktioniert interessiert mich nicht. Sie liefert eine UUID zurück und das reicht mir. Die Funktion liegt in einer eigenen Datei und wird in die Komponente importiert. Daneben liegt auch noch der Store, der auch importiert wird. Diesen möchten wir auch nicht direkt im Test verwenden.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> create_UUID <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./utils/create-uuid\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> addressStore <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../store/address-store\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onSubmit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> uuid <span class=\"token operator\">=</span> <span class=\"token function\">create_UUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">     addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        firstName<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        lastName<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        id<span class=\"token operator\">:</span> uuid<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        address<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span></code></pre>\n<p>Wir sehen hier dass eine Funktion <em>create_UUID</em> aus dem Pfad <em>/utils/create-uuid</em>. Es handelt sich um eine selbstgeschrieben Funktion, die auch eigenständig getestet wurde. Sie liefert bei jedem Aufruf eine neue ID zurück und das macht uns beim Test Probleme. Wir bekommen damit keine vergleichbare Daten mehr, da sich die ID nach jedem Aufruf erneuert.<br>\nWir greifen anschließend auf das Store-Objekt zu und beschreiben diese mit den eingegebenen Werten.</p>\n<p>Der Test ist so aufgebaut, dass immer zuerst die zu importierenden Module/Funktionen überschrieben werden müssen und erst DANACH wird die zu testende Komponente importiert. Wenn man das umdreht, bekommt die Komponente nicht mehr mit, dass die Importe gemockt wurden. Das ist ein sehr, sehr häufiger Fehlerfall.</p>\n<p>Jest bietet für das Überschreiben, bzw. <a href=\"https://jestjs.io/docs/mock-functions#mocking-partials\">Mocken von Modulen die jest.mock()-Funktion</a>. Ich gehe dabei immer so vor, dass ich das zu importierende Modul mocke und direkt eine Implementierung anbiete:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">jest<span class=\"token punctuation\">.</span><span class=\"token function\">mock</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../utils/create-uuid\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> originalModule <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">requireActual</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../utils/create-uuid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        __esModule<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span>originalModule<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token function-variable function\">create_UUID</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"uuid\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> addressStoreMock <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    contacts<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">jest<span class=\"token punctuation\">.</span><span class=\"token function\">mock</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../../store/address-store\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    __esModule<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> addressStoreMock<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die Zeilen 1-11 zeigen die genaue Syntax. Der erste Parameter von jest.mock ist der Pfad zum Import. Der zweite Parameter ist eine Funktion, die das Original-Modul lädt und im Return-Statement alle (nicht vorhandenen Funktionen) destrukturiert. Wir überschreiben hierbei die ( einzige ) Funktion des Moduls <em>create_UUID</em>. Der aufmerksame Leser wird bemerkt haben, dass die Zeile 2 und 5 keinen wirklichen Sinn macht und dass man sie auch weglassen kann. Das ist korrekt. Ich möchte hier zeigen, wie man nur bestimmte Teile des Moduls mockt. Die Funktion <em>create_UUID</em> wird überschrieben und liefert jetzt bei jedem Aufruf nur &quot;uuid&quot; zurück. Damit ist sichergestellt, dass die Daten vergleichbar sind.</p>\n<p>Die Zeilen 14-16 zeigen wie man einen Default-Import überschreibt. Die Zeilen davor sind für ein einfaches Modul-Export. Wir erzeugen ein einfaches Objekt, das eine Property contacts hat und übergeben es dem Default. Damit haben wir den Store überschrieben und haben durch die Variable <em>addressStoreMock</em> Zugriff auf den Store und können ihn für jeden Test anpassen. An der Stelle rufe ich zur Vorsicht auf. Das Store Objekt kann von jedem Test angefasst werden und man läuft schnell in eine Abhängigkeit der Reihenfolge der Tests. Ich empfehle den Store vor jedem Test zurückzusetzen:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-address-form\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        addressStoreMock<span class=\"token punctuation\">.</span>contacts <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Jetzt kann man einfach drauf lostesten. Der Test der ein Submit eines neuen Kontaktes testet, sieht dann so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should submit the form on new Contact\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> addressForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaAddressForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> <span class=\"token string\">\"HalloWeltWeg 23\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">onSubmit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>addressStoreMock<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            address<span class=\"token operator\">:</span> <span class=\"token string\">\"HalloWeltWeg 23\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            firstName<span class=\"token operator\">:</span> <span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            id<span class=\"token operator\">:</span> <span class=\"token string\">\"uuid\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            lastName<span class=\"token operator\">:</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Durch die geleistete Vorarbeit ist der Test ganz einfach. Zeile 12 zeigt, dass wir uns auf das von der Funktion <em>create_UUID</em> überschriebene &quot;uuid&quot; verlassen können. Der gemockte Store enthält nach Aufruf der Submit-Methode einen weiteren Eintrag mit den erwarteten werten. Als Matcher habe ich <em>.toEqual</em> verwendet, weil wir hier nicht auf die Gleichheit der Referenz, sondern des Inhalts überprüfen.</p>\n<h4 id=\"weitere-testf%C3%A4lle\" tabindex=\"-1\">Weitere Testfälle <a class=\"direct-link\" href=\"#weitere-testf%C3%A4lle\">#</a></h4>\n<p><strong>Kontakt editieren</strong></p>\n<p>Um in den Kontakt editieren Fall im Code zu gelangen, benötigt man eine ID in der URL. Doch wie bekommt man das im Test hin? Die Funktionalität kommt ja aus dem Framework Stencil-Router. Doch sie benutzt Stencil-Boardmittel. Die ID kommt aus dem Property <em>match</em> vom Typ Matchresult. Genau da setzen wir an:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should submit the form on Contact edit\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// init</span></span><br><span class=\"highlight-line\">    addressStoreMock<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        id<span class=\"token operator\">:</span> <span class=\"token string\">\"14\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        firstName<span class=\"token operator\">:</span> <span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        lastName<span class=\"token operator\">:</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        address<span class=\"token operator\">:</span> <span class=\"token string\">\"Musterstraße 44\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> addressForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaAddressForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// hier steht die Lösung</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>match <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span>addressForm<span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        params<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            id<span class=\"token operator\">:</span> <span class=\"token string\">\"14\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//////////////////////</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"Maximilian\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"Neumuster\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> <span class=\"token string\">\"Musterstraße 44\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">onSubmit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>addressStoreMock<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            address<span class=\"token operator\">:</span> <span class=\"token string\">\"Musterstraße 44\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            firstName<span class=\"token operator\">:</span> <span class=\"token string\">\"Maximilian\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            id<span class=\"token operator\">:</span> <span class=\"token string\">\"14\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            lastName<span class=\"token operator\">:</span> <span class=\"token string\">\"Neumuster\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wir instanziieren die <em>KubaAddressForm</em>. In Zeile 12-18 überschreiben wir mit Hilfe des Spread-Operators das Match-Objekt und geben dem Feld <em>params</em> noch das Feld <em>id</em>. Damit läuft die Implementierung in den <em>else</em>-Fall und wir können wie gewohnt Daten vergleichen.</p>\n<p><strong>Lifecycle-Methoden</strong></p>\n<p>Stenciljs hat einige Laufzeit-Methoden, mit denen man in das Rendering eingreifen kann. Ich verwende zum Laden der Daten aus dem Store anhand der übergebenen ID die Methode <em>connectedCallback</em>. Diese wird aufgerufen wenn die Komponente initialisiert oder wieder angehängt wird und vor dem Aufruf der Render-Methode. Damit bleibt genug Zeit die Daten zu laden und in den State zu schreiben. Weitere Laufzeitmethoden sind zum Beispiel <em>componentWillLoad</em>, <em>componentWillRender</em> oder <em>componentDidRender</em>. Wer sich für weitere interessiert wird <a href=\"https://stenciljs.com/docs/component-lifecycle\">in der Doku fündig.</a>.</p>\n<p>Doch wie bringe ich den Test dazu genau diese Methode auszuführen. Nach viel recherchieren und ausprobieren gehe ich immer so vor. Die Lifecycle Methode ist eine einfache Methode der Klasse. Genau so behandle ich sie auch:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// implementierung</span></span><br><span class=\"highlight-line\"><span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>firstName<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>lastName<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>idState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">logger</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connectedCallback\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should trigger connectedCallback\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">//init</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// rufe die Methode direkt auf</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// hier laufen wir in den else Block</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>match <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span>addressForm<span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        params<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        id<span class=\"token operator\">:</span> <span class=\"token string\">\"23\"</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// hier sind wir im if</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// jetzt erwarten wir Daten</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>addressForm<span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> <span class=\"token string\">\"Musterstraße 44\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>addressForm<span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>addressForm<span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>addressForm<span class=\"token punctuation\">.</span>idState <span class=\"token operator\">=</span> <span class=\"token string\">\"23\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<h4 id=\"regex-matcher\" tabindex=\"-1\">Regex matcher <a class=\"direct-link\" href=\"#regex-matcher\">#</a></h4>\n<p>Wir haben eine Methode, die UUIDS ausspuckt. Nach jedem Aufruf gibt es eine neue ID. Folglich können wir im Test keine Daten vergleichen, weil diese sich nie gleichen werden. Aber die UUIDs folgen einem festen Pattern. Das ist unser Ansatzpunkt.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create-uuid\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should create a uuid\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> uuid <span class=\"token operator\">=</span> <span class=\"token function\">create_UUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>uuid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatch</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\b[0-9a-f]{8}\\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\\b[0-9a-f]{12}\\b</span><span class=\"token regex-delimiter\">/</span></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wir rufen eine neue ID ab. Die vergleichen wir über den Matcher <em>toMatch()</em> (Zeile 4) mit einer REGEX, die ich mir im Internet ausgeliehen habe. Siehe da - ein erfolgreicher Test.</p>\n<h4 id=\"timeouts\" tabindex=\"-1\">Timeouts <a class=\"direct-link\" href=\"#timeouts\">#</a></h4>\n<p>Sollte man aus welchen Grund auch immer Timeouts verwenden, bietet Jest auch hier die Möglichkeit zum Testen. In der Komponente <em>KubaAddressForm</em> habe ich einen solchen Fall etwas künstlich erzeugt. In der <em>connectedCallback</em>-Methode führe ich die Logger-Funktion aus, nachdem ich 3 Sekunden gewartet habe. Der einzige Sinn, warum ich das mache, ist um es zu zeigen, dass es geht ;-)<br>\nIm Test habe ich die Logger-Funktion mit jest.fn() gemockt und erwarte den Aufruf:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// Implementierung</span></span><br><span class=\"highlight-line\"><span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">logger</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connectedCallback\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Test</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should trigger connectedCallback\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> loggerMock <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> addressForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaAddressForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>logger <span class=\"token operator\">=</span> loggerMock<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>loggerMock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeCalledWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connectedCallback\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wenn man den Test ausführt, sagt die Konsole, dass der LoggerMock nicht aufgerufen wurde. Das ist auch korrekt, weil zur Zeit der Überprüfung wurde er auch nicht ausgeführt. Sondern drei Sekunden später. Damit der Test mitbekommt, dass da ein Timer läuft, muss man Jest mitteilen, dass man Timer gerne faken würde. Danach kann dem Test sagen er soll die Timeouts direkt ausführen.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// in der Obersten Zeilen der Datei außerhalb des Describe-Blocks</span></span><br><span class=\"highlight-line\">jest<span class=\"token punctuation\">.</span><span class=\"token function\">useFakeTimers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should trigger connectedCallback\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> loggerMock <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> addressForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaAddressForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span>logger <span class=\"token operator\">=</span> loggerMock<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">///////////////</span></span><br><span class=\"highlight-line\">    jest<span class=\"token punctuation\">.</span><span class=\"token function\">runAllTimers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">///////////////</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>loggerMock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeCalledWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connectedCallback\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Zeile 2 zeigt die Konfiguration für Jest.<br>\nIn Zeile 16 passiert dann die Magie. Jest lässt alle Timeouts auslaufen und der Test geht erfolgreich durch.</p>\n<h5 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h5>\n<p>Heute haben wir weitere Testfälle gelernt. Ab jetzt haben wir für die meisten Fälle das Handwerk Tests zu schreiben. Es gelten keine Ausreden mehr. Ich hoffe ich konnte meine Begeisterung für Jest etwas in Worte fassen und lade alle herzlich ein es auszuprobieren.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-09-03T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/adress-app-tests-part-ii/",
      "url": "https://derkuba.de/content/posts/stenciljs/adress-app-tests-part-ii/",
      "title": "StencilJS-Tutorial: Real World Unit Tests Teil 2",
      "content_html": "<p>Dieser Artikel setzt auf dem letzten <a href=\"https://derkuba.de/content/posts/stenciljs/adress-app-tests/\">Artikel &quot;StencilJS-Tutorial: Real World Unit Tests&quot;</a> auf und gibt weitere Einblicke und Beispiele zum Thema Jest-Testing innerhalb einer StencilJS-App.<!-- endOfPreview --></p>\n<h4 id=\"nachtrag-unit-testing\" tabindex=\"-1\">Nachtrag Unit-Testing <a class=\"direct-link\" href=\"#nachtrag-unit-testing\">#</a></h4>\n<p>Im ersten Teil habe ich gezeigt wie man per DOM-Methoden im Unit-Test die Komponente ansteuert. Der dazugehörige Beispieltest läuft grün. Aber er ist auch sehr simpel. Es gibt keine geschachtelten Webcomponents. Hier möchte ich ein weiteres Beispiel zeigen: <em>kuba-address-form.tsx</em>. Diese Komponente verwendet mehrere weitere Komponenten, wie z.B. das <em>kuba-input</em> und den <em>kuba-button</em>.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// vereinfachte Darsellung</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token keyword\">class</span></span> KubaAddressForm <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">onSubmit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button handleClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token keyword\">class</span></span> KubaButton <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>handleClick<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>slot<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Mit dem Beispiel zum Thema Test würde so ein Unit-Test aussehen:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// hier kommt man an die Grenze von der newSpecPage</span></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should submit the form with query on dom\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">newSpecPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        components<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>KubaAddressForm<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        html<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;kuba-address-form>&lt;/kuba-address-form></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">        page<span class=\"token punctuation\">.</span>body</span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-address-form\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">.</span>shadowRoot<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerHTML</span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// möglich! output: speichern</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    page<span class=\"token punctuation\">.</span>body</span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-address-form\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span>shadowRoot<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span>shadowRoot <span class=\"token comment\">// undefined</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Das Expect habe ich absichtlich weggelassen, weil es gar nicht soweit kommt. Hier stoßen wir an die Grenze vom <em>newSpecPage</em>-Objekt. Es geht hin und mockt alle weiteren Komponenten, die im Render-Block stehen weg. Das bedeutet, dass wir keine Möglichkeit haben per Unit-Test das Click-Event des Buttons innerhalb der Kuba-Button-Komponente zu erreichen.<br>\nDer Consolen-Output aus Zeile 8 gibt noch das Label des Buttons aus (&quot;speichern&quot;). Der ShadowDom dahinter ist aber bereits undefined. Mit dieser Art des Test kommen wir nicht weiter.</p>\n<p>Auf dem Click-Event des Buttons liegt aber eine Methode (&quot;onSubmit&quot;), die wir unbedingt testen möchten. An dieser Stelle möchte das Stencil-Framework die Unit-Test-Ebene verlassen und auf die angebotenen e2e-Tests verweisen. In diesen Tests haben wir echte Komponenten und können &quot;seleniumartig&quot; auf diesen Operieren. Ich möchte aber lieber nur Unit-Tests schreiben und echte E2E-Tests mit einem echten Browser verwenden.</p>\n<p>Die Alternative sieht so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> KubaAddressForm <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../kuba-address-form\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should submit the form\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> addressForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaAddressForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">onSubmit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wir importieren die Klassenreferenz und erzeugen daraus eine Instanz. Auf dieser können wir alle nötigen Attribute und Methoden aufrufen.</p>\n<h4 id=\"jest.fn()\" tabindex=\"-1\">jest.fn() <a class=\"direct-link\" href=\"#jest.fn()\">#</a></h4>\n<p>Dies ist ein mächtiger Mock mit ganz viel Funktionalität. Man kann damit Funktionen/Methoden überschreiben und erhält damit die Möglichkeit den Aufruf mitsamt seiner Parameter aufzunehmen und abzufragen. Der Mock kann auch als Instanz verwendet werden, callbacks zurückliefern und Testwerte zurückliefern. Immer dann wenn man den Aufruf irgendeiner Funktion unterbinden oder wegmocken möchte, bietet sich jest.fn() an.</p>\n<p>Schauen wir uns ein einfaches Beispiel aus dem Adressbuchprojekt an. Es gibt dort die <em>kuba-input-functional</em>-Komponente, die einen Setter übergeben bekommt. Jedes Mal wenn man etwas in das Textfeld eintippt wird diese Funktion aufgerufen. Genau dies möchten wir nun einmal getestet haben:</p>\n<p>Ausimplementiert sieht der Code so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// Implementierung</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> KubaInputFunctional <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  componentId<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  label<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  type<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  value<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  setter<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  componentId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  label<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  type<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"number\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  setter<span class=\"token operator\">:</span> <span class=\"token builtin\">Function</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onInput</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">setter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"kuba-input\"</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">      <span class=\"token operator\">&lt;</span>label htmlFor<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>componentId<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">      <span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">}</span> id<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>componentId<span class=\"token punctuation\">}</span> value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span> onInput<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onInput<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Verwendung in einer Komponente:</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Methode</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onChangeAddress</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// renderblock</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>KubaInputFunctional</span><br><span class=\"highlight-line\">    componentId<span class=\"token operator\">=</span><span class=\"token string\">\"street\"</span></span><br><span class=\"highlight-line\">    label<span class=\"token operator\">=</span><span class=\"token string\">\"Adresse:\"</span></span><br><span class=\"highlight-line\">    value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    type<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    setter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onChangeAddress<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>KubaInputFunctional<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span></code></pre>\n<p>Wir sehen, dass die onInput-Methode (Zeile 15) im input-Tag (Zeile 21) verwendet wird. Die Property <em>setter</em> (Zeile 8) wird als Funktion in Zeile 17 aufgerufen.<br>\nAb Zeile 28 sehen wir, wie und womit diese Property gefüllt wird. Da setzen wir den Test an:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-input-functional.spec.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should trigger onInputEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> setterMock <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">newSpecPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        components<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token function-variable function\">template</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>KubaInputFunctional</span><br><span class=\"highlight-line\">                componentId<span class=\"token operator\">=</span><span class=\"token string\">\"street\"</span></span><br><span class=\"highlight-line\">                label<span class=\"token operator\">=</span><span class=\"token string\">\"Adresse:\"</span></span><br><span class=\"highlight-line\">                value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                type<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                setter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>setterMock<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>KubaInputFunctional<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> event <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Event</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    page<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>setterMock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Der Test hat die typischen drei Teile:</p>\n<ol>\n<li>Initialisierung</li>\n<li>Herbeiführen des Zustandes</li>\n<li>Erwartungen überprüfen.</li>\n</ol>\n<p>Im ersten Teil definieren einen <em>setterMock</em> in Zeile 3, indem wir einer Variable das jest.fn() zuweisen. Das den gleichen Wert wie eine ausimplementierte Funktion mit Logik. Diese Funktion übergeben wir der KubaInputFunctional als Property im Attribut von <em>setter</em> (Zeile 13). Damit ist die Initialisierung abgeschlossen.</p>\n<p>Im zweiten Teil simulieren wir die Eingabe in das Textfeld. Da das native Input auf das Event &quot;input&quot; lauscht, ist das unser Ansatzpunkt. Wir steuern das <em>input</em> innerhalb der Komponente an (querySelector) und führen auf diesen Knoten den Event aus. Das geschieht über die <em>.dispatchEvent()</em>-Funktion des HTML-Knotens. Diese bekommt als Parameter ein Objekt vom Typ Event oder Customevent übergeben. Diese Events bekommt als Konstruktorparameter den Namen des Events und ggf. Daten übergeben.<br>\nDamit wird die Funktion <em>onInput</em> der KubaInputFunctional-Komponente aufgerufen. Man kann dies im Debugger oder per console.log beobachten.</p>\n<p>Im dritten Teil müssen wir den Test mit einer Erwartung füttern, damit dieser weiß, ob der Test erfolgreich war. Hier kommt wieder unser <em>setterMock</em> zum Zug. Laut meiner Behauptung speichert ein Mockobjekt seinen Aufruf. Abfragen lässt sich dies mit <em>.toHaveBeenCalled</em> oder <em>toBeCalledWith</em>. Der Test läuft erfolgreich durch. Somit wurde der Mock aufgerufen.<br>\nMann kann den Mock auch in seine Aufrufe mitsamt Parametern zerteilen.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>setterMock<span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalledWith</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// oder</span></span><br><span class=\"highlight-line\"><span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>setterMock<span class=\"token punctuation\">.</span>mock<span class=\"token punctuation\">.</span>calls<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Hier steht das erste Array für den Aufruf (0: erster Aufruf; 1: zweiter Aufruf)<br>\nund das zweite Array für die Parameter (0: erster Parameter; 1: zweiter Parameter);<br>\nDamit kann man zusätzlich noch mehrere Aufrufe gleichzeitig testen. Ich habe beide Varianten bzw. Schreibweisen vorgeführt.</p>\n<p>Desweiteren kann der Mock Werte zurückliefern:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">setterMock<span class=\"token punctuation\">.</span><span class=\"token function\">mockReturnValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"23\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// und er gibt immer diesen Wert zurück</span></span><br><span class=\"highlight-line\">setterMock<span class=\"token punctuation\">.</span><span class=\"token function\">mockReturnValueOnce</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"13\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// er gibt einmal diesen Wert zurück</span></span></code></pre>\n<h4 id=\"jest.spyon\" tabindex=\"-1\">jest.spyOn <a class=\"direct-link\" href=\"#jest.spyon\">#</a></h4>\n<p>Der Spy zählt ebenfalls zu den Mocks. Nur wird hier eine Funktion nicht ersetzt oder überschrieben, sondern man lauert auf den Aufruf. Das ist sehr praktisch wenn man zum Beispiel auf Operationen auf dem <em>windows</em>- oder <em>document</em>-Objekt testen möchte.<br>\nMein Beispiel im Adressbuch-Projekt ist leider sehr konstruiert, aber ich hoffe, dass man verstehen kann worauf ich hinaus möchte.</p>\n<p>In der Komponente <em>kuba-address-form</em> gibt es eine Submit-Methode. In dieser habe ich eine Such-Operation auf einen Tag &quot;test&quot; eingebaut. Stellt man sich jetzt vor dieser Aufruf wäre verschachtelt in viele if-Verzweigungen und man möchte diese Testen, kann man auf diese Operation lauschen.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should use a spy\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> documentSpy <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">spyOn</span><span class=\"token punctuation\">(</span>global<span class=\"token punctuation\">.</span>document<span class=\"token punctuation\">,</span> <span class=\"token string\">\"getElementById\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> addressForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaAddressForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    addressForm<span class=\"token punctuation\">.</span><span class=\"token function\">onSubmit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>documentSpy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>documentSpy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeCalledWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die Funktion <em>jest.spyOn</em> hat als Parameter das zu belauschende Objekt und den Funktionsnamen. Im Test lauschen wir auf das globale Dokument und im speziellen auf die &quot;getElementById&quot;. In Zeile 2 sieht man die Iniatilisierung des Spy. Dieser wird dann analog zu <em>jest.fn()</em> behandelt. Man kann nach dem Herbeiführen des Wunschzustandes überprüfen ob das Funktion aufgerufen wurde und/oder mit welchem Parameter aufgerufen wurde. Man könnte diese Überprüfung auch mit jest.fn() ausführen. Aber das bleibt Geschmackssache.</p>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>In diesem Artikel haben wir gelernt, dass das <em>newSpecPage</em>-Objekt nur eine Ebene tief mockt und das zu Problemen beim Unit-Testen führt. Dafür bietet StencilsJS die Hauseigene E2E-Bibliothek an.<br>\nWir haben jest.fn() kennen- und schätzengelernt und am Beispiel gesehen, wie man es nutzen kann. Daneben wurde noch das jest.spyOn als Alternative gezeigt.</p>\n<p>Im nächsten Artikel zeige ich wie man komplexere Komponente testes und insbesonders wie man ganze Module mockt.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-08-27T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/adress-app-tests/",
      "url": "https://derkuba.de/content/posts/stenciljs/adress-app-tests/",
      "title": "StencilJS-Tutorial: Real World Unit Tests",
      "content_html": "<p>Nachdem wir <a href=\"https://derkuba.de/content/posts/stenciljs/jest-intro/\">im letzten Artikel</a> die Grundlagen des Testing-Frameworks Jest gelernt haben, wenden wir dieses Wissen in unserem Beispielprojekt <em>Adressbuch</em> an. <!-- endOfPreview -->Kleine Warnung vorab. <a href=\"https://github.com/ionic-team/stencil/issues/2942\">Zurzeit (21.08.21 15:37Uhr)</a> gibt es Probleme zwischen dem <em>stencil-core</em> und der Jest-Version 27. Aktuell bekommt man einen Fehler angezeigt, wenn man die Tests ausführt. Ein Downgrade auf die Version 26 ist die Lösung:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// package.json</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token string\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^26.0.0\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"jest-cli\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^26.0.0\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span></code></pre>\n<p>Wir haben jetzt die klassische Situation. Wir betreten ein bestehendes Projekt und es sind keine Tests vorhanden. Die Gründe wurden im letzten Artikel erläutert. Aber was nun? Wo und wie geht man vor. Ich empfehle an dieser Stelle erst einmal Jest zu installieren. Häufig ist es im Projekt-Skeleton bereits enthalten. Wenn dies nicht der Fall ist, bitte den <a href=\"https://derkuba.de/content/posts/stenciljs/jest-intro/\">vorherigen Artikel</a> lesen.</p>\n<h4 id=\"%C3%BCberlick-verschaffen\" tabindex=\"-1\">Überlick verschaffen <a class=\"direct-link\" href=\"#%C3%BCberlick-verschaffen\">#</a></h4>\n<p>Aber wie?</p>\n<p>Ich empfehle die Coverage anschauen. Es handelt sich um eine statische Analyse des Codes und das Ergebnis ist ein Überblick welche Teile des Codes Tests durchlaufen.<br>\nDas Zauberwort ist <strong>--coverage</strong>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run <span class=\"token builtin class-name\">test</span> --coverage</span></code></pre>\n<p>Das Ergebnis sieht in meinem Fall so aus:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">----------------------------------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>----------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>----------------------------</span><br><span class=\"highlight-line\">File                              <span class=\"token operator\">|</span> % Stmts <span class=\"token operator\">|</span> % Branch <span class=\"token operator\">|</span> % Funcs <span class=\"token operator\">|</span> % Lines <span class=\"token operator\">|</span> Uncovered Line <span class=\"token comment\">#s</span></span><br><span class=\"highlight-line\">----------------------------------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>----------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>----------------------------</span><br><span class=\"highlight-line\">All files                         <span class=\"token operator\">|</span>   <span class=\"token number\">54.55</span> <span class=\"token operator\">|</span>    <span class=\"token number\">15.79</span> <span class=\"token operator\">|</span>   <span class=\"token number\">39.47</span> <span class=\"token operator\">|</span>   <span class=\"token number\">54.64</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\"> components/kuba-address-form     <span class=\"token operator\">|</span>   <span class=\"token number\">30.56</span> <span class=\"token operator\">|</span>        <span class=\"token number\">0</span> <span class=\"token operator\">|</span>   <span class=\"token number\">27.27</span> <span class=\"token operator\">|</span>   <span class=\"token number\">30.56</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-address-form.tsx           <span class=\"token operator\">|</span>   <span class=\"token number\">30.56</span> <span class=\"token operator\">|</span>        <span class=\"token number\">0</span> <span class=\"token operator\">|</span>   <span class=\"token number\">27.27</span> <span class=\"token operator\">|</span>   <span class=\"token number\">30.56</span> <span class=\"token operator\">|</span> <span class=\"token number\">26,34</span>,38,43-47,54-63,67-85</span><br><span class=\"highlight-line\"> components/kuba-button           <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-button.tsx                 <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\"> components/kuba-home             <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-home.tsx                   <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\"> components/kuba-input            <span class=\"token operator\">|</span>   <span class=\"token number\">66.67</span> <span class=\"token operator\">|</span>        <span class=\"token number\">0</span> <span class=\"token operator\">|</span>      <span class=\"token number\">40</span> <span class=\"token operator\">|</span>   <span class=\"token number\">63.64</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-input-functional.tsx       <span class=\"token operator\">|</span>      <span class=\"token number\">50</span> <span class=\"token operator\">|</span>        <span class=\"token number\">0</span> <span class=\"token operator\">|</span>       <span class=\"token number\">0</span> <span class=\"token operator\">|</span>      <span class=\"token number\">40</span> <span class=\"token operator\">|</span> <span class=\"token number\">16</span>-19</span><br><span class=\"highlight-line\">  kuba-input.tsx                  <span class=\"token operator\">|</span>   <span class=\"token number\">83.33</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>   <span class=\"token number\">66.67</span> <span class=\"token operator\">|</span>   <span class=\"token number\">83.33</span> <span class=\"token operator\">|</span> <span class=\"token number\">20</span></span><br><span class=\"highlight-line\"> components/kuba-list             <span class=\"token operator\">|</span>   <span class=\"token number\">55.56</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">40</span> <span class=\"token operator\">|</span>   <span class=\"token number\">55.56</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-list.tsx                   <span class=\"token operator\">|</span>   <span class=\"token number\">55.56</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">40</span> <span class=\"token operator\">|</span>   <span class=\"token number\">55.56</span> <span class=\"token operator\">|</span> <span class=\"token number\">12</span>-15,37</span><br><span class=\"highlight-line\"> components/kuba-table-attributes <span class=\"token operator\">|</span>      <span class=\"token number\">50</span> <span class=\"token operator\">|</span>       <span class=\"token number\">25</span> <span class=\"token operator\">|</span>      <span class=\"token number\">25</span> <span class=\"token operator\">|</span>      <span class=\"token number\">50</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-table-attributes.tsx       <span class=\"token operator\">|</span>      <span class=\"token number\">50</span> <span class=\"token operator\">|</span>       <span class=\"token number\">25</span> <span class=\"token operator\">|</span>      <span class=\"token number\">25</span> <span class=\"token operator\">|</span>      <span class=\"token number\">50</span> <span class=\"token operator\">|</span> <span class=\"token number\">18</span>-26</span><br><span class=\"highlight-line\"> components/kuba-table-options    <span class=\"token operator\">|</span>   <span class=\"token number\">60.87</span> <span class=\"token operator\">|</span>    <span class=\"token number\">33.33</span> <span class=\"token operator\">|</span>      <span class=\"token number\">40</span> <span class=\"token operator\">|</span>   <span class=\"token number\">63.64</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-table-options.tsx          <span class=\"token operator\">|</span>   <span class=\"token number\">60.87</span> <span class=\"token operator\">|</span>    <span class=\"token number\">33.33</span> <span class=\"token operator\">|</span>      <span class=\"token number\">40</span> <span class=\"token operator\">|</span>   <span class=\"token number\">63.64</span> <span class=\"token operator\">|</span> <span class=\"token number\">25,37</span>,49-73</span><br><span class=\"highlight-line\"> components/kuba-table-slot       <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  kuba-table-slot.tsx             <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\"> store                            <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">  address-store.ts                <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>      <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span>     <span class=\"token number\">100</span> <span class=\"token operator\">|</span></span><br><span class=\"highlight-line\">----------------------------------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>----------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>---------<span class=\"token operator\">|</span>----------------------------</span><br><span class=\"highlight-line\">Test Suites: <span class=\"token number\">7</span> failed, <span class=\"token number\">1</span> passed, <span class=\"token number\">8</span> total</span><br><span class=\"highlight-line\">Tests:       <span class=\"token number\">7</span> failed, <span class=\"token number\">1</span> passed, <span class=\"token number\">8</span> total</span><br><span class=\"highlight-line\">Snapshots:   <span class=\"token number\">1</span> passed, <span class=\"token number\">1</span> total</span><br><span class=\"highlight-line\">Time:        <span class=\"token number\">2.799</span> s</span><br><span class=\"highlight-line\"></span></code></pre>\n<p>Wir sehen in der Tabelle, das bereits einige Tests bestehen und wir eine Gesamtabdeckung von 54.55% haben.<br>\nAber das reicht uns natürlich nicht. Zur besseren Übersicht müssen wir noch etwas an der Konfiguration der Tests schrauben:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// stencil.config.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> config<span class=\"token operator\">:</span> Config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"> testing<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    coverageDirectory<span class=\"token operator\">:</span> <span class=\"token string\">\"./reports\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    coverageReporters<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"html\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Führen wir erneut den Testbefehl aus, erhalten wir unter /reports allerlei Dateien. Öffnen wir nun im Browser die <em>index.html</em>:</p>\n<p>Diese Einstellung gibt dem Reporter, einem Tool der eine übersichtliche Auswertung innerhalb einer HTML-Seite erstellt, einen Speicherort. Das Flag &quot;text&quot; lässt weiterhin die obige Tabelle auf der Konsole erscheinen.</p>\n<p><img src=\"/content/img/stenciljs-tutorial/jest_html_report.png\" alt=\"jest_html_report\" title=\"Jest HTML Reporter\"><div class=\"has-text-right image-subline\">Bild 1: Jest HTML Reporter</div></p>\n<p><img src=\"/content/img/stenciljs-tutorial/jest-kuba-adress-form-report.png\" alt=\"jest-kuba-adress-form-report\" title=\"Jest HTML Reporter\"><div class=\"has-text-right image-subline\">Bild 2: Jest HTML Reporter: Adressbuch-Eben</div></p>\n<p><img src=\"/content/img/stenciljs-tutorial/jest-adress-form-snippet.png\" alt=\"jest-adress-form-snippet\" title=\"jest-adress-form-snippet\"><div class=\"has-text-right image-subline\">Bild 3: Code-Auszug</div></p>\n<p>Das erste Bild zeigt die kunterbunte Auswertung. Es enthält die gleichen Daten wie die Tabelle auf der Konsole. Klickt man aber auf die Komponenten, z.B. auf die <em>components/kuba-adress-form</em> wandert man eine Ebene tiefer (Bild 2). Die Ebenen entsprechen der Ordnerstruktur. Ein weiterer Klick auf den <em>kuba-address-form.tsx</em> lässt den wirklichen Mehrwert erkennen. Wir sehen jetzt auf Code-Ebene welche Teile, wie oft ausgeführt werden. Zusätzlich zeigen die roten Stellen welche Stellen, Funktionen, Verzweigungen ausgelassen wurden. Das ist der Fahrplan für unsere Tests. Man kann sich jetzt Datei für Datei durchhangeln.<br>\nWir starten mit einem einfachen Beispielstest.</p>\n<h4 id=\"snapshot-tests\" tabindex=\"-1\">Snapshot-Tests <a class=\"direct-link\" href=\"#snapshot-tests\">#</a></h4>\n<p>Als ich das erste Mal auf diese Art der Tests gestoßen bin, habe ich mich sofort verliebt.</p>\n<p>Schauen wir jetzt mal folgenden Test an:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> newSpecPage <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core/testing\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> KubaButton <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../kuba-button\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should render the button\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">newSpecPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            components<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>KubaButton<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            html<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;kuba-button>&lt;/kuba-button></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchInlineSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should render the button\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">newSpecPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            components<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>KubaButton<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token function-variable function\">template</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button handleSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wir erkennen den bekannten Testrahmen mit einem <em>describe</em>-Block und zwei <em>it</em>-Blöcke. Wir importieren die zu testende Komponente in Zeile 2 - den KubaButton. In Zeile 7 und 15 wird die Referenz auf diesen Button dem <em>newSpecPage</em>-Objekt des Stencil-Testing-Cors übergeben. Diese wird benötigt, damit Stencil eine Instanz dieser Klasse erstellen kann. Zugriff darauf erhalten wir anschließend über <em>page.rootInstance</em>. Als zweiten Übergabeparameter (Korrekt wäre zu schreiben, dass <em>newSpecPage</em> ein Konfigurationsobjekt mit mehreren Parametern erhält ) können wir zwischen <em>html</em> oder <em>template</em> wählen. Ersteres erhält die zu rendernde Komponente als String. Der Nachteil ist, dass man nur statische String-Parameter übergeben kann. Diesen Nachteil gleicht die zweite Variante <em>template</em> aus. Hier kann man Objekte übergeben. Damit kein Fehler geworfen wird, muss noch das {h} aus dem Core <em>&quot;@stencil/core&quot;</em> importiert werden.<br>\nEin weiterer Unterschied in der Art und Weise dieser Tests findet sich in den Zeilen 10 und 18: <em>toMatch(Inline)Snapshot</em>.</p>\n<p>Der Snapshot-Mechanismus speichert ein Abbild des Objekts oder des HTML-Gerüsts in genau diesem Zustand. In der ersten Variante wird das Schnipsel dann als Parameter erzeugt. Im zweiten wird eine Datei unter /<strong>snapshots</strong>/kuba-button.spec.tsx.snap erzeugt, die so aussieht:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// Jest Snapshot v1, https://goo.gl/fbAQLP</span></span><br><span class=\"highlight-line\"></span><br>exports<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">kuba-button renders 2</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"><br><span class=\"highlight-line\">&lt;kuba-button></span><br><span class=\"highlight-line\">  &lt;mock:shadow-root></span><br><span class=\"highlight-line\">    &lt;button></span><br><span class=\"highlight-line\">      &lt;slot>&lt;/slot></span><br><span class=\"highlight-line\">    &lt;/button></span><br><span class=\"highlight-line\">  &lt;/mock:shadow-root></span><br><span class=\"highlight-line\">&lt;/kuba-button></span><br></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br><span class=\"highlight-line\"></span><br>exports<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">kuba-button should render the button 1</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"><br><span class=\"highlight-line\">&lt;kuba-button></span><br><span class=\"highlight-line\">  &lt;mock:shadow-root></span><br><span class=\"highlight-line\">    &lt;button></span><br><span class=\"highlight-line\">      &lt;slot>&lt;/slot></span><br><span class=\"highlight-line\">    &lt;/button></span><br><span class=\"highlight-line\">  &lt;/mock:shadow-root></span><br><span class=\"highlight-line\">&lt;/kuba-button></span><br></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code></pre>\n<p>Diese Datei wird eingecheckt. Bei der nächsten Ausführung des Tests wird dann gegen diese Datei verglichen. Sollte es sich etwas geändert haben, zeigt der Test dies auf. So erhält man Feedback, ob die Codeänderung Auswirkung auf die Komponente hatte. War dies gewollt, wird die Datei überschrieben. Wenn nicht, hat man die Gelegenheit seinen Fehler zu korrigieren.</p>\n<p>Warum wird dies von mir so gefeiert?</p>\n<p>Früher, als jQuery noch state of the art war sah ein Test in PseudoCode so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// jasmine</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">describe <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    it<span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> htmlSnippet <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;div>&lt;button class=\"kuba-button\">&lt;/button>&lt;/div>'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">renderSnippet</span><span class=\"token punctuation\">(</span>htmlSnippet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".kuba-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeTruthy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token comment\">// fügt weiteren HTML-Code dazu</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".kuba-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".kuba-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">classes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".kuba-button > .neuesKindA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Neuer Text\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">         <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".kuba-button > .neuesKindB\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Ladespinner\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Zugegebenermaßen es sieht sehr ähnlich aus. Worauf ich aber hinaus möchte ist, dass man jede Änderung an der Komponente in einem eigenen Expect abprüfen musste. Jetzt wird der Zustand hergestellt und alle Knoten, die neu dazukommen oder sich ändern, müssen nicht einzeln abgefragt werden.</p>\n<h4 id=\"unit-tests\" tabindex=\"-1\">Unit-Tests <a class=\"direct-link\" href=\"#unit-tests\">#</a></h4>\n<p>Bisher haben wir uns nur um das &quot;Aussehen&quot; der Komponente gekümmert. Aber wie testen man jetzt das Verhalten. Wir bleiben am einfachen Beispiel des &quot;kuba-buttons&quot;. Dieser hat eine private Methode, die das Property aufruft:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaButton</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> handleSubmit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">handleClickEvent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSubmit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClickEvent<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>slot <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Der Test für diese Klasse sieht dann so aus:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should handle click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> clickMock <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">newSpecPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        components<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>KubaButton<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token function-variable function\">template</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button handleSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>clickMock<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    page<span class=\"token punctuation\">.</span>body</span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span>shadowRoot<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>clickMock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should handle alternatively\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> clickMock <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> kubaButton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KubaButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    kubaButton<span class=\"token punctuation\">.</span>handleSubmit <span class=\"token operator\">=</span> clickMock<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    kubaButton<span class=\"token punctuation\">.</span><span class=\"token function\">handleClickEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>clickMock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toHaveBeenCalled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wir sehen wieder die bekannte Teststruktur. Die Zeilen 2 und 17 zeigen ein weiteres elementares Feature von Jest: <em>jest.fn()</em>. Die genaue Funktion beschreibe ich im nächsten Artikel. Für den Moment reicht es zu wissen, dass diese Funktion ein Mock ist und den Übergabeparameter simuliert. Zusätzlich kann bei diesem Mock erfragt werden, ob der Mock in der Implementierung des Buttons aufgerufen wurde.</p>\n<p>Aber wie führt man den Aufruf der Methode <em>handleClickEvent</em> herbei? Dazu möchte ich zwei Möglichkeiten aufzeigen:</p>\n<ol>\n<li>\n<p>Operation auf dem DOM.<br>\nWir instanziieren eine SpecPage (Zeile 3). Auf dieser Page stehen uns die bekannten DOM-Operationen zur Verfügung. Wir selektieren den Button (Zeile 9). Achtung! Der Rest der HTML-Struktur ist im <a href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM\">shadow Dom</a> gekapselt. Dieser muss erst angesteuert werden, um dann darauf den Button zu selektieren ( Zeile 10 ). Da wir den Button im DOM erreicht haben, können wir die native <em>.click()</em>-Funktion aufrufen ( Zeile 11). Damit haben wir das Event ausgelöst. Der Mock sollte ausgelöst worden sein. Dies erfragen wir mit dem <em>expect</em> (Zeile 13).</p>\n</li>\n<li>\n<p>Bei der zweiten Implementierung sollten die Alarmglocken los schrillen. Denn einerseits testet man hier die Implementierung und andererseits eine private Funktion. Ich bin der Meinung, dass man lieber gegen dieses Paradigma verstößt, als dass man auf den Test verzichtet. Ein Aufruf einer privaten Funktion ist in Typescript möglich und der Test läuft auch grün.</p>\n</li>\n</ol>\n<h4 id=\"kleine-kniffe\" tabindex=\"-1\">Kleine Kniffe <a class=\"direct-link\" href=\"#kleine-kniffe\">#</a></h4>\n<p>Hier noch ein paar kleine Tipps, die den Umgang erleichtern.</p>\n<p>Man kann einzelne Tests innerhalb eines <em>describe</em>-Blocks ausschalten/ignorieren:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">    <span class=\"token function\">xit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should ...\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// oder</span></span><br><span class=\"highlight-line\">    it<span class=\"token punctuation\">.</span><span class=\"token function\">skip</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should ...\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token comment\">// oder gar den ganzen describe-Block</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">xdescribe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Man kann einen Test auch forcieren:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">    <span class=\"token function\">fit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should ...\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// oder</span></span><br><span class=\"highlight-line\">    it<span class=\"token punctuation\">.</span><span class=\"token function\">only</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should ...\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token comment\">// oder gar den ganzen describe-Block</span></span></code></pre>\n<p>Man kann beim Ausführen eine Wildcard mitgeben und es wird nach einem Test mit dem Namen als Wildcard gesucht:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">  npm run test kuba<span class=\"token operator\">-</span>button</span></code></pre>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>Wir haben in diesem Artikel einiges gelernt. Mit diesem Wissen sind wir im Stande die Meisten Tests der Anwendung nachzuholen. Aufgeschoben ist immer besser als aufgehoben. Meiner Meinung nach sind Tests, die nachgeholt werden sehr wertvoll. Man muss sich die Implementierung nochmal anschauen und findet gegebenenfalls Verbesserungen. Man bekommt mehr Sicherheit, um überhaupt Refactoring anzugehen.</p>\n<p>Was haben wir gelernt?</p>\n<ul>\n<li>Snapshot-Tests: Was, warum und wie?</li>\n<li>Einfache Unit Tests</li>\n<li>Test-Coverage und wie sie bei der Initiierung von Tests hilft.</li>\n<li>Tests forcieren und einzelne Tests ausführen</li>\n</ul>\n<p>Im nächsten Artikel möchte ich tiefer in das Thema Mocking einsteigen und noch weitere Tests zeigen.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-08-21T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/jest-intro/",
      "url": "https://derkuba.de/content/posts/stenciljs/jest-intro/",
      "title": "StencilJS-Tutorial: JEST",
      "content_html": "<p><a href=\"https://jestjs.io/\">Jest ist DAS Javascript Testing-Framework</a>. Wenn man mit Javascript/Typescript arbeitet, kommt man an diesem Schweizer-Taschenmesser des Testens nicht vorbei. Ich bin ein riesen Fan seitdem wir uns 2016 das erste mal begegnet sind. Ich habe davor mit diversen Test-Framework gearbeitet.<!-- endOfPreview --> Dazu zählen:</p>\n<ul>\n<li><a href=\"https://mochajs.org/\">Mocha</a>,</li>\n<li><a href=\"https://jasmine.github.io/\">Jasmine</a>,</li>\n<li><a href=\"https://karma-runner.github.io/latest/index.html\">Karma</a>,</li>\n<li><a href=\"https://sinonjs.org/\">Sinon</a>,</li>\n<li><a href=\"https://www.chaijs.com/\">Chai</a>,</li>\n</ul>\n<p>Die Entwickler bei Facebook, die Jest entwickelt haben, haben sich all diese Frameworks angeschaut. Sie haben die Essenz des jeweiligen Frameworks verstanden und es in ein eigenes Framework gepackt. Jest hat das Look and Feel von Jasmine, einen Runner wie Karma, Mock- und Spy-Mechanismen wie Sinon und ist so stabil wie Mocha. Vor Jest hat man vor jedem Projektstart erstmal kompliziert die verschiedenen Testframeworks gemischt, und konfiguriert. Das ist jetzt alles Geschichte. Jest ist in sekundenschnelle installiert und läuft sofort los. In Vorbereitung auf diesen Artikel habe ich das <a href=\"https://github.com/facebook/jest\">Github-Repo</a> von Jest durchwühlt. Der erste Commit war am 14.05.2014 mit dem Titel &quot;FIRST!&quot;. Das erste Release ging mit der Version 0.4.0 einen Jahr später am 19.02.2015 an den Start. Seitdem hat es sich stetig weiterentwickelt. Stand heute befindet sich Jest bei Version 27.0.<br>\nEin besonderes Merkmal ist die Vielseitigkeit. Nicht nur, dass es all die Features der aufgelisteten Frameworks vereint, es ist auch mit den großen Web-Frameworks wie React, Angular, Vue, Svelte, StencilJS, Express, Playwright etc. kompatibel. Es führt einfach kein Weg an Jest vorbei :-)</p>\n<p><br>\nTesten von, durch und mit Javascript ist ein Thema, das jedem Web-Entwickler bekannt sein muss. In allen meinen Bewerbungsgesprächen habe ich danach gefragt. Sei es als Kandidat oder als Interviewer. Schockierend waren dabei immer die Ausreden, warum nicht getestet wurde. Dies hier sind meine drei Top Ausreden, bzw. Selbstlügen:</p>\n<ol>\n<li>Keine Zeit</li>\n<li>Machen wir später</li>\n<li>Zeitverschwendung (Kosten-Nutzen-Abwägung)</li>\n</ol>\n<p>Test-Schreiben bedeutet, dass man Code schreiben muss. Das dauert natürlich. Aber man erkauft sich dadurch Sicherheit, Wartbarkeit und die Möglichkeit für Refactorings. Tests haben mich bereits unzählige Male gerettet, weil sie Fehler sofort sichtbar machen. Ich war einmal in einem Projekt, das schon über ein Jahr lief und der Code bereits über 100.000 Zeilen gewachsen war. Keine Zeile war getestet. Eine Einarbeitung war nicht möglich, da keine Dokumentation vorhanden war. Also blieb uns nur das Wegschmeißen und ein Neustart.</p>\n<p>Ich kann nachvollziehen, dass das Einarbeiten in eine neue Technologie manchen Angst macht. Es benötigt etwas Zeit und Fleiß. Aber ich möchte an dieser Stelle helfen einen Einstieg zu bekommen.</p>\n<h4 id=\"genug-geredet%2C-hands-on\" tabindex=\"-1\">Genug geredet, Hands on <a class=\"direct-link\" href=\"#genug-geredet%2C-hands-on\">#</a></h4>\n<p><strong>Installieren</strong></p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\">npm install <span class=\"token operator\">--</span>save<span class=\"token operator\">-</span>dev jest</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// aus den Node-Modules heraus starten</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>node_modules<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>bin<span class=\"token operator\">/</span>jest <span class=\"token operator\">--</span>init</span></code></pre>\n<p>Der zweite Befehlt startet einen Installations-Wizard, der die Konfiguration übernimmt. Am Ende entsteht eine Jest-Config-Datei <strong>jest.config.js</strong>.</p>\n<p><strong>Erster Test</strong></p>\n<pre><code>// index.spec.ts\ndescribe(&quot;My first test&quot;, () =&gt; {\n    test(&quot;is really&quot;, () =&gt; {\n        expect(true).toBe(true);\n    });\n\n    it(&quot;should be true&quot;, () =&gt; {\n        expect(true).toBe(true);\n    });\n});\n</code></pre>\n<p>Die Tests von Jest sind BDD (Behaviour Driven) aufgebaut. Man beschreibt Was passiert und welches Verhalten man sich &quot;erhofft&quot;. Der Code muss in eine Datei, die ein <strong>.spec.</strong> oder ein .<strong>test.</strong> im Dateinamen stehen hat.<br>\nDer <em>describe</em> Block beschreibt das WAS (Modul, Komponente, Script). Dieses lässt sich beliebig Schachteln und so Subkomponenten, oder Subtests abbilden. Das Schlüsselwort <em>test</em> oder alternativ <em>it</em> beschreibt den eigentlichen Test. Für die Übersicht sollte man genau immer nur eine Sache, Funktion, Verhalten, etc. testen. Zum Einstieg haben ich keinen Code getestet. Der <em>expect</em>-Block beinhaltet den eigentlichen Vergleich. Dieser Block sagt dem Test, ob es erfolgreich war oder gescheitert ist. Der Parameter für den <em>expect</em>-Block bekommt einen Wert und muss dann durch eine Funktion verglichen werden. Konkret in diesem Beispiel durch <em>.toBe()</em>. Es gibt eine ganze Palette an <a href=\"https://jestjs.io/docs/expect\">Vergleichfunktionen</a>. So gibts es z.B. <em>.toEqual()</em>, .<em>toBeFalsy</em> oder <em>.toBeNull()</em>.</p>\n<p>Führt man diesen Code nun aus, erhält man folgendes Bild:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token comment\">// über das package.json script</span></span><br><span class=\"highlight-line\">npm run test</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// oder</span></span><br><span class=\"highlight-line\">npm test</span></code></pre>\n<p><img src=\"/content/img/stenciljs-tutorial/jest-first.png\" alt=\"jest in console\" title=\"Erster Jest-Test\"><div class=\"has-text-right image-subline\">Bild 1: npm run test</div></p>\n<p>Man findet die Beschreibung des Tests und des Verhaltens. Der grüne Pfeil zeigt, dass alles durchgelaufen ist und das Verhalten stimmt. Zusätzlich gibt es eine sogenante <em>Code-Coverage</em>, die eine Statistik darstellt, welche Zeilen des zu testenden Codes durchlaufen und getestet wurden. Da wir keinen Code ausgeführt haben, steht überall eine 0.</p>\n<p>In der Realität werden nicht immer alle Tests durchlaufen. Fügen wir nun einen <em>failenden</em> Tests hinzu und führen diesen aus:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should be false\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p><img src=\"/content/img/stenciljs-tutorial/jest-fail.png\" alt=\"jest in console\" title=\"Erster Jest-Test\"><div class=\"has-text-right image-subline\">Bild 2: failed</div></p>\n<p>Hier sehen wir nun, dass wir zwei erfolgreiche und einen fehlenden Test haben. In einer <a href=\"https://de.wikipedia.org/wiki/Kontinuierliche_Integration\">CI/CD-Pipeline</a> würde der Build nun scheitern und die Entwickler würden benachrichtigt werden.</p>\n<p><strong>Echter Code</strong><br>\nWir bauen einen kleinen Taschenrechner. Der Code soll unter nodeJS laufen und sieht aus wie folgt:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token comment\">// index.js</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">add</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sub</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">-</span> b<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    add<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    sub<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Der dazugehörige Test ist folgendermaßen aufgebaut:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token comment\">// index.spec.js</span></span><br><span class=\"highlight-line\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Mini-Calculator\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should add two numbers\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> sum <span class=\"token operator\">=</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should sub two numbers\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> diff <span class=\"token operator\">=</span> <span class=\"token function\">sub</span><span class=\"token punctuation\">(</span><span class=\"token number\">59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p><img src=\"/content/img/stenciljs-tutorial/jest-first-code.png\" alt=\"jest in console\" title=\"Erster Jest-Test\"><div class=\"has-text-right image-subline\">Bild 3: Sub und Add-Test</div></p>\n<p>Wie man sieht, rechnen die Funktionen wie sie sollen. Möchte man nun noch weitere Eck-Fälle testen würden man die Testblöcke kopieren, den Text und die Testdaten anpassen. Leider erhält man so sehr viel redundanten Code. Dazu hat Jest auch die richtige Lösung: <strong>it.each</strong>.</p>\n<pre class=\"language-js\"><code class=\"language-js\">test<span class=\"token punctuation\">.</span>each<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"><br><span class=\"highlight-line\">    summe | summand | expected</span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">8</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">    | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">9</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">9</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">    | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">11</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">3</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">10</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">   | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">13</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">4</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">11</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">   | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">14</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">5</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">12</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">   | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">17</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">6</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">13</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">   | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">19</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br><span class=\"highlight-line\">    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">7</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">  | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">14</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">   | </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">21</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"></span><br></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should add $summe to $summand\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> summe<span class=\"token punctuation\">,</span> summand<span class=\"token punctuation\">,</span> expected <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br><span class=\"highlight-line\">    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>summe<span class=\"token punctuation\">,</span> summand<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span>expected<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Der Code zeigt den schleifenartigen Aufbau. Man erspart sich viel Redundanz. &quot;summe&quot;, &quot;summand&quot; und &quot;expected&quot; definieren die Variablen. Diese müssen genauso heißen, wie im Tabellenkopf angegeben. Dann hat man im Test-Body zugriff auf die Werte und kann einen <em>expect</em>-Ausdruck darum bauen. In der Beschreibung werden die Werte über das <em>$</em>-Prefix referenziert. Führt man diesen Block nun aus, erhält man folgendes Bild:</p>\n<p><img src=\"/content/img/stenciljs-tutorial/it.each.png\" alt=\"it each\" title=\"Erster Jest-Test\"><div class=\"has-text-right image-subline\">Bild 4: each</div></p>\n<p>In der Konsole wird jeder Fall leserlich aufgelistet. Ich habe mich verzählt und einer der Fälle schlägt fehl. Ich kann die Testwerte ablesen und so meinen Code überprüfen. Außerdem wird mir die Dauer der Ausführung angezeigt. So könnte man auch versuchen die Performance zu verbessern.</p>\n<p>Dies war eine kleine und schnelle Einführung in Jest. Es kratzt nur an der Oberfläche der Möglichkeiten und Fähigkeiten dieses Frameworks. Wer es noch nie ausprobiert hat, sollte es jetzt tun. Zur Übung lade ich euch weitere Tests und weiteren Code zu schreiben. Es gibt noch einige Grundrechenarten zum Spielen. Ihr könntet die Multiplikation und Division dem Mini-Taschenrechner beibringen.</p>\n<p>Im nächsten Artikel nehme ich dann Bezug zu meinem StencilJS-Projekt.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial/tree/main/jest\">Github</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-08-14T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/address-app/",
      "url": "https://derkuba.de/content/posts/stenciljs/address-app/",
      "title": "StencilJS-Tutorial: das Adressbuch",
      "content_html": "<p>Die bisherigen Tutorials haben jetzt alle nötigen Bausteine von StencilJS vorgestellt, die wir für unsere Adressbuch-Applikation benötigen. In diesem Artikel werden die diese nun verwendet, um ein funktionierendes Adressbuch zu bauen<!-- endOfPreview -->:</p>\n<table>\n<thead>\n<tr>\n<th>Baustein</th>\n<th style=\"text-align:center\">Funktion</th>\n<th style=\"text-align:center\">Verwendung</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Router</td>\n<td style=\"text-align:center\">Steuert den Seitenverlauf und die Navigation</td>\n<td style=\"text-align:center\"><a href=\"https://derkuba.de/content/posts/stenciljs/routing/\">weiterleitung auf /, /contacts, /addresslist</a></td>\n</tr>\n<tr>\n<td>Class-Komponenten</td>\n<td style=\"text-align:center\">Aufbau, Struktur und Funktion einer Komponente</td>\n<td style=\"text-align:center\"><a href=\"https://derkuba.de/content/posts/stenciljs/erste-stencil-komponente/\">Visuelle Elemente mitsamt Interaktion: Input-Felder, Buttons, Seitenrahmen </a></td>\n</tr>\n<tr>\n<td>Functional-Komponenten</td>\n<td style=\"text-align:center\">Schlanke Alternative zur Class-Komponente</td>\n<td style=\"text-align:center\"><a href=\"https://derkuba.de/content/posts/stenciljs/functional-component/\">Beispielhafte Verwendung</a></td>\n</tr>\n<tr>\n<td>Store</td>\n<td style=\"text-align:center\">Applikationszustand</td>\n<td style=\"text-align:center\"><a href=\"https://derkuba.de/content/posts/stenciljs/stores/\">Datenaustausch zwischen den Komponenten</a></td>\n</tr>\n<tr>\n<td>Entwicklerwerkzeuge</td>\n<td style=\"text-align:center\">Einheitlicher Code mit Qualitätsanspruch</td>\n<td style=\"text-align:center\"><a href=\"https://derkuba.de/content/posts/stenciljs/entwicklerwerkzeuge/\">Kleine, aber feine Helfer</a></td>\n</tr>\n</tbody>\n</table>\n<p>Die Applikation ist aufgebaut wie im folgenden Bild beschrieben:<br>\n<img src=\"/content/img/stenciljs-tutorial/address-app.png\" alt=\"adress app\" title=\"das Addressbuch\"><div class=\"has-text-right image-subline\">Bild 1: Die Address-App</div><br>\nEs gibt 4 Routen, die auf 2 Komponenten zeigen. Die ersten beiden Routen (<strong>&quot;/&quot;</strong> und <strong>&quot;/address-list&quot;</strong>) zeigen auf die <em>kuba-home</em>-Komponente, die die Liste darstellt. Die nächsten beiden Routen (<strong>&quot;/contact&quot;</strong> und <strong>&quot;/contact/:id&quot;</strong>) zeigen auf die <em>kuba-address-form</em>-Komponente, die das Eingabeformular darstellt.</p>\n<h4 id=\"die-kontakt-liste\" tabindex=\"-1\">Die Kontakt-Liste <a class=\"direct-link\" href=\"#die-kontakt-liste\">#</a></h4>\n<p>Die grundlegende Funktion der Listenseite ist die Anzeige aller bestehenden Kontakte. Dafür ist diese Komponente an den Store angebunden, der diese Kontakte beinhaltet. Zusätzlich gibt es die Möglichkeit auf die Detailseite zu kommen. Es gibt eine &quot;Neu-Anlegen-Seitenleeres&quot; mitsamt leeren Formular und eine &quot;Editier-Seite&quot; mit vorausgefülltes Formular. Die Komponenten sind so geschachtelt, dass die <em>kuba-home</em>, die <em>kuba-list</em> inkludiert und diese wiederum, die <a href=\"https://derkuba.de/content/posts/stenciljs/tabellen-komponente/\"><em>kuba-table-options</em>-Komponente</a> verwendet.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-home.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-home\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-home.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaHome</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Kuba<span class=\"token operator\">-</span>Home<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>list<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>list<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Die KubaHome-Komponente dient als Hülle für die Liste. Man hat hier noch zusätzliche Platz für Texte oder zum Styling. Darauf habe ich aus Übersichtsgründen verzichtet.<br>\nDer interessante Teil ist die <em>kuba-list</em>-Komponente:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> addressStore <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../store/address-store\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-list\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-list.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaList</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">deleteContact</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> filteredArray <span class=\"token operator\">=</span> addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>id <span class=\"token operator\">!==</span> id</span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        addressStore<span class=\"token punctuation\">.</span>contacts <span class=\"token operator\">=</span> filteredArray<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>stencil<span class=\"token operator\">-</span>route<span class=\"token operator\">-</span>link url<span class=\"token operator\">=</span><span class=\"token string\">\"/contact\"</span> activeClass<span class=\"token operator\">=</span><span class=\"token string\">\"link-active\"</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    Neuer Kontakt</span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>stencil<span class=\"token operator\">-</span>route<span class=\"token operator\">-</span>link<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>hr <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options</span><br><span class=\"highlight-line\">                    <span class=\"token keyword\">delete</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>deleteContact<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                    key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"id\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"name\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"vorname\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"aktion\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token punctuation\">{</span>addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">                            <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                            <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">.</span>firstname<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                            <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">.</span>lastName<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                            <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>hr <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Herzstück der Komponente ist die <a href=\"https://derkuba.de/content/posts/stenciljs/tabellen-komponente/\">Tabellen-Komponte</a>. In den Zeilen 29-34 sieht man wie der Tabellenkopf definiert wird. Es werden 4 Zeilen deklariert (ID, Name, Vorname und Aktion). Das Aktionsfeld beinhaltet Operatoren für die Zeile ( Löschen und Editieren). Die Zeile 20-22 zeigen den Link auf die leere Formularseite.<br>\nDer Kopf der Tabellen-Komponente beinhaltet noch 2 Props. Das <em>delete</em>-Property ist ein Callback, das gefeuert wird, sobald man auf die Aktionstaste &quot;löschen&quot; klickt. Das Key-Property wird benötigt, damit StencilJS merkt, dass sich etwas geändert hat und ein Rerender ansteuert. Ohne das Key, müsste man vor- und zurücknavigieren, um ein rerender zu erzwingen. Die &quot;deleteContact&quot;-Funktion (Zeile 11-16) manipuliert das Store-Objekt und löscht anhand der übergebene ID den Kontakt aus dem Store-Listen-Objekt. Die Weiterleitung auf das Editier-Formular geschieht über die übergebene ID an Zeile.</p>\n<h4 id=\"das-adress-formular\" tabindex=\"-1\">Das Adress-Formular <a class=\"direct-link\" href=\"#das-adress-formular\">#</a></h4>\n<p>Die Adress-Komponente hat zwei Einstiegsmodi. Einmal mit übergebener ID und einmal ohne. In Abhängigkeit von dieser ID befinden wir uns auf der &quot;neue Kontakt&quot;-Seite oder auf der &quot;Editier-Seite&quot;. Damit eingehend haben wir zwei Grundfunktionen:</p>\n<ol>\n<li>Speichern der eingegebenen oder veränderten Daten</li>\n<li>Anzeigen bestehender Daten im Formular</li>\n</ol>\n<p><strong>1. Speichern der eingegebenen Daten:</strong><br>\nIn meinem Beispielprojekt verwende ich nur 3 Eingabefelder. Mehr Felder können mit etwas Copy&amp;Paste hinzugefügt werden. Für diese 3 Felder habe ich <em>States</em> angelegt:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\">  @<span class=\"token function\">State</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> addressState<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  @<span class=\"token function\">State</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> firstNameState<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  @<span class=\"token function\">State</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> lastNameState<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token comment\">// Zusatzfeld ID, das aber nicht angezeigt wird</span></span><br><span class=\"highlight-line\">  @<span class=\"token function\">State</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> idState<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die States finden sich im HTML wieder. Jedes Feld wird von einem Input repräsentiert. Die Input-Komponenten <a href=\"https://derkuba.de/content/posts/stenciljs/erste-stencil-komponente/\"><strong>kuba-input</strong></a> und <a href=\"https://derkuba.de/content/posts/stenciljs/functional-component/\"><strong>KubaInputFunctional</strong></a> wurden in den vorherigen Tutorials gebaut.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input</span><br><span class=\"highlight-line\">    componentId<span class=\"token operator\">=</span><span class=\"token string\">\"first-name\"</span></span><br><span class=\"highlight-line\">    label<span class=\"token operator\">=</span><span class=\"token string\">\"Vorname:\"</span></span><br><span class=\"highlight-line\">    onInputEvent<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onChangeFirstName<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input</span><br><span class=\"highlight-line\">    componentId<span class=\"token operator\">=</span><span class=\"token string\">\"last-name\"</span></span><br><span class=\"highlight-line\">    label<span class=\"token operator\">=</span><span class=\"token string\">\"Nachname:\"</span></span><br><span class=\"highlight-line\">    onInputEvent<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onChangeLastName<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>KubaInputFunctional</span><br><span class=\"highlight-line\">    componentId<span class=\"token operator\">=</span><span class=\"token string\">\"street\"</span></span><br><span class=\"highlight-line\">    label<span class=\"token operator\">=</span><span class=\"token string\">\"Adresse:\"</span></span><br><span class=\"highlight-line\">    value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    type<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    setter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onChangeAddress<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>KubaInputFunctional<span class=\"token operator\">></span></span></code></pre>\n<p>Die Attribute der Komponenten sind selbsterklärend. Die einzige Auffälligkeit ist der &quot;Setter&quot;, bzw. das &quot;onInputEvent&quot;. Ersteres ist ein Callback das reingereicht wird, das auf das <em>onInput</em>-Event des HTML-Inputs lauscht. Das &quot;onInputEvent&quot; widerum lauscht auf genau dieses Input-Event, das von der <em>kuba-input</em> gefeuert wird. Beide Funktionen werden bei jedem Tastenanschlag innerhalb des Inputs gefeuert.</p>\n<p>Die eingegebenen Daten müssen, damit sie in der Tabelle auf der ersten Seite angezeigt werden können, in das Store-Objekt geschrieben werden. Dies geschieht in den <em>setter-Funktionen</em>:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// am Anfang der Datei</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> addressStore <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../store/address-store\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// innerhalb der Klasse</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// setzen des Vornamens</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onChangeFirstName</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// setzen des Nachnamens</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onChangeLastName</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// setzen der Adresse</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onChangeAddress</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    value<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wie man oben sieht wird einfach der bestehende Wert durch den neuen Wert überschrieben.</p>\n<p><strong>Werte speichern</strong><br>\nEs existiert ein klassischer Speichern-Button, der <em>onClick</em> eine Funktion ausführt:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button handleSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>speichern<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span></span></code></pre>\n<p>Diese <em>onSubmit</em>-Funktion teilt sich in zwei Teile. Wie oben beschrieben in <em>Neu</em> und <em>Editieren</em>.<br>\nWenn man einen neuen Kontakt anlegt, brauchen wir zum eindeutigen Zuweisen eine ID. Dafür habe ich mir eine Funktion ausgeliehen, die wir als Blackbox-Funktion behandeln (Aufbau und Funktionalität interessieren uns nicht - sie tut was sie soll). Sie wird aufgerufen und gibt uns eine eindeutige Id.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// erzeuge eindeutige ID</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> uuid <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">create_UUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// füge die Inhalte der einzelnen States in ein Objekt.</span></span><br><span class=\"highlight-line\">addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    firstname<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    lastName<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    id<span class=\"token operator\">:</span> uuid<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    address<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// StencilJS triggert ein Neurendern nur bei neuen Objekten</span></span><br><span class=\"highlight-line\">addressStore<span class=\"token punctuation\">.</span>contacts <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wie der obige Code zeigt, holen wir uns eine ID und fügen anschließend dem Array aus dem Store ein weiteres Objekt hinzu. Die Zeile 13 ist dabei noch interessant. Der Kommentar beschreibt den Grund. Der Store von Stenciljs bekommt die Änderung zwar mit, aber das Framework triggert keinen Rerender. Daher wird eine neue Referenz in <em>addressStore.contacts</em> hinterlegt, bzw. eine Kopie des bestehenden Arrays. Wenn wir nun zurück klicken würden, würden wir einen neuen Antrag in der Tabelle sehen.</p>\n<p><strong>Anzeigen und editieren bestehender Daten:</strong><br>\nFür die Anzeige und editieren bestehender Daten müssen wir aus der URL den Parameter auslesen. Dabei hilft uns die Router-API. Mithilfe von der Property match vom Typ <em>MatchResults</em>.</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token comment\">// Klassenproperty</span></span><br><span class=\"highlight-line\">@<span class=\"token function\">Prop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> match<span class=\"token operator\">:</span> MatchResults<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Aufruf des Parameters aus dem Pattern /contacts/:id</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id</span></code></pre>\n<p>Dies brauchen wir im zweiten Teil der <em>onSubmit</em>-Funktion<br>\nWenn in der <em><a href=\"http://this.match.params.id\">this.match.params.id</a></em> eine ID vorhanden ist, befinden wir uns im Editier-Modus und gehen davon aus, dass der Store bereits einen Eintrag mit genau dieser ID enthält. Wir müssen nun an die Stelle im Array iterieren und die Werte ersetzen:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>contact<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>contact<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">...</span>addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            firstname<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            lastName<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            address<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Gehen wir nun wieder zurück und schauen in die Tabelle. Haben wir andere Werte im Formular eingetippt, spiegelt sich dies nun wieder.</p>\n<p>Für eine bessere Übersicht zeige ich im folgenden die gesamte Funktion:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">  <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onSubmit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">const</span> uuid <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">create_UUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        firstname<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        lastName<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        id<span class=\"token operator\">:</span> uuid<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        address<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      addressStore<span class=\"token punctuation\">.</span>contacts <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>idState <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>contact<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>contact<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">          addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">...</span>addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            firstname<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            lastName<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            address<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Ich habe die Zeilen 13-16 in der obigen Beschreibung ausgelassen. In diesen Zeilen lösche ich die Eingabe nach dem Speichern. Sodass man direkt weiter neue Kontakte hinzufügen kann.</p>\n<p>Für das Anzeigen bestehender Daten verwende ich die StencilJS-Lifecycle Methode <em>connectedCallback</em>. Diese wird genau einmal aufgerufen, beim Initiieren der Klasse. Der Router kümmert sich um das Erzeugen und Abräumen der Klasse und es ist eine geeignete Stelle, um die Daten aus dem Store zu laden und die dazugehörigen States zu setzen. Die Bedingung für das Setzen ist das Vorhandensein der ID in der URL :</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">  <span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    addressStore<span class=\"token punctuation\">.</span>contacts<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>addressState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstNameState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>firstname<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastNameState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>lastName<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>idState <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span></code></pre>\n<p>Fertig ist die erste kleine Applikation, die die Anforderungen aus der Einleitung erfüllt. Sie verwendet alle gelernten Bausteine und funktioniert wie gefordert. Natürlich hat sie einige unschöne Abläufe:</p>\n<ul>\n<li>beim Laden der Seite verschwinden alle Daten</li>\n<li>kein Nutzerfeedback, dass etwas gespeichert wurde.</li>\n<li>kein einziger Unit-Test</li>\n<li>allgemein nicht gestyled</li>\n</ul>\n<p>An diesen Macken wollen wir noch arbeiten und das in den kommenden Artikeln.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial/releases/tag/1.0.3\">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 1.0.3 auschecken:</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-08-05T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/functional-component/",
      "url": "https://derkuba.de/content/posts/stenciljs/functional-component/",
      "title": "StencilJS-Tutorial: Functional Component",
      "content_html": "<p>Die <em>functional component</em> oder <em>stateless component</em> stellt eine alternative Schreibweise für die StencilJS-Komponente dar. Die Komponente ist dadurch leichtgewichtiger. Aber man verzichtet auch an etwas Funktionalität. <!-- endOfPreview --> Ich habe aus meinem Adressbuch-Projekt die <em>kuba-input.tsx</em> in eine <em>functional component</em> übertragen:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-input-functiona.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> KubaInputFunctional <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    componentId<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    label<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    type <span class=\"token operator\">=</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    value<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    componentId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    label<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    type<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"number\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onInput</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        event<span class=\"token punctuation\">.</span>document<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token keyword\">new</span> <span class=\"token class-name\">CustomEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"inputEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">                detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-input<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">htmlFor</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>componentId<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span></span><br><span class=\"highlight-line\">                <span class=\"token attr-name\">type</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">}</span></span></span><br><span class=\"highlight-line\">                <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>componentId<span class=\"token punctuation\">}</span></span></span><br><span class=\"highlight-line\">                <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span></span></span><br><span class=\"highlight-line\">                <span class=\"token attr-name\">onInput</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>onInput<span class=\"token punctuation\">}</span></span></span><br><span class=\"highlight-line\">            <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span><br>        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Wie man sieht ist es keine Klasse, sondern ein Funktionsaufruf. Die Properties werden als Parameter übergeben. Die Methoden können als const variablen definiert und dann übergeben werden und sie gibt ein TSX-Element zurück.</p>\n<p>Die Komponente kann über folgende Zeilen eingebunden werden:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token comment\">// jede beliebige andere tsx-Datei</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> KubaInputFunctional <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../kuba-input/kuba-input-functional\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">KubaInputFunctional</span></span><br><span class=\"highlight-line\">    <span class=\"token attr-name\">componentId</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>street<span class=\"token punctuation\">\"</span></span></span><br><span class=\"highlight-line\">    <span class=\"token attr-name\">label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Straße:<span class=\"token punctuation\">\"</span></span></span><br><span class=\"highlight-line\">    <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"Musterstreet\"</span><span class=\"token punctuation\">}</span></span></span><br><span class=\"highlight-line\">    <span class=\"token attr-name\">type</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">}</span></span></span><br><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">KubaInputFunctional</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span></code></pre>\n<p>Der Aufruf erfolgt über den Funktionsnamen und agiert dann wie eine gewöhnliche Komponente.</p>\n<p>Ich habe die wesentlichen Unterschiede in eine Tabelle gepackt und werde diese im Anschluss einzeln nochmal erklären:</p>\n<table>\n<thead>\n<tr>\n<th>Class Component</th>\n<th style=\"text-align:center\">Functional Component</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Schwergewichtig</td>\n<td style=\"text-align:center\">leichtgewichtig</td>\n</tr>\n<tr>\n<td>lifecycles</td>\n<td style=\"text-align:center\">keine lifecycles</td>\n</tr>\n<tr>\n<td>State</td>\n<td style=\"text-align:center\">Stateless</td>\n</tr>\n<tr>\n<td>Aufruf über Annotation steuerbar</td>\n<td style=\"text-align:center\">Aufruf über Funktionsnamen</td>\n</tr>\n<tr>\n<td>Können schnell Komplex werden</td>\n<td style=\"text-align:center\">Sollten einfach gehalten werden, sonst weiter aufspalte</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">leicht zu testen</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"leichtgewichtig\" tabindex=\"-1\">Leichtgewichtig <a class=\"direct-link\" href=\"#leichtgewichtig\">#</a></h4>\n<p>Es wird keine Klasse und auch keine Annotation benötigt. Daher ist weniger Schreibaufwand nötig. Das Ziel ist sehr kleine Funktionen zu schreiben. Zuviel Code ist ein Indikator dafür, dass die Funktion weiter aufgespalten werden sollte.</p>\n<h4 id=\"stateless\" tabindex=\"-1\">Stateless <a class=\"direct-link\" href=\"#stateless\">#</a></h4>\n<p>So hat die <em>stateless component</em> keinen eigenen State und muss über die Elternkomponente gesteuert werden. Das wiederum erleichtert die Umsetzung des Container-Pattern.</p>\n<p>( Kleiner Exkurs: Das Container-Pattern habe ich bei der React-Entwicklung kennengelernt. Es beschreibt die Trennung innerhalb von Komponenten in Aussehen und Verhalten. Die Elternkomponente besitzt den State, macht die Datentransformation und gibt alle nötigen Props an das Kind weiter. Das Kindelement hat keinen eigenen State und bekommt den Zustand über seine Props mitgeteilt.)</p>\n<h4 id=\"keine-lifecyle-methoden\" tabindex=\"-1\">Keine Lifecyle-Methoden <a class=\"direct-link\" href=\"#keine-lifecyle-methoden\">#</a></h4>\n<p>Man hat keinen Zugriff auf die <a href=\"https://stenciljs.com/docs/component-lifecycle\">Lifecyle-Methoden</a>. Das sorgt zusätzlich dafür, dass die Komponenten nicht zu komplex werden.</p>\n<h3 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h3>\n<p>Ich benutze gerne und häufig diese Art der Komponenten. Sie sind schnell zu schreiben, leicht zu verstehen und auch einfach zu testen (Das Thema testen wird ausgiebig in einem späteren Artikel behandelt). Der Einsatz ist jederzeit zu empfehlen.</p>\n<p><br>\nDas Codebeispiel findet ihr auf <a href=\"https://github.com/derKuba/stenciljs-tutorial/blob/main/address-book/src/components/kuba-input/kuba-input-functional.tsx\">Github/derKuba</a>.</p>\n<p><br>\nIhr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-07-24T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/stores/",
      "url": "https://derkuba.de/content/posts/stenciljs/stores/",
      "title": "StencilJS-Tutorial: Store",
      "content_html": "<p>Der <a href=\"https://stenciljs.com/docs/stencil-store\">StencilJS-Store</a> ist eine tolle Sache. Dabei handelt sich um einen sehr leichtgewichtigen State-Container ähnlich zu <a href=\"https://redux.js.org/\">Redux</a>, <a href=\"https://github.com/redux-zero/redux-zero\">Redux-Zero</a> oder dem guten alten <a href=\"https://docs.angularjs.org/api/ng/service/$rootScope\">$rootScope in AngularJS</a>. <!-- endOfPreview -->Die Idee hinter diesen Containern basiert auf der Weitergabe von Daten. Ohne einen Store können Daten nur über die Properties übergeben werden. Das kann dazu führen, dass man im schlimmsten Fall den gesamten Hierarchie-Baum der Komponenten hindurchlaufen muss. (Man könnte an der Stelle noch sagen, dass man Daten über Events übergeben könnte. Diese Modell hat sich aber nicht bewährt.)</p>\n<p>Man nehme folgende Situation:</p>\n<p>Komponente A hat einen Counter und möchte das Ergebnis an ein Kindelement übergeben, das 4 Ebenen tief verwurzelt ist:</p>\n<p>Komponente A<br>\n-&gt; Komponente B<br>\n---&gt; Komponente D<br>\n-----&gt; Komponente E</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-a\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">A</span></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    @<span class=\"token function\">State</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> count<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-b</span> <span class=\"token attr-name\">counter</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-b\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">B</span></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    @<span class=\"token function\">Prop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> counter<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-c</span> <span class=\"token attr-name\">counter</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-c\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">C</span></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    @<span class=\"token function\">Prop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> counter<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-d</span> <span class=\"token attr-name\">counter</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-d\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">D</span></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    @<span class=\"token function\">Prop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> counter<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br>            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Man spricht von Prop-Drilling. Die Daten kommen an, aber alle &quot;Zwischen-Komponenten&quot; (zwischen A und E) müssten das Property <em>counter</em> ebenfalls implementieren. Hier kommt der Store ins Spiel. Ich werde ihn in das Adressbuch integrieren und einen Anwendungsfall skizzieren. Konkret möchte ich die Eingaben des Formulars in den Store ablegen und dann die Liste, bzw. die Tabelle daraus abrufen.</p>\n<h4 id=\"integration\" tabindex=\"-1\">Integration <a class=\"direct-link\" href=\"#integration\">#</a></h4>\n<p>Zuerst muss der Store installiert werden:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> @stencil/store --save-dev</span></code></pre>\n<p>Dann erstellen wir eine store Datei:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// myState.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/store\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// hier gibts die Möglichkeit für etwas Typsicherheit.</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">myStore</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    counter<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Definition und Vorbelegung mit Default-Werten</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> myStore<span class=\"token operator\">:</span> myStore <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    counter<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Übergabe an den Store</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">,</span> on<span class=\"token punctuation\">,</span> onChange<span class=\"token punctuation\">,</span> get<span class=\"token punctuation\">,</span> set<span class=\"token punctuation\">,</span> use <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>myStore<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// const  { state } = createStore(myStore); // reicht völlig aus</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> state<span class=\"token punctuation\">;</span></span></code></pre>\n<p>Im Gegensatz zur Dokumentation übergebe ich der Funktion <em>createStore</em> nicht direkt das Objekt, sondern definiere es darüber. Zur besseren Anschauung habe ich den dazugehörigen Type drübergeschrieben. Das Ermöglicht deiner IDE die Autovervollständigung und sorgt dafür, dass keine falschen Werte übergeben werden. Die Zeile 14 zeigt die weiteren Funktionen des Stores.</p>\n<table>\n<thead>\n<tr>\n<th>Funktion</th>\n<th style=\"text-align:center\">Parameter / aufruf</th>\n<th style=\"text-align:center\">Bedeutung</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>state</td>\n<td style=\"text-align:center\">state.counter</td>\n<td style=\"text-align:center\">Das Store-Objekt, in dem sich die übergreifenden Daten befinden</td>\n</tr>\n<tr>\n<td>on</td>\n<td style=\"text-align:center\">on(EventName, callback) - on(&quot;set&quot;, ()=&gt;{}))</td>\n<td style=\"text-align:center\">Watcher-Funktion, die auf get, set und reset des Stores lauscht</td>\n</tr>\n<tr>\n<td>onChange</td>\n<td style=\"text-align:center\">onChange(property, callback) - on(&quot;counter&quot;, ()=&gt;{}))</td>\n<td style=\"text-align:center\">Führt ein zu übergebendes Callback aus, sobald sich ein Wert im Store ändert.</td>\n</tr>\n<tr>\n<td>get</td>\n<td style=\"text-align:center\">get(property) - get(&quot;counter&quot;)</td>\n<td style=\"text-align:center\">Gibt den Wert für das Property zurück</td>\n</tr>\n<tr>\n<td>set</td>\n<td style=\"text-align:center\">set(property, value) - set(&quot;counter&quot;, 5)</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td>use</td>\n<td style=\"text-align:center\">use(...subscription)</td>\n<td style=\"text-align:center\">Eine <em>subscription</em> ist ein oder mehrere Objekte, die get, set und reset implementiert haben</td>\n</tr>\n</tbody>\n</table>\n<p>Das Store-Objekt verhält sich jetzt wie jedes andere Objekt, das aus einer Datei exportiert wird. Der einzige Unterschied ist, dass es den Applikationsscope mit sich trägt. Um beim obigen Beispiel zu bleiben mit den Klassen A,B,C,D würde der State wie folgt übergeben:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// a.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> myState <span class=\"token keyword\">from</span> <span class=\"token string\">\"./myState\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-a\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">A</span></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function-variable function\">inc</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        myState<span class=\"token punctuation\">.</span>counter<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inc<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Hochzählen<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>b counter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>myState<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// d.ts</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> myState <span class=\"token keyword\">from</span> <span class=\"token string\">\"./myState\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-d\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">D</span></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>myState<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Wie man sieht, ist das Durchreichen als Property nicht mehr möglich. Die Datenweitergabe ist keine Hierarchy mehr, sondern man könnte sie als Bus sehen, der neben den Komponenten herfährt und bei Bedarf hält. Ein Veränderung des States führt zum Rerendering der betreffenden (den Store importierenden) Komponenten.<br>\nEin kleiner Pitfall beim setzen des States, war dass bei komplexeren Datenstrukturen es nicht reicht den Wert zu setzen, sondern das gesamte Objekt zu überschreiben:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> myState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    a<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        b<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        c<span class=\"token operator\">:</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    e<span class=\"token operator\">:</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">myState<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token number\">25</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// führt zu keinem Rerender</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">mystate<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// führt rerender aus</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span>myState<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Ich möchte den neuen State nicht missen. Zu Beginn von Stenciljs gab es noch einen Statetunnel, der in jede Komponente injiziert werden musste:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// stateProvider</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createProviderConsumer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/state-tunnel\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">State</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    counter<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token generic-function\"><span class=\"token function\">createProviderConsumer</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>State<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span> <span class=\"token comment\">// eslint-disable-line @stencil/ban-side-effects</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        counter<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">(</span>subscribe<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>context<span class=\"token operator\">-</span>consumer subscribe<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>subscribe<span class=\"token punctuation\">}</span> renderer<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>child<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// sehr verkürzte Darstellung</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\"><span class=\"token constant\">A</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">Tunnel<span class=\"token punctuation\">.</span><span class=\"token function\">injectProps</span><span class=\"token punctuation\">(</span><span class=\"token constant\">A</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"counter\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die Weiterentwicklung sieht komfortabler aus, ist sehr performant, sehr leichtgewichtig und echt leicht zu bedienen. Ich habe diesen Store in all meinen StencilJS-Projekten im Einsatz.</p>\n<p><br>\nIhr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-07-17T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/routing/",
      "url": "https://derkuba.de/content/posts/stenciljs/routing/",
      "title": "StencilJS-Tutorial: Routing",
      "content_html": "<p>Wir können eigene Komponenten erstellen und haben dazu das StencilJS-Starter-Projekt genutzt. Nun wollen wir etwas aufräumen und uns um das Thema Routing kümmern.  <!-- endOfPreview -->Das Starter-Projekt nutzt für dieses Thema den <em>ionic-team/stencil-router</em>. Hierbei handelt es sich um ein offizielles Release der Entwickler hinter StencilJS. Aber ich bitte um <em>VORSICHT</em>. Das Thema Routing wird vom Ionic-Team sehr stiefmütterlich behandelt und nicht aktiv weiterentwickelt. (Die letzten Commits)[<a href=\"https://github.com/ionic-team/stencil-router\">https://github.com/ionic-team/stencil-router</a>] liegen Jahre zurück. Es gibt auch ein weiteres (experimentelles Release <em>stencil-router-v2</em>)[<a href=\"https://github.com/ionic-team/stencil-router-v2\">https://github.com/ionic-team/stencil-router-v2</a>], aber auch das wird nicht aktiv gepflegt.<br>\nBeide Router verfügen über die Grundfunktionalität. Wenn etwas darüber hinaus benötigt wird, muss es selber hinzugefügt oder von Grund auf neu entwickelt werden. Für unsere Zwecke reicht die erste Variante.</p>\n<p>Die bisherige Navigationsstruktur sah aus wie folgt:</p>\n<p>app-root.tsx // beinhaltet den router<br>\n-&gt; app-home.tsx // route für &quot;/&quot;<br>\n-&gt; app-profil.tsx // route für /profil</p>\n<p>Da wir ein eigenes Namespace nutzen, habe ich diese zwei Route samt dazugehörigen Ordner gelöscht. Über den &quot;generate&quot; Befehl ( <em>npm run generate ....</em>) lege ich mir neue Komponenten samt Ordner an:</p>\n<ul>\n<li>kuba-home</li>\n<li>kuba-list</li>\n</ul>\n<p>Diese müssen nun angesteuert werden können. In der <em>app-route.tsx</em> liegt die Konfiguration dafür vor und sieht aus wie folgt:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token comment\">// render()</span></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-router</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route-switch</span> <span class=\"token attr-name\">scrollTopOffset</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-home<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">exact</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/address-list<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-home<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">exact</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/contact/:id<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-address-form<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/contact<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-address-form<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>stencil-route-switch</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>stencil-router</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>Der <em>stencil-router</em> bekommt eine <em>stencil-route-switch</em> Komponente übergeben. Diese wiederum hat die Routen als Komponenten im Bauch.<br>\nDie Stencil-Route hat folgende Konfigurationsmöglichkeiten:</p>\n<table>\n<thead>\n<tr>\n<th>Konfiguration</th>\n<th style=\"text-align:center\">Are</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>url</td>\n<td style=\"text-align:center\">Beschreibung der route, zb. &quot;/meine-route/:23&quot;</td>\n</tr>\n<tr>\n<td>component</td>\n<td style=\"text-align:center\">welche Komponente soll angezeigt werden</td>\n</tr>\n<tr>\n<td>componentProps</td>\n<td style=\"text-align:center\">Mögliche Übergabe von Parametern für die angegebene Komponente</td>\n</tr>\n<tr>\n<td>exact</td>\n<td style=\"text-align:center\">die URL soll exakt der Angabe gleichen</td>\n</tr>\n<tr>\n<td>routeRender</td>\n<td style=\"text-align:center\">Alternative für component. Direkter Aufruf von Render.</td>\n</tr>\n</tbody>\n</table>\n<p>Wie wir in der Tabelle ablesen können, haben wir damit zwei Möglichkeiten der Route mitzuteilen was gerendert werden soll.</p>\n<p>Nehmen wir einmal die <em>kuba-home.tsx</em>:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-home\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-home.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaHome</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Host</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Kuba-Home</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-list</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-list</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br>            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Host</span></span><span class=\"token punctuation\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Um diese anzusteuern brauchen wir die Route:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-home<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">exact</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\"> <span class=\"token comment\">// oder</span></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">exact</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">routeRender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> string<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> any<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br>        <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Kuba-Home</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br><span class=\"highlight-line\">                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-list</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-list</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><br>            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br>  <span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre>\n<p>Die zweite Möglichkeit finde ich etwas unschön. Aber ich wollte sie trotzdem aufzeigen.</p>\n<p>In der Kuba-Home-Komponente befindet sich die Kuba-List. In dieser wird die Tabellen-Komponente integriert. Es gibt einen Link um einen neuen Kontakt hinzuzufügen und man soll über einen &quot;Editier-Button&quot; in der Tabelle auf ein vorausgefülltes Formular weitergeleitet werden.</p>\n<p>Dieses Routing ermöglichen wir über diese Konfiguration. Wir nutzen die bestehende Komponente <em>kuba-address-form</em>, die das Formular beinhalten wird und die zwei Routen</p>\n<ul>\n<li>/contact -&gt; für das Anlegen eines neuen Kontakts</li>\n<li>/contact/:id -&gt; für die Detailansicht und editieren eines bestehenden Kontakts</li>\n</ul>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/contact/:id<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-address-form<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/contact<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kuba-address-form<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span></code></pre>\n<p>Beim Aufruf der Anwendung wird immer die Kuba-Home-Komponente aufgerufen. Um jetzt eine Weiterleitung auf die weiteren Routen zu ermöglichen benötigen wir eine Verlinkung.</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route-link</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/contact<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">activeClass</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>link-active<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">    Neu</span><br></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>stencil-route-link</span><span class=\"token punctuation\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route-link</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/contact/23<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">activeClass</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>link-active<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">    Editieren</span><br></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>stencil-route-link</span><span class=\"token punctuation\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stencil-route-link</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">activeClass</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>link-active<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"><br><span class=\"highlight-line\">    Zurück</span><br></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>stencil-route-link</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>Mit diesen drei Links können wir nun vor- und zurücknavigieren.</p>\n<p>Jetzt fehlt nur noch die Möglichkeit an die ID aus dem Editierlink zu kommen. Diese ID wird benötigt, um die richtigen Daten des Kontaktes abzufragen.</p>\n<p>Um an die URL-Parameter zu gelangen, muss der Component-Klasse das Property <em>match</em> vom Typ MatchResults hinzugefügt werden:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MatchResults <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/router\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"> @<span class=\"token function\">Prop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> match<span class=\"token operator\">:</span> MatchResults<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span></code></pre>\n<p>Wenn man dieses Property in der Klasse hat, werden die URL-Parameter in diese Variabel injiziert. Wenn die Route Daten übergeben bekommen hat, erhält man nun Zugriff darauf:</p>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"highlight-line\"><span class=\"token comment\">// /route/:id</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// /route/:hello</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>hello<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// /route/:datensatz</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>datensatz<span class=\"token punctuation\">;</span></span></code></pre>\n<p>Weitere Möglichkeiten zum Übertragen von Daten oder Suchparameter findet ihr hier:</p>\n<p><a href=\"https://github.com/ionic-team/stencil-router/wiki/Passing-data-to-routes\">https://github.com/ionic-team/stencil-router/wiki/Passing-data-to-routes</a></p>\n<p>Mit dem neuen Wissen haben wir jetzt eine navigierbare Seite. Diese Seiten haben zudem die Möglichkeit Daten auszutauschen. In den nächsten Schritten wird das Formular durch weitere Felder ergänzt, die Möglichkeit geschaffen die eingegebenen Daten in einen globalen Scope zu schreiben, die Applikation getestet und ein kleines Backend ergänzt.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 1.0.2 auschecken:</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-07-10T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/tabellen-komponente/",
      "url": "https://derkuba.de/content/posts/stenciljs/tabellen-komponente/",
      "title": "StencilJS-Tutorial: Tabellen-Komponente",
      "content_html": "<p>Das Wissen um die Erstellung einer neuen Komponente wollen wir nun nutzen, um eine Tabelle umzusetzen. Wenn man sich die <a href=\"https://derkuba.de/content/posts/stenciljs/introduction/\">Scribbles</a> anschaut, erkennt man sofort die Notwendigkeit einer Tabelle. Wir ignorieren an dieser Stelle, dass man es auch ohne HTML-Tabellen-Element umsetzen könnte. Schließlich wollen wir was lernen :-)  <!-- endOfPreview --></p>\n<p>Als Vorlage nehme ich das HTML-Tag <em>table</em>, entscheide mich für die Variante mit getrennten Kopf und Körper und bediene mich aus der <a href=\"https://www.w3schools.com\">W3C-School</a>:</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"highlight-line\"><span class=\"token comment\">&lt;!-- https://www.w3schools.com/tags/tag_thead.asp --></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>thead</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>id<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>Name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>Vorname<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>thead</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tbody</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Max<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Mustermann<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Maxine<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Mustermann<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tbody</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span></span></code></pre>\n<p>Diese Struktur muss nun in eine Web-Component gepresst werden. Die große Herausforderung ist die Datenübergabe. Wie bekommt man zum Teil große Datenmengen in diese Struktur, bzw. an die Komponente übergeben? Ich habe zur Veranschaulichung drei Vorschläge erarbeitet. Jede hat seine Vor- und Nachteile und man sollte individuell je nach Art des Projektes entscheiden.</p>\n<ol>\n<li>Datenübergabe der HTML-Struktur in Slots</li>\n<li>Datenübergabe über HTML-Attribute</li>\n<li>Datenübergabe über das HTML-Tag <em>option</em></li>\n</ol>\n<p>Ich werde zunächst den Aufruf, sowie die Übergabe der Komponente beschreiben und dann im nächsten Schritt die Implementierung.</p>\n<h4 id=\"1.-html-als-kindelemente-an-die-komponente-%C3%BCbergeben%3A\" tabindex=\"-1\">1. HTML als Kindelemente an die Komponente übergeben: <a class=\"direct-link\" href=\"#1.-html-als-kindelemente-an-die-komponente-%C3%BCbergeben%3A\">#</a></h4>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-table-slot</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">slot</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>table-head<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>id<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>Name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span><span class=\"token punctuation\">></span></span>Vorname<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Max<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Muster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Maxine<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Muster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Momo<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Muster<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-table-slot</span><span class=\"token punctuation\">></span></span></span></code></pre>\n<p>Wie man sieht existiert eine Komponente <em>kuba-table-slot</em>. Diese bekommt die Titel der Spalten im tr-tag mit dem Zusatz <em>slot=&quot;table-head&quot;</em> übergeben. Die dazugehörigen Daten werden in der bekannten HTML-Struktur übergeben.</p>\n<h4 id=\"2.-daten%C3%BCbergabe-%C3%BCber-html-attribute%3A\" tabindex=\"-1\">2. Datenübergabe über HTML-Attribute: <a class=\"direct-link\" href=\"#2.-daten%C3%BCbergabe-%C3%BCber-html-attribute%3A\">#</a></h4>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-table-attributes</span> <span class=\"token attr-name\">head</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{head}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">body</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{body}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span></code></pre>\n<p>Die Komponente <em>kuba-table-attributes</em> hat 2 Properties, bzw. 2 Attribute &quot;head&quot; und &quot;body&quot; und bekommt die Werte als Javascript Array übergeben.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> head <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Vorname\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> body <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">[</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Max\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">[</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Maxine\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">[</span><span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Momo\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Muster\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span></code></pre>\n<h4 id=\"3.-daten%C3%BCbergabe-%C3%BCber-das-html-tag-option\" tabindex=\"-1\">3. Datenübergabe über das HTML-Tag <em>option</em> <a class=\"direct-link\" href=\"#3.-daten%C3%BCbergabe-%C3%BCber-das-html-tag-option\">#</a></h4>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-table-options</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-table-options-head</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>id<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>vorname<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-table-options-head</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>kuba-table-options-body</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Max<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Muster<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Maxine<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Muster<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Max<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Muster<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-table-options-body</span><span class=\"token punctuation\">></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>kuba-table-options</span><span class=\"token punctuation\">></span></span></span></code></pre>\n<p>Die Komponente <em>kuba-table-options</em> hat 2 Kind-Komponenten. Diese nenne ich mal Pseudo-Komponenten, da diese nicht als Klassen bestehen, sondern nur zur Unterscheidung der Daten für Titel und Inhalt dienen. Diese wiederum haben <em>option</em>-Elemente als Kindelement. Das Option-Tag ist nur den HTML-Tags <em>select</em>, <em>optgroup</em> oder <em>datalist</em> vorbehalten. Wir wollen es aber gar nicht rendern, sondern nutzen es als gültiges HTML-Element zum Datentransport.</p>\n<h2 id=\"implementierung\" tabindex=\"-1\">Implementierung <a class=\"direct-link\" href=\"#implementierung\">#</a></h2>\n<p><img src=\"/content/img/stenciljs-tutorial/table-component.png\" alt=\"Tabellenkomponente\" title=\"Tabellenkomponente\"><div class=\"has-text-right image-subline\">Bild 1: Gerenderte Tabellen-Komponenten</div></p>\n<h4 id=\"1.-slots\" tabindex=\"-1\">1. Slots <a class=\"direct-link\" href=\"#1.-slots\">#</a></h4>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-table-slot.tsx</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-table-slot\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-table-slot.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaTableSlot</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>table<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>thead<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>slot name<span class=\"token operator\">=</span><span class=\"token string\">\"table-head\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>thead<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>tbody<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>slot <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tbody<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>table<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Diese Komponente gleicht <a href=\"https://derkuba.de/content/posts/stenciljs/erste-stencil-komponente/\">der allerersten Komponente</a>. Der einzige Unterschied sind die Slot-Tags. Einmal handelt es sich um einen benannten Slot (Zeile 15), und den Standard-Slot (Zeile 18).</p>\n<table>\n<thead>\n<tr>\n<th>Vor-</th>\n<th style=\"text-align:center\">Nachteile</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>leichte Implementierung</td>\n<td style=\"text-align:center\">Tabellenkomponente macht nicht wirklich Sinn</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">das CSS der Tabellenkomponente greift nicht auf die durchgereichten Elemente</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">Logik ausserhalb der Tabellen-Komponente</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"2.-attribute\" tabindex=\"-1\">2. Attribute <a class=\"direct-link\" href=\"#2.-attribute\">#</a></h4>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> Prop <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-table-attributes\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-table-attributes.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaTableAttributes</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> head<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> body<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>table<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>thead<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                            <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span></span><br><span class=\"highlight-line\">                                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>th<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>th<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>thead<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>tbody<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span></span><br><span class=\"highlight-line\">                            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">                                <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                                    <span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">                                        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>cell<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tbody<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>table<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Die Besonderheit dieser Variante ist, dass die Daten über die Properties hereingereicht werden (Zeilen 10+11). Mit Hilfe dieser zwei Properties werden in den Zeilen 19-21 und 25-29 die HTML-Tabellenstruktur erstellt. Für den Head sind die Daten ein eindimensionales Array. Es wird per Schleife durchlaufen und es wird der Titel in die &quot;th&quot;-Tags gewrappt. Der zweite Teil hat eine aufwendigere Datenstruktur. Hierbei handelt es sich um ein zweidimensionales Array. Dieses wird durch eine verschachtelte Schleife durchlaufen. Die erste Ebene entspricht der Reihe und die zweite Ebene dem Inhalt der Spalte.</p>\n<table>\n<thead>\n<tr>\n<th>Vor-</th>\n<th style=\"text-align:center\">Nachteile</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>leichte Implementierung</td>\n<td style=\"text-align:center\">Konfiguration programmatisch über TS/JS</td>\n</tr>\n<tr>\n<td>übersichtliche Komponente</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td>CSS gekapselt</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"3.-option-tag\" tabindex=\"-1\">3. Option Tag <a class=\"direct-link\" href=\"#3.-option-tag\">#</a></h4>\n<p>Wie bereits geschrieben, wird das Option Tag als gültiges HTML-Tag zum Transport von Daten &quot;missbraucht&quot;. Aber da es nicht gerendert werden soll, stört es mich nicht. Wie man die Daten übergibt, kann man weiter oben sehen.<br>\nDie Implementierung besteht aus drei wesentlichen Teilen.</p>\n<ol>\n<li>StencilJS &quot;Element&quot;</li>\n<li>StencilJS Lifecycle Methode &quot;connectedCallback&quot;</li>\n<li>Render Methode</li>\n</ol>\n<p>Die Klasse <em>KubaTableOptions</em> hat drei Klassenattribute. Das besagte StencilJS Element entspricht dem HTML Knoten, bzw. dem Output von document.querySelector(&quot;kuba-table-options&quot;). Jede StencilJS-Component darf genau eins dieser Attribute besitzen. Die zwei weiteren Klassenattribute sind Arrays, in denen man sich den Inhalt des Tabellenkopfes und des Tabellenbodys merkt.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\">  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Element</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> $el<span class=\"token operator\">:</span> HTMLKubaTableOptionsElement<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">private</span> headItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">private</span> bodyItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die <em>connectedCallback</em> ist eine <a href=\"https://stenciljs.com/docs/component-lifecycle\">LifeCycle-Methode</a>, die genau einmal nach der Initialisierung der Klasse aufgerufen wird. Diesen Moment nutzen wir, um die übergeben Optionstags abzufragen und umzuwandeln. Ich habe die Inhalte für Kopf und Körper jeweils in ein eigenes PseudoTag (Pseudo, weil keine Implementierung vorliegt) gepackt, damit ich es unterscheiden kann.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"id\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"name\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"vorname\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>head<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>body<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"1\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"Max\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"Muster\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"2\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"Maxine\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"Muster\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"3\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"Max\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"Muster\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>table<span class=\"token operator\">-</span>options<span class=\"token operator\">-</span>body<span class=\"token operator\">></span></span></code></pre>\n<p>Diese zwei Pseudo-Komponenten werden nun mit Hilfe des Elementattributes ausgelesen und in ein verwertbares Datenformat konvertiert.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> headOptions <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-table-options-head option\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headItems <span class=\"token operator\">=</span> headOptions<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Da <em>$el</em> ein HTML-Node ist, hat es auch alle dazugehörigen Funktionen. Wir nutzen die Methode &quot;querySelector&quot;, um nach dem <em>kuba-table-options-head</em> Tag zu suchen und nach seinen Kindelemente <em>option</em>. Anschließend machen wir ein Array daraus, um mit der <em>map</em>-Funktion darüber iterieren zu können. Das geschieht in der nächsten Zeile (Zeile 2) und aus jedem Arrayelement, bei dem es sich um weitere HTML-Nodes handelt, wird über die <em>getAttribute()</em>-Methode, das <em>value</em>-Feld ausgelesen. Diese Values merke ich mir im Klassenattribut <em>headItems</em>. Das Auslesen der Werte für den Tabellenbody ist analog dazu. Eine Ausnahme gibt es aber doch. Es handelt sich nicht wie im Head um eine einzeilige Spalte. Die Option-Tags werden alle untereinander geschrieben und man sieht nicht, wann die nächste Zeile beginnt. Um es zu vereinfachen gehe ich davon aus, dass die Anzahl der Head-Spalten auch die Anzahl der übergebenen Datensätze entspricht. Ich nutze eine Funktion, um ein Array in gleichgroße Stücke zu schneiden, die dann die jeweilige Reihe repräsentieren.</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> bodyOptions <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-table-options-body option\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> bodyOptionsValues <span class=\"token operator\">=</span> bodyOptions<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bodyItems <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">splitArrayIntoChunks</span><span class=\"token punctuation\">(</span>bodyOptionsValues<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headItems<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Hilfsfunktion</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// https://ourcodeworld.com/articles/read/278/how-to-split-an-array-into-chunks-of-the-same-size-easily-in-javascript</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">splitArrayIntoChunks</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">let</span> chunks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    chunks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">return</span> chunks<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Die Renderfunktion entspricht exakt derselben wie in Variante 2.</p>\n<p>Die gesamte Klasse sieht dann aus wie folgt:</p>\n<pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-table-options.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> Element <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-table-options\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-table-options.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaTableOptions</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Element</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> $el<span class=\"token operator\">:</span> HTMLKubaTableOptionsElement<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> headItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> bodyItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> headOptions <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-table-options-head option\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headItems <span class=\"token operator\">=</span> headOptions<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> bodyOptions <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$el<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kuba-table-options-body option\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> bodyOptionsValues <span class=\"token operator\">=</span> bodyOptions<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span></span><br><span class=\"highlight-line\">            item<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bodyItems <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">splitArrayIntoChunks</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            bodyOptionsValues<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headItems<span class=\"token punctuation\">.</span>length</span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// https://ourcodeworld.com/articles/read/278/how-to-split-an-array-into-chunks-of-the-same-size-easily-in-javascript</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">splitArrayIntoChunks</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">let</span> chunks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            chunks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> chunks<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>table<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>thead<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                            <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headItems<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span></span><br><span class=\"highlight-line\">                                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headItems<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>th<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>th<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>thead<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>tbody<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                        <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bodyItems<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span></span><br><span class=\"highlight-line\">                            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bodyItems<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">                                <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                                    <span class=\"token punctuation\">{</span>row<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">                                        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>cell<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tbody<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>table<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>Vor-</th>\n<th style=\"text-align:center\">Nachteile</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Konfiguration über HTML</td>\n<td style=\"text-align:center\">Aufwendigere Implementierung</td>\n</tr>\n<tr>\n<td>übersichtliche Komponente</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td>CSS gekapselt</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"fazit\" tabindex=\"-1\">Fazit <a class=\"direct-link\" href=\"#fazit\">#</a></h4>\n<p>Viele Wege führen nach Rom. Jede Variante hat Vor- und Nachteile. In meinen letzten Projekten war die dritte Variante mein Favorit, weil es relativ einfach direkt über HTML konfiguriert werden kann. Um die Variante mit den Properties zu füllen, muss vor dem rendern der HTML Knoten mit JS angesteuert werden und programmatisch die Daten übergeben.</p>\n<p>Was meint ihr?</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 1.0.1 auschecken:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">git</span> clone git@github.com:derKuba/stenciljs-tutorial.git</span><br><span class=\"highlight-line\"><span class=\"token function\">git</span> checkout -b stencil-starter <span class=\"token number\">1.0</span>.1</span></code></pre>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-07-02T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/erste-stencil-komponente/",
      "url": "https://derkuba.de/content/posts/stenciljs/erste-stencil-komponente/",
      "title": "StencilJS-Tutorial: Die erste Komponente",
      "content_html": "<p>Wir haben eine funktionsfähige Umgebung und können endlich mit der Entwicklung starten. <!-- endOfPreview --> In der <strong>package.json</strong> ist ein Skript zum Hinzufügen von Komponenten vorhanden: <em>generate</em>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run generate kuba-input</span></code></pre>\n<p>Der Befehl startet eine Art Wizard und fragt ab was wir erzeugen möchten:</p>\n<p><img src=\"/content/img/stenciljs-tutorial/generate.png\" alt=\"generate\" title=\"generate\"><div class=\"has-text-right image-subline\">Bild 1: Generator</div></p>\n<p>Ich habe mich für Stylesheet und Unit-Test entschieden. Die E2E Tests lasse ich erstmal außen vor.</p>\n<p><img src=\"/content/img/stenciljs-tutorial/kuba-input.png\" alt=\"kuba-input\" title=\"kuba input\"><div class=\"has-text-right image-subline\">Bild 2: Meine erste Komponente</div></p>\n<p>&quot;kuba-input&quot; ist meine erste Komponente. Der Name setzt sich aus [namespace]-[Komponentenname] zusammen und entspricht dem zukünftigen HTML-Tag. Man findet einen Ordner kuba-input unter src/components/kuba-input, in dem sich drei Dateien befinden. Die eigentliche Komponente <em>kuba-input.tsx</em>, die dazugehörige CSS <em>kuba-input.css</em> und der Unit-Test <em>kuba-input.spec.tsx</em>. Wer sich jetzt über die Dateiendung <em>.tsx</em> wundert, sollte sich nicht abschrecken lassen. TSX bedeutet, dass es sich um eine Typescript Datei handelt, in der sich HTML innerhalb des Codes befindet.</p>\n<p>Der Inhalt der kuba-input.tsx setzt sich zusammen wie folgt:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// hole die Komponente aus dem Stencil-Kern</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Annotation die anzeigt, dass es sich um eine Komponente handelt, ...</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-input\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// die mit diesem Tag aufgerufen werden kann,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-input.css\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// ihr CSS aus dieser Datei speißt</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// und im Shadow-Dom gekapselt ist.</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaInput</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// das TSX muss innerhalb von Komponenten immer in der render-methode zurückgegeben werden. Ausnahme hiervon sind sogenannte functional components.</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span>Hallo<span class=\"token punctuation\">,</span> ich bin die erste Komponente<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Wollen wir diese Komponente nun sehen, müssen wir sie als Knoten in unseren DOM hängen. Die aktuelle Starter-App ist aufgebaut wie folgt:</p>\n<ul>\n<li>&lt; app-root /&gt; ist der Einstiegspunkt in der index.html<br>\n-&gt; in dieser ist Router eingebunden. Für diese Tutorial habe ich es auskommentiert, weil es hier noch nicht benötigt wird.</li>\n</ul>\n<p>Fügt man nun innerhalb der render-Methode der app-root.tsx <kuba-input/>, bekommt man das &quot;Hallo, ich bin die erste Komponente&quot; zu sehen.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> h <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"app-root\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"app-root.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppRoot</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>header<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Adressbuch<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>main<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>main<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br>                <span class=\"token punctuation\">{</span><span class=\"token comment\">/* <br><span class=\"highlight-line\">          &lt;stencil-router></span><br><span class=\"highlight-line\">            &lt;stencil-route-switch scrollTopOffset={0}></span><br><span class=\"highlight-line\">              &lt;stencil-route url=\"/\" component=\"app-home\" exact={true} /></span><br><span class=\"highlight-line\">              &lt;stencil-route url=\"/profile/:name\" component=\"app-profile\" /></span><br><span class=\"highlight-line\">            &lt;/stencil-route-switch></span><br><span class=\"highlight-line\">          &lt;/stencil-router></span><br>       */</span><span class=\"token punctuation\">}</span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Für dieses Tutorial möchte ich folgenden Fall umsetzen. Wir legen Komponente ein, die ein Inputfeld und einen Button besitzt. Wenn ich den Button drücke, bekomme ich den Inhalt in einem Alert angezeigt.</p>\n<p><img src=\"/content/img/stenciljs-tutorial/simple-input.png\" alt=\"simple-input\" title=\"simple input\"><div class=\"has-text-right image-subline\">Bild 3: Use-Case</div></p>\n<p>Dazu brauchen wir drei Komponenten:</p>\n<ol>\n<li>Kontakt-Formular</li>\n<li>Inputfeld inklusive Label</li>\n<li>Button.</li>\n</ol>\n<p>Diese werden über den &quot;generate&quot;-Befehl erstellt:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run generate kuba-address-form</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> run generate kuba-button</span><br><span class=\"highlight-line\"><span class=\"token comment\"># falls es bisher nicht angelegt wurde</span></span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> run generate kuba-input</span></code></pre>\n<p>Die Einbindung erfolgt über die app-root.tsx und gliedert sich wie folgt:</p>\n<ul>\n<li>app-root\n<ul>\n<li>kuba-address-form\n<ul>\n<li>kuba-input</li>\n<li>kuba-button</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Anhand von kuba-input möchte ich vier grundlegenden Funktionen einer StencilJS-Komponente erklären und im Anschluss erkläre ich wie die Komponenten zusammengesteckt werden.</p>\n<ol>\n<li>Props bzw. Properties ( oder wie übergebe ich Daten an die Komponente ?)</li>\n<li>Slots</li>\n<li>Events ( oder wie versende ich Nachrichten und Interaktionen? )</li>\n<li>State ( oder wie halte ich den Zustand meiner Komponente).</li>\n</ol>\n<h3 id=\"props\" tabindex=\"-1\">Props <a class=\"direct-link\" href=\"#props\">#</a></h3>\n<p>Wir bauen HTML Tags. Diese nutzen zur Übergabe von Parametern und Daten Attribute. StencilJS nennt diese Attribute Properties.<br>\nNehmen wir jetzt die kuba-input Komponente. Diese braucht als Parameter ein Label für das Inputfeld, eine ID und den Typ des Inputfeldes (Text oder Zahl). Eine Property ist ein Klassenattribut mit einer <em>@Prop()</em>-Annotation. Ich empfehle an dieser Stelle einen Blick <a href=\"https://stenciljs.com/docs/properties\">in die offizielle Doku</a> zu werfen.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> componentId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> label<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Akzeptiere nur inputType text oder number</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// und belege es mit text vor</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> inputType<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"number\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Als Property können sämtliche Datentypen und Funktionen übergeben werden. Hier ein Beispiel für eine übergebene Funktion:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">/* kuba-button.tsx */</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Ganz normale Property, die eine Funktion beinhaltet</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> handleSubmit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// wird an das native onClick des Buttons übergeben.</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">/* kuba-address-form.tsx */</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Definition der Funktion, die übergeben werden soll-</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onSubmit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Überreichung der Funktion</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button handleSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>speichern<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span></span></code></pre>\n<h3 id=\"slots\" tabindex=\"-1\">Slots <a class=\"direct-link\" href=\"#slots\">#</a></h3>\n<p>Als <a href=\"https://stenciljs.com/docs/templating-jsx#slotshttps://stenciljs.com/docs/templating-jsx#slots\">Slot</a> werden HTML-Tags bezeichnet, die im Bauch der angelegten Komponente platziert sind. Wenn ich ein HTML tag...</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">></span><span class=\"token operator\">...</span> hier platzieren möchte<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span></code></pre>\n<p>... kann ich es nicht so tun wie hier beschrieben. Der Span-Block würde ignoriert werden. Damit das nicht passiert muss ich meiner Komponente mitteilen, an welcher Stelle diese &quot;Kinder-Knoten&quot; platziert werden sollen. Die einfachste Variante sind unbenannte Slots:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">/* kuba-button.tsx */</span></span><br><span class=\"highlight-line\"> <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token operator\">&lt;</span>slot<span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">/* kuba-address-form.tsx */</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"> <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span>speichern<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span></span></code></pre>\n<p>Der &quot;speichern&quot;-Text wird an der Stelle des Slots platziert. Um mehrere Slots innerhalb einer Komponente zu platzieren, werden benannte Slots angeboten. Diese werden innerhalt der Komponente mit einem name-Attribut versehen:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>slot name<span class=\"token operator\">=</span><span class=\"token string\">\"beliebiger-name\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>slot name<span class=\"token operator\">=</span><span class=\"token string\">\"zweiter\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span></code></pre>\n<p>und können dann an ein beliebiges HTML-Tag gepinnt werden:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"> <span class=\"token operator\">&lt;</span>p slot<span class=\"token operator\">=</span><span class=\"token string\">\"beliebiger-name\"</span><span class=\"token operator\">></span>Das ist der zu übertragende Inhalt<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span></span><br><span class=\"highlight-line\"> <span class=\"token operator\">&lt;</span>div slot<span class=\"token operator\">=</span><span class=\"token string\">\"zweiter\"</span><span class=\"token operator\">></span> Neuer Inhalt<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span></code></pre>\n<h3 id=\"events\" tabindex=\"-1\">Events <a class=\"direct-link\" href=\"#events\">#</a></h3>\n<p>Als Events werden z.B. Tastaturanschläge, Mausklicks, das Verlassen des Inputfeldes bezeichnet, aber auch Nachrichten, die man an andere Komponenten schicken kann, die sich nicht unmittelbar über dem eigenen Knoten befinden.<br>\nIm konkreten Fall möchte ich in der Elternkomponente <em>kuba-address-form</em> über Änderungen innerhalb des Inputfeldes von <em>kuba-input</em> informiert werden. Dazu benötigt die Kindkomponente <em>kuba-input</em> einen Event, samt EventEmitter. Die Elternkomponente <em>kuba-address-form</em> benötigt einen Listener auf das Event:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">/* kuba-input.tsx */</span></span><br><span class=\"highlight-line\"> <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Event</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> bubbles<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> inputEvent<span class=\"token operator\">:</span> EventEmitter<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// interner Listener auf onInput des input-tags</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onInput</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// schicke die Nachricht weiter</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>inputEvent<span class=\"token punctuation\">.</span><span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// innerhalb der render-methode</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>input</span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// hier reicht als Parameter die Referenz, da es sich um eine</span></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// Arrow-Funktion handelt. Ohne Arrow-Funktion fehlt der</span></span><br><span class=\"highlight-line\">    <span class=\"token comment\">// this-context und es wird ein Fehler geworfen.</span></span><br><span class=\"highlight-line\">    onInput<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onInput<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">/</span><span class=\"token operator\">></span></span></code></pre>\n<p>Damit die Elternkomponente nun die Nachricht bekommt, muss diese drauf lauschen:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">/* kuba-address-form.tsx */</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// innerhalb der render-methode</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input</span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\">    onInputEvent<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onChange<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span></code></pre>\n<p>Jetzt bekommt die kuba-address-form mit, wenn etwas in das kuba-input getippt wird und das bei jedem Tastaturanschlag. Dies kann man auch ändern, wenn man z.B. statt auf onInput auf onBlur lauscht.</p>\n<h3 id=\"states\" tabindex=\"-1\">States <a class=\"direct-link\" href=\"#states\">#</a></h3>\n<p>Die Elternkomponente wird im weiteren Verlauf viel mehr Inputfelder besitzen und um die Informationen aus diesen Feldern weiterzugeben, muss sich die Komponente Informationen merken.<br>\nDazu wird in StencilJS <em>@State()</em> verwendet. Hierbei handelt es sich um den Zustand der einzelnen Komponente. Möchte man sich applikationsweit den Zustand merken, wird ein <em>Store</em> benötigt. Darauf gehe ich in einem späteren Tutorial ein.</p>\n<p>Initialisiert, geschrieben und gelesen wird ein State folgendermaßen:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// Initalisierung als Klassenattribut</span></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">State</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> innerText<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// innerhalb einer Methode</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Auslesen innerhalb der render-methode</span></span><br><span class=\"highlight-line\">Name<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">}</span></span></code></pre>\n<p>In konkretem Fall schreibe ich den eingetippten Wert bei jedem Tastenanschlag in den State.</p>\n<h3 id=\"zusammenf%C3%BChrung\" tabindex=\"-1\">Zusammenführung <a class=\"direct-link\" href=\"#zusammenf%C3%BChrung\">#</a></h3>\n<p>Die zusammengesteckten Komponenten funktionieren nun wie im Use-Case definiert. Die <em>kuba-address-form</em> definiert den Rahmen und inkludiert das <em>kuba-input</em> und den <em>kuba-button</em>. Die eingegeben Informationen werden per Event an die Elternkomponente weitergereicht, geloggt, gespeichert und dann beim Betätigen des <em>kuba-buttons</em> via Alert ausgegeben.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-addres-form.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> State <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-address-form\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-address-form.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaAddressForm</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">State</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> innerText<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        detail<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">onSubmit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>Adress<span class=\"token operator\">-</span>Formular<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>input</span><br><span class=\"highlight-line\">                    componentId<span class=\"token operator\">=</span><span class=\"token string\">\"name\"</span></span><br><span class=\"highlight-line\">                    label<span class=\"token operator\">=</span><span class=\"token string\">\"Name:\"</span></span><br><span class=\"highlight-line\">                    onInputEvent<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onChange<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>input<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>kuba<span class=\"token operator\">-</span>button handleSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    speichern</span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>kuba<span class=\"token operator\">-</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>hr <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">></span>Eingegebene Daten<span class=\"token operator\">:</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                Name<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-input.tsx</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> Event<span class=\"token punctuation\">,</span> EventEmitter<span class=\"token punctuation\">,</span> Prop <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-input\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-input.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaInput</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> componentId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> label<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> inputType<span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"number\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Event</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> inputEvent<span class=\"token operator\">:</span> EventEmitter<span class=\"token punctuation\">;</span>Teilen dieser Tutorial Reihet<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">      <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"kuba-input\"</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">          <span class=\"token operator\">&lt;</span>label htmlFor<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>componentId<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">          <span class=\"token operator\">&lt;</span>input</span><br><span class=\"highlight-line\">            type<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>componentId<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">            id<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>componentId<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">            value<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></span><br><span class=\"highlight-line\">            onInput<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onInput<span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">          <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span></code></pre>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// kuba-button.tsx</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Host<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> Prop <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@stencil/core\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    tag<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-button\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"kuba-button.css\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KubaButton</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> handleSubmit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                    <span class=\"token operator\">&lt;</span>slot <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><br><span class=\"highlight-line\">                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 1.0.0 auschecken:</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-06-11T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/entwicklerwerkzeuge/",
      "url": "https://derkuba.de/content/posts/stenciljs/entwicklerwerkzeuge/",
      "title": "StencilJS-Tutorial: Entwicklungswerkzeuge einrichten",
      "content_html": "<p>Nachdem wir das StencilJS-Starter-Projekt aufgesetzt haben, fügen wir jetzt noch die nötigen Entwicklerwerkzeuge und ein CSS-Framework zum Projekt hinzu. Ziel dieser Werkzeuge ist ein einheitlicher und qualitativ-hochwertiger Code. <!-- endOfPreview --></p>\n<p>Die Entwicklungswerkzeuge sind folgende:</p>\n<ol>\n<li><a href=\"https://prettier.io/docs/en/install.html\">Prettier</a></li>\n<li><a href=\"https://eslint.org/docs/user-guide/getting-started\">Eslint</a></li>\n<li><a href=\"https://jestjs.io/\">JEST</a></li>\n<li>An dieser Stelle steht in meinen Real-Life-Projekten immer <a href=\"https://storybook.js.org/\">Storybook</a></li>\n</ol>\n<p>Zusätzlich zu den Werkzeugen installiere ich noch das CSS-Framwork Bulma.</p>\n<p>Zum installieren folge ich den Anleitungen auf der jeweiligen Seite.</p>\n<h3 id=\"prettier\" tabindex=\"-1\">Prettier <a class=\"direct-link\" href=\"#prettier\">#</a></h3>\n<p>Prettier ist ein Formatierungswerkzeug und sorgt dafür, dass alle Code-Dateien im gleichen Stil geschrieben werden. Auf die Regeln sollte man sich im Team vorher einigen und dann befolgen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token comment\"># Module zu den dev-dependencies hinzufügen</span></span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev --save-exact prettier</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># Konfigurationsdatei hinzufügen</span></span><br><span class=\"highlight-line\"><span class=\"token builtin class-name\">echo</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> .prettierrc.json</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># Ausnahme-Datei hinzufügen ( es sollen ja nicht alle Dateien analysiert und formattiert werden)</span></span><br><span class=\"highlight-line\"><span class=\"token builtin class-name\">echo</span> node_modules<span class=\"token operator\">></span> .prettierignore</span></code></pre>\n<p>Damit ist Prettier installiert. Jetzt muss man es noch konfigurieren, d.h. Regeln und Ausnahmen hinzufügen. In die ignore schreibe ich standardmäßig für ein StencilJS-Projekt folgende Ausnahmen:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">node_modules</span><br><span class=\"highlight-line\">dist</span><br><span class=\"highlight-line\">www</span><br><span class=\"highlight-line\">build</span><br><span class=\"highlight-line\">public</span><br><span class=\"highlight-line\">node_modules</span><br><span class=\"highlight-line\">coverage</span><br><span class=\"highlight-line\">*.svg</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># This file is changed by the stencil compiler</span></span><br><span class=\"highlight-line\">src/components.d.ts</span></code></pre>\n<p>Bei <a href=\"https://prettier.io/docs/en/options.html\">den Konfigurationsregeln</a> gibt es kein richtig oder falsch. Diese sollten individuell diskutiert werden und zum Projektstart aber feststehen. Ich habe mich jetzt für folgende Regeln entschieden:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"printWidth\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">80</span>,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"useTabs\"</span><span class=\"token builtin class-name\">:</span> false,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"semi\"</span><span class=\"token builtin class-name\">:</span> true,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"tabWidth\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"singleQuote\"</span><span class=\"token builtin class-name\">:</span> false,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"trailingComma\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"all\"</span>,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"bracketSpacing\"</span><span class=\"token builtin class-name\">:</span> true,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"arrowParens\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"always\"</span>,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"jsxSingleQuote\"</span><span class=\"token builtin class-name\">:</span> false,</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"jsxBracketSameLine\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token boolean\">false</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Die Zeilenlänge habe ich auf 80 Zeichen gesetzt, verwende Leerzeichen statt Tabs, verlange ein Semikolon nach jedem Statement, Tabweite liegt bei 2 Zeichen, verwende &quot; statt ' , etc.</p>\n<p>Die Prettier-Konfiguration kann in jeder IDE übernommen werden und dann automatisch beim Speichern ausgeführt werden. Ich mag zusätzlich noch die Option es per NPM auszuführen.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">// package.json</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span></span><br><span class=\"highlight-line\">scripts: <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\"> <span class=\"token string\">\"prettier\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"prettier --write src\"</span>,</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Wenn ich nun <strong>npm run prettier</strong> in der Konsole ausführe, wird der gesamte Code (ohne die Ausnahmen) analysiert und durch das <em>--write</em>-Flag auch korrigiert. ACHTUNG: Es werden mitunter sehr viele Dateien angefasst. Das verfälscht den Merge-Request.</p>\n<h3 id=\"eslint\" tabindex=\"-1\">ESLINT <a class=\"direct-link\" href=\"#eslint\">#</a></h3>\n<p>ESLINT ist ein Werkzeug zur statischen Code-Analyse. Es untersucht neben dem Programmierstil noch die Qualität und gibt sogar Tipps für eine bessere Implementierung. Ein MUSS in jedem Projekt. Es ist komplett Konfigurierbar. Jede Regel lässt sich ein- und ausschalten oder eine Warnung werfen. Zusätzlich kann man sich Regelsätze von anderen Projekten installieren. Ich nehme immer Regelpakete der großen Softwarehäuser wie Google, Microsoft, etc.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">// installieren</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> eslint --save-dev</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">// initiieren</span><br><span class=\"highlight-line\">npx eslint --init</span></code></pre>\n<p><img src=\"/content/img/stenciljs-tutorial/eslint-init.png\" alt=\"eslint init\" title=\"eslint init\"><div class=\"has-text-right image-subline\">Bild 1: Eslint Init CLI</div></p>\n<p>Nachdem man diesen Installations-Wizard ausgeführt hat, erscheint eine Konfigurationsdatei <strong>eslintrc.js</strong> im Root des Projekts.</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"highlight-line\">module.exports = <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// Wo läuft der Code ? => im browser in ES6+</span></span><br><span class=\"highlight-line\">        <span class=\"token property\">\"browser\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token property\">\"es2021\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// welches Regelwerk wird verwendet?</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"standard\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"eslint:recommended\"</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"parser\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@typescript-eslint/parser\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Wir verwenden Typescript!</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"parserOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// Konfigurationen</span></span><br><span class=\"highlight-line\">        <span class=\"token property\">\"ecmaVersion\"</span><span class=\"token operator\">:</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token property\">\"sourceType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"module\"</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// Plugins</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"@typescript-eslint\"</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// Individuelle Erweiterung der Regeln</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span>;</span></code></pre>\n<p>Jetzt fügen wir noch ein Script in die package.json hinzu:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\">// package.json</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\">scripts: <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"eslint\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"eslint --ext .tsx --ext .ts src/\"</span>,</span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Nun kann man ESLINT auf der Konsole laufen lassen: <strong>npm run eslint</strong>. In dieser Konfiguration werden Fehler nur gemeldet. Aber ESLINT kann noch mehr. Es kann auch &quot;einfache&quot; Fehler selber beheben. Dafür fügt man dem oberen Script noch den Parameter &quot;--fix&quot; hinzu. Wie durch Magie sind nun aus 173 Fehlern, nur noch 30 Fehler übrig.</p>\n<p>In diesem Zustand kommt es noch zu vielen Warnungen und Fehlern. So sind zb. (sollte man vorher prettier ausgeführt haben) die Anführungszeichen einfach, aber wir haben uns im Projekt auf doppelte geeinigt. Im Moment schreibt Prettier doppelte Semikola und ESLINT überschreibt sie mit einfachen. Jetzt muss man beide Werkzeuge verbinden.<br>\nDie Lösung lautet <a href=\"https://github.com/prettier/eslint-plugin-prettier\">&quot;eslint-plugin-prettier&quot;</a>.</p>\n<p>Dazu müssen wir folgendes ausführen, bzw. in die .eslintrc.js-Config schreiben:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev eslint-config-prettier</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev eslint-plugin-prettier</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">// .eslintrc.js</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\">    <span class=\"token string\">\"extends\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"standard\"</span>,</span><br><span class=\"highlight-line\">        <span class=\"token string\">\"eslint:recommended\"</span>,</span><br><span class=\"highlight-line\">        <span class=\"token string\">\"plugin:prettier/recommended\"</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">]</span>,</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">..</span>.</span><br><span class=\"highlight-line\"></span></code></pre>\n<p>Wenn man nun <strong>npm run eslint</strong> ausführt, folgt der Linter den in Prettier definierten Regeln. Die Semikola bleiben doppelt.</p>\n<p>Im aktuellen Setup treten aber noch Fehler, die in Verbindung mit dem Testframework JEST und JSX stehen, auf. Der Linter sagt, dass er weder <em>it</em>, noch <em>describe</em> kennt und auch ein 'h' nicht definiert ist. Ersteres löst man, in dem an in der <em>.eslintrc.js</em> in das <em>&quot;env&quot;</em> Property ein <strong>&quot;jest&quot;: true</strong> ergänzt.</p>\n<p>Da dieses Projekt auf StencilJS setzt habe ich noch die <a href=\"https://github.com/ionic-team/stencil-eslint\">empfohlenen StencilJS-Regeln</a> hinzugefügt.</p>\n<pre><code>npm i eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-plugin-react @stencil/eslint-plugin --save-dev\n\n// Ergänzung in der .eslintrc.js\n{\n  &quot;parserOptions&quot;: {\n    &quot;project&quot;: &quot;./tsconfig.json&quot;\n  },\n  &quot;extends&quot;: [\n    &quot;plugin:@stencil/recommended&quot;\n  ]\n}\n</code></pre>\n<h3 id=\"jest\" tabindex=\"-1\">JEST <a class=\"direct-link\" href=\"#jest\">#</a></h3>\n<p>Für die Unit-Tests, aber auch für die E2E Tests empfehle ich JEST. Ich benutze es seit 2016. Es hat alles was man sich wünscht. Man arbeitet sich sehr schnell ein. Die Verwendung von Mocks, Spys, Stubs war nie einfacher. Die Syntax ist angelehnt an JasmineJS.</p>\n<p>Um es in diesem Projekt zu Starten muss man lediglich &quot;npm run test&quot; ausführen. Es würde alle Tests, die am Dateinamen ein <em>.spec.</em> oder <em>.e2e.</em> haben ausgeführt. Da ich kein großer Fan der StencilJS E2E Tests bin, aber ich das Flag &quot;--e2e&quot; aus dem Skript in der package.json entfernt.</p>\n<p>Beim initialen Start verlangt NPM noch das nachinstallieren gewisser Module. In meinem Fall:</p>\n<pre><code>[ ERROR ]  Please install missing dev dependencies with either npm or yarn.\nnpm install --save-dev @types/jest@26.0.21 jest@26.6.3 jest-cli@26.6.3 @types/puppeteer@5.4.3\npuppeteer@5.5.0\n</code></pre>\n<p>Die Lösung für das Problem steht direkt dabei. Nachdem man die Module installiert hat, und nochmal <em>npm run test</em> ausgeführt hat, sollte folgende Erfolgsmeldung erscheinen:</p>\n<pre><code>Test Suites: 4 passed, 4 total\nTests:       11 passed, 11 total\nSnapshots:   0 total\nTime:        2.099 s\n</code></pre>\n<p>Das wären alle meine empfohlenen Werkzeuge zum Start des Projektes. Natürlich lassen diese sich nachträglich in bestehende Projekte einbauen. Der initiale Aufwand sollte beim Starten eines neuen Projektes auf keinen Fall umgangen werden. Ich habe diese Tools bei Kunden in bestehende Projekte eingebaut und durfte dann erstmal 12000 Fehler beheben, was ein immenser Aufwand ist. Von nicht vorhandenen Tests möchte ich erst gar nicht anfangen. Viele Projekte mussten wegen fehlender Tests neugestartet werden.</p>\n<p>Im nächsten Artikel geht es aber dann endlich mit der eigentlichen Entwicklung los.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 0.9.1 auschecken:</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-06-04T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/projekt-aufsetzen/",
      "url": "https://derkuba.de/content/posts/stenciljs/projekt-aufsetzen/",
      "title": "StencilJS-Tutorial: 1. Projekt aufsetzen",
      "content_html": "<p>In der Dokumentation von <a href=\"https://stenciljs.com/docs/getting-started\">StencilJS</a> wird erklärt wie man ein Projekt neu aufsetzt. <!-- endOfPreview -->Der Befehl</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> init stencil</span></code></pre>\n<p>startet eine Abfrage, in der man sich für eine Auswahl entscheiden muss ob man eine Progressive Web APP, eine Webseite oder eine einfache Komponente bauen möchte. Wir entscheiden uns für die zweite Auswahl.</p>\n<p><img src=\"/content/img/stenciljs-tutorial/stencil-starter.png\" alt=\"Stencil Start\" title=\"Stencil Start\"><div class=\"has-text-right image-subline\">Bild 1: Auswahl</div></p>\n<p>Nachdem man sich für die zweite Auswahl entschieden hat, muss man noch einen Namen für das Projekt eingeben: address-book und bestätigt mit Y.</p>\n<p><img src=\"/content/img/stenciljs-tutorial/stencil-starter-finish.png\" alt=\"Stencil Start Ende\" title=\"Stencil Start Ende\"><div class=\"has-text-right image-subline\">Bild 2: fertige Auswahl</div><br>\nDas Stencil-Starter-Projekt wurde erfolgreich heruntergeladen. Es fehlen aber noch die Dependencies.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> address-book</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span></span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> start</span></code></pre>\n<p>und es startet ein Browser unter der Adresse <a href=\"http://localhost:3333\">http://localhost:3333</a> mit folgendem Inhalt:</p>\n<p><img src=\"/content/img/stenciljs-tutorial/stencil-starter-app.png\" alt=\"Stencil Start Ende\" title=\"Stencil Start Ende\"><div class=\"has-text-right image-subline\">Bild 2: fertige Auswahl</div></p>\n<p>Nun hat man eine lauffähige Webseite, die nach und nach umgebaut wird. Aber schauen wir mal woraus das Starter-Paket besteht:</p>\n<p><img src=\"/content/img/stenciljs-tutorial/stencil-starter-files.png\" alt=\"Stencil Starter Dateien\" title=\"Stencil Starter Dateien\"><div class=\"has-text-right image-subline\">Bild 2: Starter Dateien</div></p>\n<table>\n<thead>\n<tr>\n<th>Datei</th>\n<th style=\"text-align:right\">Inhalt</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>src/assets/*</td>\n<td style=\"text-align:right\">bilder, icons, fonts</td>\n</tr>\n<tr>\n<td>src/components/*.ts</td>\n<td style=\"text-align:right\">Komponentenklassen</td>\n</tr>\n<tr>\n<td>src/components/*.css</td>\n<td style=\"text-align:right\">Gekapseltes CSS der jeweiligen Komponente</td>\n</tr>\n<tr>\n<td>src/global/_.css / _.tss</td>\n<td style=\"text-align:right\">Globales CSS und ein globales Skript (sollte möglichst leer bleiben)</td>\n</tr>\n<tr>\n<td>src/components.d.ts</td>\n<td style=\"text-align:right\">Automatisch generierte Typen-Datei der Komponenten</td>\n</tr>\n<tr>\n<td>src/index.html</td>\n<td style=\"text-align:right\">Zentrale HTML-Datei, in der die Root-Komponente eingehangen ist</td>\n</tr>\n<tr>\n<td>src/index.ts</td>\n<td style=\"text-align:right\">&quot;Main&quot;-Datei des Programmcodes</td>\n</tr>\n<tr>\n<td>src/manifest.json</td>\n<td style=\"text-align:right\">Metadaten-Datei für die Browser</td>\n</tr>\n<tr>\n<td>src/.editorconfig</td>\n<td style=\"text-align:right\">Formatierungsdatei für den Editor (charset, tab spaces...)</td>\n</tr>\n<tr>\n<td>src/.gitignore</td>\n<td style=\"text-align:right\">Welche Dateien sollen nicht eingecheckt werden</td>\n</tr>\n<tr>\n<td>src/.prettierrc.json</td>\n<td style=\"text-align:right\">Konfigurationsdatei für Prettier (Formatierungsvereinheitlichung)</td>\n</tr>\n<tr>\n<td>src/package-lock.json</td>\n<td style=\"text-align:right\">Automatisch von npm generiert - beschreibt den Abhängigkeitenbaum</td>\n</tr>\n<tr>\n<td>src/package.json</td>\n<td style=\"text-align:right\">Beschreibt das Projekt (Abhängigkeiten zu Modulen, Lizenz, Skripte)</td>\n</tr>\n<tr>\n<td>src/stencil.config.ts</td>\n<td style=\"text-align:right\">Zentrale Konfigurationsdatei für Stencil</td>\n</tr>\n<tr>\n<td>src/tsconfig.json</td>\n<td style=\"text-align:right\">Zentrale Konfigurationsdatei für Typescript</td>\n</tr>\n</tbody>\n</table>\n<p>Im nächsten Artikel geht es dann endlich los mit der eigentlichen Programmierarbeit.</p>\n<p>Der Code hierzu liegt auf <a href=\"https://github.com/derKuba/stenciljs-tutorial\">Github</a>. Um es auf diesen Stand zu bringen, müsst ihr das Projekt klonen und einmal auf den Tag 0.9.0 auschecken:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">git</span> clone git@github.com:derKuba/stenciljs-tutorial.git</span><br><span class=\"highlight-line\"><span class=\"token function\">git</span> checkout -b stencil-starter <span class=\"token number\">0.9</span>.0</span></code></pre>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-05-29T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/stenciljs/introduction/",
      "url": "https://derkuba.de/content/posts/stenciljs/introduction/",
      "title": "StencilJS-Tutorial: Einführung",
      "content_html": "<p><a href=\"https://stenciljs.com/\">StencilJS</a> ist ein sehr gutes Framework mit dem man schnell robuste Webanwendungen bauen kann. Der Einstieg ist recht einfach, bzw. der Umstieg von zb. React macht es noch leichter. Der Grundgedanke ist leicht erklärt. Anstatt schwerfällige Runtimes/Kernbibliotheken mitauszuliefern, kompiliert StencilJS einfach den Webstandard Webcomponents, der in allen modernen Browsern out-of-the-box funktioniert. Weil diese Webcomponents, meiner Meinung nach, nicht schön zu programmieren sind, dient StencilJS als Luxuswerkzeug. <!-- endOfPreview --></p>\n<p>Da ein einziger Blogpost nicht ausreichen wird, strukturiere ich das Tutorial in mehrere Teile und werde versuchen jede Woche einen neuen Teil fertig zu stellen. Der aktuelle Code befindet sich <a href=\"https://github.com/derKuba/stenciljs-tutorial\">in meinem Github-Repo</a>.</p>\n<p>Das Tutorial gliedere ich in folgende Punkte:</p>\n<ol>\n<li><strong>StencilJS</strong> aufsetzen.</li>\n<li>Entwicklerwerkzeuge hinzufügen.</li>\n<li>Die <strong>UI Grundstruktur</strong>: Erste Webkomponenten.</li>\n<li>Der StencilJS <strong>Store</strong> und die Interaktion.</li>\n<li>Exkursion: Kleines <strong>Backend</strong> mit NodeJS und KOA.</li>\n<li>Anbindung an das Backend.</li>\n<li>E2E Blackbox Testing mit <strong>Playwright</strong>.</li>\n</ol>\n<p>Der Techstack sieht aus wie folgt:</p>\n<ul>\n<li><em>StencilJS</em> =&gt; Webcomponents</li>\n<li><em>Eslint/Prettier/Jest</em> =&gt; Code-Qualität</li>\n<li><em>KOA</em> =&gt; Backend</li>\n<li><em>Playwright</em> =&gt; E2E Tests</li>\n</ul>\n<p>Als fachlichen Unterbau eignet sich hervorragend eine CRUD-Anwendung und ich habe mich für ein Adressbuch entschieden. Weil ich ein begnadeter UX/UI-ler :-) bin, habe ich auch folgendes Design entworfen.</p>\n<br/>\n<h4 id=\"scribbles-der-anwendung\" tabindex=\"-1\">Scribbles der Anwendung <a class=\"direct-link\" href=\"#scribbles-der-anwendung\">#</a></h4>\n<p>Man erkennt eine einfach Liste, die alle Einträge des Adressbuchs enthält. Wenn man auf den Editieren-Link klickt, wird man auf die Detailseite geleitet. Bei einem Klick auf Löschen wird dieser Eintrag entfernt.<br>\n<img src=\"/content/img/stenciljs-tutorial/list-design.png\" alt=\"Liste\" title=\"Liste\"><div class=\"has-text-right image-subline\">Bild 1: Kontaktliste</div></p>\n<p><img src=\"/content/img/stenciljs-tutorial/detail-page-design.png\" alt=\"Detailseite\" title=\"Detailseite\"><div class=\"has-text-right image-subline\">Bild 2: Detailseite</div></p>\n<p>Auf der Detailseite gibt es für jedes Feld eine Eingabebox. Der Speichern-Button persistiert die Eingaben, man wird auf die Liste zurückgeleitet und man sieht, dass ein Eintrag zusätzlich vorhanden ist.</p>\n<p>Auf der nächsten Seite geht es los mit dem aufsetzen des Projekts.</p>\n",
      "date_published": "2021-05-29T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0521/fun-with-no-break-character/",
      "url": "https://derkuba.de/content/posts/0521/fun-with-no-break-character/",
      "title": "Fuckup der Woche: &#39;no-break space&#39; - das geschützte Leerzeichen",
      "content_html": "<h4 id=\"warum-%2223.42-%E2%82%AC%22-nicht-gleich-%2223.42-%E2%82%AC%22-sind-%3F\" tabindex=\"-1\">Warum &quot;23.42 €&quot; nicht gleich &quot;23.42 €&quot; sind ? <a class=\"direct-link\" href=\"#warum-%2223.42-%E2%82%AC%22-nicht-gleich-%2223.42-%E2%82%AC%22-sind-%3F\">#</a></h4>\n<p>Die Antwort auf diese Frage hat mich diese Woche viel Zeit gekostet. Um sicherzustellen, dass meine Webanwendung auch das macht was sie verspricht setze ich auf E2E Tests. Dieser Blackbox-Test benutzt einen Browser, gibt die URL meiner Webanwendung ein und klickt diese dann anhand der definierten Testfälle durch. Anschließend liest er Werte aus und vergleicht diese mit vorher definierten Werten. Im konkreten Fall sollte er eine Rechnung überprüfen. <!-- endOfPreview -->Die Überprüfung ist ein einfacher Textvergleich, wie z.B.:</p>\n<pre><code>&quot;23,42 €&quot; == &quot;18.24 $&quot;\n</code></pre>\n<p>Man sieht sofort, dass da was nicht stimmt und kann nach der Ursache forschen.</p>\n<p>In meinem Fall lautete der Fehler auf der Konsole aber:</p>\n<pre><code>Error: '231,63 €' is not included in '231,63 €'...\n</code></pre>\n<p>Nach einem Vergleich Zeichen für Zeichen kam dann die Verwunderung. Scheinbar ist das Leerzeichen schuld. Das Leerzeichen wird aber nicht manuell eingefügt, sondern kommt aus der TS/JS-internen Bibliothek. Für die Darstellung des Preises soll aus der typescript number &quot;232.23&quot; die deutsche Schreibweise für einen Preis inklusive Währung erscheinen. Dafür wird die Methode <strong>&quot;toLocaleString&quot;</strong> benutzt. Diese generiert mir die Anzeige automatisch.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// Wir nehmen eine einfach Summe:</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">232.23</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Wandeln diese in die deutsche Schreibweise inklusive Währung.</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">let</span> sumDisplay <span class=\"token operator\">=</span> sum<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"de-DE\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    style<span class=\"token operator\">:</span> <span class=\"token string\">\"currency\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    currency<span class=\"token operator\">:</span> <span class=\"token string\">\"EUR\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    minimumFractionDigits<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    maximumFractionDigits<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// output: 232,23 €</span></span></code></pre>\n<p>Vergleicht man nun das Ouput aus der Konsole mit dem erwarteten Ergebnis:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Ist \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>sumDisplay<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\" === \"232,23 €\" ??? </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>sumDisplay <span class=\"token operator\">===</span> <span class=\"token string\">\"232,23 €\"</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> \\n</span><span class=\"token template-punctuation string\">`</span></span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// output: Ist \"232,23 €\" === \"232,23 €\" ??? false</span></span></code></pre>\n<p>Den Grund dafür kann man sich auf der Konsole ausgeben lassen, wenn man sich Zeichen für Zeichen aus der UTF-16 Tabelle ausgibt:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Zeige dich Zeichen in UTF-16 an: \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">sumDisplay<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">(</span>character<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>character<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> => </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>character<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// print Ascii Code</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// output:</span></span><br><span class=\"highlight-line\"><span class=\"token number\">2</span> <span class=\"token operator\">=></span> <span class=\"token number\">50</span></span><br><span class=\"highlight-line\"><span class=\"token number\">3</span> <span class=\"token operator\">=></span> <span class=\"token number\">51</span></span><br><span class=\"highlight-line\"><span class=\"token number\">2</span> <span class=\"token operator\">=></span> <span class=\"token number\">50</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">,</span> <span class=\"token operator\">=></span> <span class=\"token number\">44</span></span><br><span class=\"highlight-line\"><span class=\"token number\">2</span> <span class=\"token operator\">=></span> <span class=\"token number\">50</span></span><br><span class=\"highlight-line\"><span class=\"token number\">3</span> <span class=\"token operator\">=></span> <span class=\"token number\">51</span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">=></span> <span class=\"token number\">160</span></span><br><span class=\"highlight-line\">€ <span class=\"token operator\">=></span> <span class=\"token number\">8364</span></span></code></pre>\n<p>Welche Nummer hat denn das &quot; &quot;-Whitespace? (32):</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n whitespace ' ' ist nicht gleich ' ' \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> ist nicht gleich </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Whitespace ist nicht gleich NO-BREAK SPACE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Es handelt sich nicht um das &quot;normale&quot; Whitespace, sondern um das &quot;No-Break-Space&quot;. Der grundlegende Unterschied ist, dass diese nicht umgebrochen werden darf, damit der Preis nicht vom Währungszeichen getrennt wird. Der Stringvergleich scheitert dabei natürlich.<br>\nBei der Recherche bin ich auf <a href=\"https://de.wikipedia.org/wiki/Gesch%C3%BCtztes_Leerzeichen\">eine ganze Liste von Whitespaces</a> gestoßen.<br>\nMein Learning der Woche war damit abgeschlossen. Vertraue keinen Zeichen, die du nicht siehst.</p>\n<p>Wer sich mehr Zeichen anschauen möchte, kann diese natürlich sich ausgeben. Hier ein kleines Beispiel für unser Alphabet:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\\n\\n\\n UTF-16 code TABLE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> alphabet <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> index <span class=\"token operator\">=</span> <span class=\"token number\">49</span><span class=\"token punctuation\">;</span> index <span class=\"token operator\">&lt;</span> <span class=\"token number\">127</span><span class=\"token punctuation\">;</span> index<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    alphabet<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span>alphabet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">┌─────────┬─────┬──────┐</span><br><span class=\"highlight-line\"><span class=\"token function\">│</span> <span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span> │  <span class=\"token number\">0</span>  │  <span class=\"token number\">1</span>   │</span><br><span class=\"highlight-line\">├─────────┼─────┼──────┤</span><br><span class=\"highlight-line\">│    <span class=\"token number\">0</span>    │ <span class=\"token number\">49</span>  │ <span class=\"token string\">'1'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">1</span>    │ <span class=\"token number\">50</span>  │ <span class=\"token string\">'2'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">2</span>    │ <span class=\"token number\">51</span>  │ <span class=\"token string\">'3'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">3</span>    │ <span class=\"token number\">52</span>  │ <span class=\"token string\">'4'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">4</span>    │ <span class=\"token number\">53</span>  │ <span class=\"token string\">'5'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">5</span>    │ <span class=\"token number\">54</span>  │ <span class=\"token string\">'6'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">6</span>    │ <span class=\"token number\">55</span>  │ <span class=\"token string\">'7'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">7</span>    │ <span class=\"token number\">56</span>  │ <span class=\"token string\">'8'</span>  │</span><br><span class=\"highlight-line\">│    <span class=\"token number\">8</span>    │ <span class=\"token number\">57</span>  │ <span class=\"token string\">'9'</span>  │</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token operator\">...</span><span class=\"token operator\">...</span></span></code></pre>\n<p>Diese Code-Blöcke habe ich unter <a href=\"https://github.com/derKuba/fun-with-typescript/tree/main/fun-with-localstring\">Github</a> für euch zur Verfügung gestellt.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.<br>\n<br>\n<br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-05-21T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0521/flutter-import-sqlite-db/",
      "url": "https://derkuba.de/content/posts/0521/flutter-import-sqlite-db/",
      "title": "How to import SQlite Database File in Flutter (Android)",
      "content_html": "<p>Vor kurzem habe ich erklärt wie man aus seiner App die <a href=\"https://www.sqlite.org/index.html\">SQlite-Datenbank</a> exportiert. In diesem Artikel erkläre ich wie man diese importiert. Voraussetzung ist ein bestehendes Flutter-Projekt und ein SQlite-Datenbank im Download-Verzeichnis des Telefons. <!-- endOfPreview --></p>\n<p>Benötigte Bibliotheken sind folgende:</p>\n<pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"highlight-line\"><span class=\"token key atrule\">dependencies</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">flutter</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">        <span class=\"token key atrule\">sdk</span><span class=\"token punctuation\">:</span> flutter</span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">sqflite</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">permission_handler</span><span class=\"token punctuation\">:</span> ^7.0.0</span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">downloads_path_provider</span><span class=\"token punctuation\">:</span> ^0.1.0</span></code></pre>\n<p>Die Vorgehensweise strukturiert sich folgendermaßen:</p>\n<ol>\n<li>Lege eine neue Seite für den Import an und gebe den Dateipfad hinein</li>\n<li>Lese Dateien aus dem Download-Verzeichnis und filtere nach <em>&quot;.db&quot;</em></li>\n<li>Zeige die Dateien an.</li>\n<li>Kopiere diese in das Datenbankverzeichnis</li>\n</ol>\n<p>Ich gehe davon aus, dass mehrere Dateien für den Import zur Verfügung stehen und man den Nutzer vor die Wahl stellen kann, welche er importieren möchte. Für die Auswahl aus einer Liste bieten sich Radiobuttons an. In Flutter gibt es dazu die <strong><em>RadioListTile</em></strong>:</p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token class-name\">String</span> selectedFile <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></span><br><span class=\"highlight-line\"><span class=\"token class-name\">RadioListTile</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">    title<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>fileName<span class=\"token punctuation\">.</span>path <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Der Titel ist der Pfad der Datei</span></span><br><span class=\"highlight-line\">    value<span class=\"token punctuation\">:</span> fileName<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span>             <span class=\"token comment\">//  und der Wert ebenfalls.</span></span><br><span class=\"highlight-line\">    groupValue<span class=\"token punctuation\">:</span> selectedFile<span class=\"token punctuation\">,</span>        <span class=\"token comment\">//   Zum Anzeigen der Auswahl benötigt man eine Merkvariable, die den ausgewählten Wert repräsentiert.</span></span><br><span class=\"highlight-line\">    onChanged<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>     <span class=\"token comment\">//    In der Change-Funktion wird diese Merkervariabel ge- und überschrieben.</span></span><br><span class=\"highlight-line\">      <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        selectedFile <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Das Ganze sieht dann aus wie folgt:</p>\n<p><img src=\"/content/img/0521/import_ui.png\" alt=\"Dateiauswahl\" title=\"Dateiauswahl\"><div class=\"has-text-right image-subline\">Bild 1: RadioListTile in Aktion</div></p>\n<p>Der grüne Knopf im unteren Bereich heißt <strong><em>FloatingActionButton</em></strong> und hat auf seiner onPressed-Methode folgende Funktion:</p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\">  <span class=\"token function\">_importDB</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BuildContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>selectedFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>selectedFile <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">var</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token class-name\">Permission</span><span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>status<span class=\"token punctuation\">.</span>isGranted<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token class-name\">Permission</span><span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">var</span> srcFile <span class=\"token operator\">=</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>selectedFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">var</span> dbFileBytes <span class=\"token operator\">=</span> srcFile<span class=\"token punctuation\">.</span><span class=\"token function\">readAsBytesSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">var</span> bytes <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteData</span><span class=\"token punctuation\">.</span><span class=\"token function\">view</span><span class=\"token punctuation\">(</span>dbFileBytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">final</span> buffer <span class=\"token operator\">=</span> bytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">var</span> databasesPath <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getDatabasesPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">var</span> distPath <span class=\"token operator\">=</span> <span class=\"token function\">join</span><span class=\"token punctuation\">(</span>databasesPath<span class=\"token punctuation\">,</span> <span class=\"token string\">'doggy__${DateTime.now()}.db'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">await</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>distPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">writeAsBytes</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">.</span><span class=\"token function\">asUint8List</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">            dbFileBytes<span class=\"token punctuation\">.</span>offsetInBytes<span class=\"token punctuation\">,</span> dbFileBytes<span class=\"token punctuation\">.</span>lengthInBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">      <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span></code></pre>\n<p>Im ersten Teil prüfen wir, ob eine Datei ausgewählt wurde und im Anschluss ob wir überhaupt Lese- und Schreibezugriff auf dem Smartphone haben. Wir holen, bzw. lesen dann die Datei aus dem Downloadverzeichnis aus (Zeile 9-12). Dann lesen wir den Pfad des Downloadverzeichnis aus und bauen aus dem Pfad und dem Dateinamen einen neuen Pfad (Zeile 14-15). In Zeile 17+18 schreiben wir die Datei in das Datenbankverzeichnis des Telefons.</p>\n<p>Natürlich kann man hier jetzt viele verschiedene Variationen einbauen. So kann man z.B. die alte Datenbankdatei erstmal umbenennen und als Backup vorhalten. Alternativ kann man die alte Datei auch löschen. Wichtig ist, dass man in der laufenden Anwendung die aktuelle Datenbank schließt und neu ausliest, denn sonst hat die alten Daten im Speicher und muss die App erstmal neustarten.</p>\n<p>PS: Ab Android 11 (targetSdkVersion 30) wurde einiges am Rechtemanagement umgestellt. Das hat z.B. den Effekt, dass man die DB-Dateien aus APP A in APP B im Download-Verzeichnis nicht sehen kann. Um dies zu umgehen bin ich in meinen Apps auf targetSdkVersion 29 geblieben bis alle benötigten Flutter-Plugins targetSdkVersion 30 auch ausreichend unterstützen.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-05-13T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0521/bewerbungsgespraech-leiten/",
      "url": "https://derkuba.de/content/posts/0521/bewerbungsgespraech-leiten/",
      "title": "Vorstellungsgespräche leiten, ein gutes Gespräch für beide Seiten.",
      "content_html": "<p>Jeder arbeitende Mensch hat schon an einem Vorstellungsgespräch teilgenommen. Wer schon mal die Gelegenheit hatte am anderen Ende des Tisches zu sitzen, wird sich über folgende Tipps freuen. Viele von uns werden, meistens vom Chef, ins kalte Wasser geworfen. Er kommt um die Ecke und möchte, dass man sich zusammen einen Kandidaten anschaut. Vielleicht sogar ganz alleine ohne HR und ohne Chef. Natürlich reicht die Arbeitserfahrung aus, um ein fachliches Gespräch zu führen. Das denkt man zumindest. Dann nimmt das Chaos seinen Lauf.<br>\nIch habe aus meiner Erfahrung, um dieses Chaos einzufangen, einige Tipps zusammengestellt. Damit geht der Kandidat und du als Interviewer mit einem guten Gefühl aus dem Gespräch.Ich konzentriere mich auf das Fachgespräch und nicht auf das HR Gespräch. Im Idealfall ist man unter sich (unter Software-Entwicklern). <!-- endOfPreview --></p>\n<h4 id=\"1.-der-rote-faden%3A-halte-ihn-fest-und-kommuniziere-ihn.\" tabindex=\"-1\">1. Der rote Faden: Halte ihn fest und kommuniziere ihn. <a class=\"direct-link\" href=\"#1.-der-rote-faden%3A-halte-ihn-fest-und-kommuniziere-ihn.\">#</a></h4>\n<p>Denke dir eine Agenda für das Gespräch aus, kommuniziere sie an den Kandidaten (am Besten am Anfang des Gesprächs) und halte dich auch daran. Ich war schon in einigen Gesprächen, in denen ich nach der Begrüßung mit Fragen bombardiert wurde. Viele dieser Fragen hätte man vermeiden können, indem man mir eine Gelegenheit geboten hätte, mich vorzustellen. Ein roter Faden könnte wie folgt aussehen:</p>\n<ul>\n<li>Begrüßung, Klärung der Getränke, Smalltalk</li>\n<li>Kommunikation des &quot;roten Fadens&quot;, bzw. der Gesprächsagenda</li>\n<li>Vorstellung des Unternehmens</li>\n<li>Vorstellung aller Interviewer</li>\n<li>Klärung möglicher Fragen bis zu diesem Zeitpunkt</li>\n<li>Vorstellung Kandidat</li>\n<li>Gegenseitiges Kennenlernen durch Fachfragen</li>\n<li>Fragen des Kandidaten klären</li>\n<li>Kurzes Feedback</li>\n<li>Erklärung wie es weitergeht im Bewerbungsprozess</li>\n<li>Verabschiedung</li>\n</ul>\n<p>Der Kandidat weiß was auf ihn zukommt und das nimmt auch etwas seine Nervosität. Der Interviewer kann sich auf das Beobachten und Fragen konzentrieren und muss keine Agenda improvisieren.</p>\n<pre><code>Bereite dich auf das Gespräch und den Ablauf vor! \nGebe dem Gesprächsführer (deinem Kollegen oder sogar deinem Chef) Feedback, sollte er diesen Tipp nicht kennen.\n</code></pre>\n<hr/>\n<h4 id=\"2.-vor-dir-sitzt-ein-potentieller-kollege\" tabindex=\"-1\">2. Vor dir sitzt ein potentieller Kollege <a class=\"direct-link\" href=\"#2.-vor-dir-sitzt-ein-potentieller-kollege\">#</a></h4>\n<p>Auf der anderen Seite des Tisches vor dem Kandidaten zu sitzen, bedeutet, dass man eine kleine Machtposition für diesen Moment inne hat. Man stellt die Fragen und leitet das Gespräch. In dieser Situation habe ich des öfteren erlebt, wie der sonst nette und freundliche Kollege sich veränderte. Von der freundlichen Art blieb nicht viel übrig und es wurde eine fiese Frage nach der anderen gestellt, als würde man versuchen den Kandidaten fertig zu machen. Es gilt bei dem Gespräch nicht die Schwächen des Kandidaten aufzuzeigen, sondern seine Stärken.Man klärt die Frage ob und wie der Kandidat im Team dem Unternehmen helfen kann. Wer möchte es sich denn schon am Anfang mit einem neuen und potentiellen Kollegen verscherzen? Heutzutage in der Situation des Entwicklermangels bewirbt man sich auch beim Kandidaten, weil die Nachfrage so groß ist. Das sollte man während des Gesprächs im Hinterkopf behalten.</p>\n<pre><code>Gewinne einen neuen Kollegen und vernichte ihn nicht!\n</code></pre>\n<hr/>\n<h4 id=\"3.-stelle-keine-fragen%2C-auf-die-du-selber-keine-antwort-wei%C3%9Ft\" tabindex=\"-1\">3. Stelle keine Fragen, auf die du selber keine Antwort weißt <a class=\"direct-link\" href=\"#3.-stelle-keine-fragen%2C-auf-die-du-selber-keine-antwort-wei%C3%9Ft\">#</a></h4>\n<p>Ich habe in meinem vorherigen Artikel den Hinweis gegeben einen Block und einen Stift dabeizuhaben und Fragen, die man nicht beantworten kann, sich erklären zu lassen. Leider habe ich als Kandidat, als ich die Frage zurückgegeben habe, um etwas neues zu lernen, in verzweifelte Gesichter geschaut. Es wurde nervös geblättert und schnell die nächste Frage gestellt. Es ist leicht eine Fragen, die man sich aus dem Internet holt, zu stellen. Aber man sollte auch Herr der Antwort auf diese Frage sein. Es macht auch keinen guten Eindruck vor dem Kandidaten (und deinem Chef) in so eine Situation zu geraten.</p>\n<pre><code>Überlege dir die Fragen vorher und beantworte sie für dich!\n</code></pre>\n<hr/>\n<h4 id=\"4.-erz%C3%A4hle-die-wahrheit-und-besch%C3%B6nige-nicht-unn%C3%B6tig\" tabindex=\"-1\">4. Erzähle die Wahrheit und beschönige nicht unnötig <a class=\"direct-link\" href=\"#4.-erz%C3%A4hle-die-wahrheit-und-besch%C3%B6nige-nicht-unn%C3%B6tig\">#</a></h4>\n<p>Man möchte den Kandidaten für das Unternehmen gewinnen und das führt manchmal dazu, dass man anfängt Märchen zu erzählen. Das Unternehmen wird plötzlich vollständig Agil, es gibt freie Technologiewahl, überall sind grüne Wiesen für neue Projekte und Legacy-System kennt man nur aus dem Refactoring-Buch. Ein gut vorbereiteter Kandidat durchschaut diese Lügen mit ein paar Gegenfragen. Dies erzeugt wieder eine sehr unangenehme Situation. Man sollte bei der Wahrheit bleiben und vielleicht sogar von ein paar Problemen erzählen, die man mit Hilfe des Kandidaten angehen möchte. Aber auch hier ist vorsicht geboten. Zu viele negative Geschichten können abschreckend wirken.</p>\n<pre><code>Bleibe bei der Wahrheit und erzähle keine Märchen!\n</code></pre>\n<hr/>\n<h4 id=\"5.-zeige-aufrichtiges-interesse-und-h%C3%B6r-aktiv-zu\" tabindex=\"-1\">5. Zeige aufrichtiges Interesse und hör aktiv zu <a class=\"direct-link\" href=\"#5.-zeige-aufrichtiges-interesse-und-h%C3%B6r-aktiv-zu\">#</a></h4>\n<p>Für diesen Tipp ist etwas selbstreflexion notwendig. Jeder Mensch möchte am Liebsten immer von sich und seinen Erfahrungen erzählen. Das ist absolut in Ordnung. Allerdings ist ein Bewerbungsgespräch der falsche Rahmen, um von sich zu sprechen. Im Mittelpunkt steht einzig und allein der Kandidat. Man hat nur eine begrenzte Zeit, den potentiellen Kollegen einzuschätzen und zu bewerten. Das eine oder andere Mal musste ich mich, bzw. meine beisitzenden Kollegen in ihren Ausführungen über Technologien und ihre Erfahrungen bremsen. Der Kandidat sollte das Wort haben. Stelle ihm fragen über seine Arbeitsweisen, Technologien, Erfahrungen etc. und höre ihm auch zu. Mache dir dazu Notizen, die du später für das Feedback gegenüber der HR brauchst. Schenke dem Kandidaten deine ungeteilte Aufmerksamkeit. Als Kandidat war ich in einigen Gesprächen, in denen die Gesprächsführer auf ihrem Laptop oder auf Handy rumgetippt haben. Ich hatte das Gefühl ich rede mit mir selbst. Ein anderes Mal hing der Chef über seinen Stuhl und schaute gelangweilt drein. Das macht keinen guten Eindruck.</p>\n<pre><code>Du bist nicht der Mittelpunkt bei dem Gespräch. Informiere dich über aktives Zuhören.\n</code></pre>\n<hr/>\n<h4 id=\"6.-achte-auf-das-mindset-des-kandidaten\" tabindex=\"-1\">6. Achte auf das Mindset des Kandidaten <a class=\"direct-link\" href=\"#6.-achte-auf-das-mindset-des-kandidaten\">#</a></h4>\n<p>In den Nachbesprechungen mit den Kollegen der HR wurden viele Kandidaten oft aussortiert, weil sie nicht über die notwendige Erfahrungen in dem benötigten Tech-Stack verfügten. Das halte ich für falsch. Wenn ein Kandidat das richtige Mindset, sprich die richtige Einstellung hat, habe ich immer für ihn gestimmt. Technologien, Arbeitsweisen, agile Methoden etc. kann man leichter dem Kandidaten beibringen. Wenn aber schon die Kinderstube fehlt, keine Motivation zu spüren ist oder die Teamfähigkeit zweifelhaft ist, dann ist das viel schlimmer. Wenn ein Kandidat spürbar für eine Sache brennt und unbedingt ein Thema lernen möchte, ist das die beste Vorraussetzung für eine gute Zusammenarbeit. Meine Leitfrage bei jedem Gespräch ist immer: &quot;Möchte ich diese Person in meinem Team haben?&quot;.</p>\n<pre><code>Technologien und Methoden biegen sich leider gerade als fehlende Softskills.\n</code></pre>\n<hr/>\n<h4 id=\"7.-gib-konstruktives-feedback\" tabindex=\"-1\">7. Gib konstruktives Feedback <a class=\"direct-link\" href=\"#7.-gib-konstruktives-feedback\">#</a></h4>\n<p>Am Ende des Gesprächs gebe ich immer ein Feedback wie sich der Kandidat geschlagen hat. Damit meine ich nicht, ob eine Anstellungen folgen wird, sondern wie das Gespräch verlaufen ist. Dabei gebe ich Tipps zum Vortragen des Lebenslaufs, lobe Stärken und mache auf Schwächen aufmerksam. Man sollte tunlichst vermeiden dem Kandidaten Hoffnung auf die Anstellung zu machen oder diese sogar in Aussicht zu stellen. Als Fachkollege hat man keine Kompetenz dazu und macht das Unternehmen angreifbar. Ich meine konstruktives Feedback zur Weiterentwicklung der Fähigkeiten und des Charakters. Als Einleitung eignet sich beispielhaft die Frage wie der Kandidat denkt, dass das Gespräch verlaufen ist. Daran kann man anknüpfen und ein gutes Feedback geben, warum oder warum nicht das Gespräch gut gelaufen ist.</p>\n<pre><code>Helfe dem Kandidaten sich weiterzuentwickeln.\n</code></pre>\n",
      "date_published": "2021-05-07T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0521/flutter-export-sqlite-db/",
      "url": "https://derkuba.de/content/posts/0521/flutter-export-sqlite-db/",
      "title": "How to export SQlite Database File in Flutter (Android)",
      "content_html": "<p>Eine der vielen Möglichkeiten für das Speichern von Daten innerhalb einer <a href=\"https://flutter.dev/\">Flutter-App</a> ist <a href=\"https://www.sqlite.org/index.html\">SQlite</a>. SQlite bietet eine Relationale-Datenbank innerhalb der App ohne externe Ahhänigkeit und ohne Datenverkehr über das Internet. <!-- endOfPreview -->Es ist sehr praktisch und für kleinere, einfachere Statements performant. Wer eine Übersicht über die Möglichkeiten zum Speichern von Daten innerhalb von Flutter sucht, dem empfehle ich folgenden <a href=\"https://objectbox.io/flutter-databases-sqflite-hive-objectbox-and-moor/\">Artikel (flutter-databases-sqflite-hive-objectbox-and-moor)</a>. <a href=\"https://flutter.dev/docs/cookbook/persistence/sqlite\">Die Flutter-Doku</a> erklärt sehr gut wie man SQlite in seiner App integriert.</p>\n<p>Ich habe eine App gebaut, die Daten in der SQlite abspeichert. Nun stand ich vor dem Problem wie ich die Daten migrieren kann, falls ich z.B. das Handy wechsle. Da SQlite die Daten in eine *.db Datei schreibt, muss es eine Möglichkeit geben an diese Datei auf dem Telefon zu gelangen und diese aus der App zu exportieren. Wie man das erreichen kann, möchte ich mit euch teilen.</p>\n<p>Voraussetzung ist eine Flutter App und folgende Bibliotheken:</p>\n<pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"highlight-line\"><span class=\"token key atrule\">dependencies</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">flutter</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">        <span class=\"token key atrule\">sdk</span><span class=\"token punctuation\">:</span> flutter</span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">sqflite</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span></span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">permission_handler</span><span class=\"token punctuation\">:</span> ^7.0.0</span><br><span class=\"highlight-line\">    <span class=\"token key atrule\">downloads_path_provider</span><span class=\"token punctuation\">:</span> ^0.1.0</span></code></pre>\n<ul>\n<li><strong>sqflite</strong>: SQlite-Bibliothek</li>\n<li><strong>path</strong>: Pfade</li>\n<li><strong>permission_handler</strong>: Rechte auf dem Gerät</li>\n<li><strong>downloads_path_provider</strong>: Pfad zum Downloads-Ordner</li>\n</ul>\n<p>Die Idee der Umsetzung war folgende:</p>\n<ol>\n<li>Überprüfe die Schreibrechte auf dem Gerät.</li>\n<li>Finde den Pfad zur *.db-Datei.</li>\n<li>Öffne diese Datei und schreibe eine Kopie in das Download-Verzeichnis des Telefons.</li>\n</ol>\n<br/>\n<h4 id=\"1.-schreibrechte\" tabindex=\"-1\">1. Schreibrechte <a class=\"direct-link\" href=\"#1.-schreibrechte\">#</a></h4>\n<p>Damit man Dateien auf dem Telefon schreiben und lesen kann, benötigt man Schreibrechte. <strong>Achtung!</strong> Ich beziehe mich hier nur auf das Android-System.<br>\nUm an Schreibrechte zu gelangen muss man folgende Zeilen in die Datei <strong><em>/android/app/src/main/AndroidManifest.xml</em></strong> hinzufügen.</p>\n<pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>uses-permission</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.permission.READ_EXTERNAL_STORAGE<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></span><br><span class=\"highlight-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>uses-permission</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.permission.WRITE_EXTERNAL_STORAGE<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></span></code></pre>\n<p>Damit der Nutzer überhaupt mitbekommt, dass diese Rechte benötigt werden, empfehle ich das Paket <em>permission_handler</em>. Damit kann man den Nutzer komfortabel auf Schreibrechte hinweisen und diese direkt auch abfragen.</p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token keyword\">var</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token class-name\">Permission</span><span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isDenied<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token class-name\">Permission</span><span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Die erste Zeile fragt das System an, ob überhaupt Rechte in der oben beschriebenen xml eingetragen wurden und dann das Telefon, ob der Telefonnutzer die Rechte freigegeben hat. Die dritte Zeile lässt einen Dialog erscheinen, der dem Nutzer diese Auwahl anbietet.</p>\n<p><img src=\"/content/img/0521/right-granted.png\" alt=\"schreibrechte\" title=\"schreibrechte\"></p>\n<p>Wurden diese Rechte erlaubt, können wir die Dateien schreiben.</p>\n<h4 id=\"2.-dateipfade\" tabindex=\"-1\">2. Dateipfade <a class=\"direct-link\" href=\"#2.-dateipfade\">#</a></h4>\n<p>Die Dateipfade sind etwas versteckt und wir benötigen die oben genannten Module als Hilfe.</p>\n<p><strong>Pfad zur bestehenden Datenbank.db</strong></p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token class-name\">String</span> dbName <span class=\"token operator\">=</span> <span class=\"token string\">\"doggie_database.db\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// name of the db</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">var</span> databasesPath <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getDatabasesPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// default database path</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">var</span> innerPath <span class=\"token operator\">=</span> <span class=\"token function\">join</span><span class=\"token punctuation\">(</span>databasesPath<span class=\"token punctuation\">,</span> dbName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>innerPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// /data/user/0/com.example.flutter_sqlite_database_export/databases/doggie_database.db</span></span></code></pre>\n<p><strong>Pfad ins Downloadverzeichnis</strong></p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token class-name\">Directory</span> tempDir <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token class-name\">DownloadsPathProvider</span><span class=\"token punctuation\">.</span>downloadsDirectory<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token class-name\">String</span> tempPath <span class=\"token operator\">=</span> tempDir<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span></span></code></pre>\n<p><strong>Ausflug in dein Android-Datenbankverzeichnis</strong><br>\nWer in seine bestehende und laufende Applikation reinschauen möchte, dem empfehle ich im Android-Studio den <strong><em>Device-File-Explorer</em></strong>.</p>\n<p><img src=\"/content/img/0521/file-explorer.png\" alt=\"device file explorer\" title=\"device file explorer\"></p>\n<p>Unter <strong><em>/data/data/[name eurer applikation]/databases/nameEurerDB.db</em></strong> findet ihr eure SQlite Datenbank und könnte diese exportieren.</p>\n<h4 id=\"3.-datenbank.db-exportieren\" tabindex=\"-1\">3. Datenbank.db exportieren <a class=\"direct-link\" href=\"#3.-datenbank.db-exportieren\">#</a></h4>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token keyword\">var</span> dbFile <span class=\"token operator\">=</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>innerPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">var</span> filePath <span class=\"token operator\">=</span> tempPath <span class=\"token operator\">+</span> <span class=\"token string\">'/$dbName'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">var</span> dbFileBytes <span class=\"token operator\">=</span> dbFile<span class=\"token punctuation\">.</span><span class=\"token function\">readAsBytesSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">var</span> bytes <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteData</span><span class=\"token punctuation\">.</span><span class=\"token function\">view</span><span class=\"token punctuation\">(</span>dbFileBytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">final</span> buffer <span class=\"token operator\">=</span> bytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">writeAsBytes</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">  buffer<span class=\"token punctuation\">.</span><span class=\"token function\">asUint8List</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">    dbFileBytes<span class=\"token punctuation\">.</span>offsetInBytes<span class=\"token punctuation\">,</span> dbFileBytes<span class=\"token punctuation\">.</span>lengthInBytes</span><br><span class=\"highlight-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die Datenbank-Datei wird als Bytes gelesen, und im Standard Dart I/O Verfahren von einem Ort zum anderen geschrieben. So erhält man eine Datenbank-Export für die in der App verwendete Datenbank.</p>\n<p>Hier nochmal die ganze Methode samt Aufruf:</p>\n<pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"highlight-line\"><span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">File</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">_writeDBFileToDownloadFolder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token class-name\">String</span> dbName <span class=\"token operator\">=</span> <span class=\"token string\">\"doggie_database.db\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> databasesPath <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getDatabasesPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> innerPath <span class=\"token operator\">=</span> <span class=\"token function\">join</span><span class=\"token punctuation\">(</span>databasesPath<span class=\"token punctuation\">,</span> dbName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>innerPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token class-name\">Directory</span> tempDir <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token class-name\">DownloadsPathProvider</span><span class=\"token punctuation\">.</span>downloadsDirectory<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token class-name\">String</span> tempPath <span class=\"token operator\">=</span> tempDir<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> dbFile <span class=\"token operator\">=</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>innerPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> filePath <span class=\"token operator\">=</span> tempPath <span class=\"token operator\">+</span> <span class=\"token string\">'/$dbName'</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> dbFileBytes <span class=\"token operator\">=</span> dbFile<span class=\"token punctuation\">.</span><span class=\"token function\">readAsBytesSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">var</span> bytes <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteData</span><span class=\"token punctuation\">.</span><span class=\"token function\">view</span><span class=\"token punctuation\">(</span>dbFileBytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">final</span> buffer <span class=\"token operator\">=</span> bytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">writeAsBytes</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">.</span><span class=\"token function\">asUint8List</span><span class=\"token punctuation\">(</span></span><br><span class=\"highlight-line\">        dbFileBytes<span class=\"token punctuation\">.</span>offsetInBytes<span class=\"token punctuation\">,</span> dbFileBytes<span class=\"token punctuation\">.</span>lengthInBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></span><br><span class=\"highlight-line\">onPressed<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">var</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token class-name\">Permission</span><span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isDenied<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">await</span> <span class=\"token class-name\">Permission</span><span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">  <span class=\"token class-name\">File</span> file <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">_writeDBFileToDownloadFolder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// not null safe</span></span><br><span class=\"highlight-line\">    <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></span><br><span class=\"highlight-line\"></span></code></pre>\n<p>Schaut man nun auf dem Telefon über die App &quot;Files&quot; in das Downloadverzeichnis, findet man die besagte Datei.</p>\n<p>Great Success! :-)</p>\n<p>Diese Code-Blöcke eingebacken in die Flutter-Starter-Applikation habe ich unter <a href=\"https://github.com/derKuba/flutter-sqlite-database-export\">Github</a> für euch zur Verfügung gestellt.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a></p>\n<p><strong><em>Nachtrag vom 07.05.2021</em></strong><br>\nAuf Android Q reicht der oben erwähnte Zusatz in der XML nicht aus. Man muss noch folgendes ergänzen:</p>\n<pre><code>  android:requestLegacyExternalStorage=&quot;true&quot;\n</code></pre>\n<p>sodass die <strong><em>/android/app/src/main/AndroidManifest.xml</em></strong> wie folgt aussieht:</p>\n<pre><code>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  package=&quot;com.example.flutter_sqlite_database_export&quot;&gt;\n  &lt;application\n    android:label=&quot;flutter_sqlite_database_export&quot;\n    android:requestLegacyExternalStorage=&quot;true&quot;\n    android:icon=&quot;@mipmap/ic_launcher&quot;&gt;\n    ....\n    &lt;/application&gt;\n    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;/&gt;\n    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;\n&lt;/manifest&gt;\n</code></pre>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-05-02T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0421/typescript-spread-operator-aha/",
      "url": "https://derkuba.de/content/posts/0421/typescript-spread-operator-aha/",
      "title": "Spass mit Typescript: Spread-Operator AHA-Moment",
      "content_html": "<p>Diese Woche bin ich über den Spread-Operator gestolpert und möchte diese Erfahrung teilen. <!-- endOfPreview --></p>\n<p>Folgendes Szenario:<br>\nIch möchte ein Objekt erstellen, dass aus einem Key &quot;Name eines Testfalls&quot; und als Value ein weiteres Objekt aus benannnte Zahlenpaaren enthält. Ich habe dazu ein Array aus Namen der Testfälle und ein ein Objekt, das ein Objektschema enthält.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> testCases <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"testcase 1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"testcase 2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"testcase 3\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token keyword\">const</span> schema <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">     <span class=\"token string\">\"first\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        c<span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"second\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        c<span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"third\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        c<span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Aus den Namen und dem Schema, soll dann ein großes Objekt entstehen, das wie folgt aussieht.</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> testDataDefaults <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token string\">\"testcase 0\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token string\">\"first\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            c<span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">         <span class=\"token string\">\"second\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            c<span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">         <span class=\"token string\">\"third\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            c<span class=\"token operator\">:</span> <span class=\"token number\">0</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Man schreibt ganz schnell eine kleine Schleife über die Namen der Testfälle, initiiert das Sammelobjekt und setzt für jeden Testfall das Schema:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> testDataDefaults <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">testCases<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>testCase <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    testDataDefaults<span class=\"token punctuation\">[</span>testCase<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span>numbers<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Die Zeile {...numbers} erzeugt ein Klon des Schemas und weißt ihm dann dem Namen des Testfalls zu.</p>\n<p>Dieses DefaultObjekt wird dann im nächsten Schritt mit echten Daten gefüllt. Mein erster Ansatz ohne viel nachzudenken war wie folgt:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\">testDataDefaults<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">23</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">testDataDefaults<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">testDataDefaults<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token number\">13</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Meine Erwartung war, dass im ersten Testcase das &quot;first&quot;-Objekt an der Stelle &quot;a&quot; die Zahl 23 enthält. Die Wahrheit sah anders aus:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 0'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 1'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 2'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Waaaaaat.</p>\n<p>Laut <a href=\"https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_f%C3%BCr_objektliterale\">https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_für_objektliterale</a> hätte doch alles klappen sollen.</p>\n<p>Schnell mal googeln wie man sonst noch Objekte klonen kann:</p>\n<p><a href=\"https://www.samanthaming.com/tidbits/70-3-ways-to-clone-objects/\">https://www.samanthaming.com/tidbits/70-3-ways-to-clone-objects/</a></p>\n<p>Also nochmal von vorne und das mit allen 3 Lösungen:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\">tests<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>testCase <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    spreadMapped<span class=\"token punctuation\">[</span>testCase<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span>numbers<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    jsonMapped<span class=\"token punctuation\">[</span>testCase<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>numbers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\">    objectAssignMapped<span class=\"token punctuation\">[</span>testCase<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> numbers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">spreadMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">23</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">spreadMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">spreadMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>c <span class=\"token operator\">=</span> <span class=\"token number\">13</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">jsonMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">23</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">jsonMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">jsonMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>c <span class=\"token operator\">=</span> <span class=\"token number\">13</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">objectAssignMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">23</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">objectAssignMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">objectAssignMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>c <span class=\"token operator\">=</span> <span class=\"token number\">13</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>und das Ergebnis ist auch etwas durchwachsen:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\"><span class=\"token comment\">// spread</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 0'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 1'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token comment\">// json</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 0'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 1'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// Object assign</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 0'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 1'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token operator\">...</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Der Spreadoperator und das Object.assign halten nicht so ganz was sie im ersten Moment versprechen. Ich bin über die Formulierung &quot;flache Klonen&quot; gestolpert. Es wird zwar das Defaultobjekt geklont, allerdings bleiben die Referenzen von &quot;first&quot;, &quot;second&quot;, &quot;third&quot; erhalten. Das JSON-Konstrukt geht über das flache Klonen hinaus.</p>\n<p>Die Zuweisung über spreadMapped[&quot;testcase 0&quot;].first.a = 23; funktioniert nicht. Man muss das zugewiesene Object mit einem frischen Objekt überschreiben:</p>\n<pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"highlight-line\">spreadMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    <span class=\"token operator\">...</span>spreadMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token operator\">...</span>spreadMapped<span class=\"token punctuation\">[</span><span class=\"token string\">\"testcase 0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        a<span class=\"token operator\">:</span> <span class=\"token number\">23</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\">// output</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 0'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">  <span class=\"token string\">'testcase 1'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">    first<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    second<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">    third<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Das war mein hartes Learning der Woche. Code gibts unter<br>\n<a href=\"https://github.com/derKuba/fun-with-typescript/tree/main/240121-spread-aha-moment\">Code gibts unter</a></p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a></p>\n",
      "date_published": "2021-04-24T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0421/so-klappt-jedes-vorstellungsgespraech/",
      "url": "https://derkuba.de/content/posts/0421/so-klappt-jedes-vorstellungsgespraech/",
      "title": "So klappt fast jedes Vorstellungsgespräch",
      "content_html": "<p>In den letzten Jahren konnte ich in weit über hundert Vorstellungsgesprächen reichlich Erfahrung sammeln, sei es als Kandidat oder als technischer Fachkollege. Diese Erfahrung habe ich in folgende Punkte gepackt, die jedes Gespräch erfolgreicher machen. <!-- endOfPreview -->Als Software-Entwickler beziehe ich mich ausschließlich auf die IT-Branche. Die Tipps sind bestimmt auch in anderen Branchen zu gebrauchen, aber das kann ich nicht näher bewerten.</p>\n<h4 id=\"1.-%C3%BCbung-macht-den-meister\" tabindex=\"-1\">1. Übung macht den Meister <a class=\"direct-link\" href=\"#1.-%C3%BCbung-macht-den-meister\">#</a></h4>\n<p>Je öfter man sich der Situation des Bewerbungsgespräches stellt, desto sicherer tritt man auf. Ich empfehle das Gespräch mit Freunden oder Familie zu üben. Sollte niemand verfügbar sein, empfehle ich das Bewerben auf Stellen, die man gar nicht unbedingt antreten möchte.</p>\n<p><strong><em>Regel:</em> Geht zu jedem Bewerbungsgespräch zu dem ihr eingeladen werdet!</strong></p>\n<hr/>\n<h4 id=\"2.-dein-lebenslauf-ist-eine-geschichte\" tabindex=\"-1\">2. Dein Lebenslauf ist eine Geschichte <a class=\"direct-link\" href=\"#2.-dein-lebenslauf-ist-eine-geschichte\">#</a></h4>\n<p>Viele Kandidaten können Ihren Lebenslauf nicht geordnet, chronologisch und frei erzählen. Man stellt als Interviewer immer wieder die gleichen Fragen, damit man eine Vergleichbarkeit der Kandidaten erreicht. Hier kann man sehr leicht punkten, wenn man seine Meilensteine flüssig vortragen kann.</p>\n<ul>\n<li>Dabei fängt man am besten beim Schulabschluss an</li>\n<li>Welche Motivation gab es für das Studium oder die Ausbildung?</li>\n<li>Was waren die Schwerpunkte des Studiums/der Ausbildung?</li>\n<li>Darauf folgt eine Beschreibung der bisherigen Jobs. Hierbei gilt es herauszustellen, was man <strong>selber</strong> für Aufgaben erfüllt hat und nicht, was die Firma gemacht hat: Was waren die wesentlichen Aufgaben und die eingesetzten Technologien? Was hat man gelernt?</li>\n<li>Der nächste Punkte ist die Motivation für die Neuausrichtung: Was hat mich beim letzten Arbeitgeber dazu bewegt mich jetzt hier in dieser Firma zu bewerben? <strong>Achtung:</strong> Nicht die letzte Firma schlecht machen, sondern die Schwachpunkte als Lernziele im neuen Unternehmen nennen.</li>\n<li>Zum Schluss sollte man den Bogen zur aktuellen Firma spannen: Was erhoffe ich mir von der neuen Firma?</li>\n<li><em>Gut:</em> neue Technologie, agile Arbeitsweise, viele Teams, Mentoren, interessante Branche</li>\n<li><em>Schlecht:</em> Gehalt, Aufstieg, weniger Arbeit</li>\n</ul>\n<hr/>\n<h4 id=\"3.-wer-f%C3%BChrt-das-interview%3F\" tabindex=\"-1\">3. Wer führt das Interview? <a class=\"direct-link\" href=\"#3.-wer-f%C3%BChrt-das-interview%3F\">#</a></h4>\n<p>In der Terminbestätigung zum Gespräch stehen oft die Teilnehmer des Gesprächs. Diese Gelegenheit sollte immer genutzt werden und ich empfehle die teilnehmenden Personen zu recherchieren:</p>\n<ul>\n<li>Wenn eine Person aus der HR/Personalabteilung dabei ist, sollte man die klassischen Bewerbungsfragen (Stärke/Schwächen, größte Erfolge, wo sehe ich mich in fünf Jahre etc.) üben, bzw. vorbereiten.<br>\n<strong>Sei im Stande die Standard-HR-Fragen zu beantworten</strong></li>\n<li>Interessant wird es wenn ein Leiter/Chef und ein Fachkollege dabei sind. In diesem Fall sollte man die eigene Technologie-Liste durchgehen und nachschauen, ob man zu jeder Technologie auch tiefere Fragen beantworten kann. <strong>Fachsimpeln hilft. Oft möchte der Fachkollege vor dem Chef beweisen, wie viel er weiß und kommt nicht dazu, Fragen zu stellen.</strong></li>\n</ul>\n<hr/>\n<h4 id=\"4.-m%C3%B6chten-sie-was-trinken%3F-ja\" tabindex=\"-1\">4. Möchten Sie was trinken? Ja <a class=\"direct-link\" href=\"#4.-m%C3%B6chten-sie-was-trinken%3F-ja\">#</a></h4>\n<p>Niemals das Getränk ablehnen. Man glaubt gar nicht wie oft die Stimme versagt. Wenn jetzt jemand los muss, um ein Getränk zu besorgen, macht es die Gesprächsdynamik kaputt. So ein Schluck Wasser bietet auch immer die Möglichkeit zum Nachdenken, und/oder um die Nervosität zu besiegen.<br>\n<strong><em>Regel:</em> Immer das Getränk annehmen!</strong></p>\n<hr/>\n<h4 id=\"5.-du-kannst-die-frage-nicht-beantworten%3F\" tabindex=\"-1\">5. Du kannst die Frage nicht beantworten? <a class=\"direct-link\" href=\"#5.-du-kannst-die-frage-nicht-beantworten%3F\">#</a></h4>\n<p>Das ist absolut kein Problem. Aber bitte fang nicht an zu faseln und denk dir nicht irgendwas aus. Jeder erfahrene Kollege wird sofort deine Unsicherheit merken und dir eventuell absagen. Antworte ehrlich, dass du es nicht weißt und gib die Frage zurück. Der Fachkollege erklärt die sicherlich vor dem Chef in aller Ausführlichkeit die Antwort und du konntest was dazulernen.</p>\n<hr/>\n<h4 id=\"6.-unbequeme-klamotten\" tabindex=\"-1\">6. Unbequeme Klamotten <a class=\"direct-link\" href=\"#6.-unbequeme-klamotten\">#</a></h4>\n<p>Leider zu häufig sitzen vor mir potentielle Kollegen im Anzug. Sie schwitzen, fummeln sich am Kragen herum und der Anzug sitzt zu eng oder zu weit. Man merkte deutlich, dass sie sich nicht wohlfühlen. Es ist nicht schlimm vorher den täglichen Dresscode zu erfragen. Die Webseite des Unternehmens zeigt deutlich was dort kleidungstechnisch zu erwarten ist. Kleider machen zwar Leute, zeigen aber auch deutlich, ob du dich wohlfühlst. Wenn man keine Anzüge mag, ist eine Stoffhose mit Polohemd total in Ordnung. Hierbei gilt es zu beachten, ob man sich als Consultant bewirbt oder für eine Inhouse-Entwicklung.<br>\nEin gepflegtes Äußeres und saubere Kleidung sind absolut ausreichend. Es muss nicht immer der Anzug sein.</p>\n<hr/>\n<h4 id=\"7.-stift-und-block\" tabindex=\"-1\">7. Stift und Block <a class=\"direct-link\" href=\"#7.-stift-und-block\">#</a></h4>\n<p>Nur einer von fünfzehn Kandidaten bringt etwas zu schreiben mit. Das halte ich für grob fahrlässig. Wie bereits erklärt, kann man sich Fragen, auf die man keine Antwort wusste, notieren. Notierenswert sind auch:</p>\n<ul>\n<li>Unbekannte Technologien</li>\n<li>Kunden</li>\n<li>Goodies</li>\n<li>Teamgröße / Arbeitsweisen</li>\n<li>... etc</li>\n</ul>\n<p>Durch die Nervosität hat man nach dem Gespräch oft vieles wieder vergessen. Außerdem wirkt man interessiert und gut organisiert, wenn man sich ab und zu etwas notiert.</p>\n<hr/>\n<h4 id=\"8.-haben-sie-noch-fragen%3F\" tabindex=\"-1\">8. Haben Sie noch Fragen? <a class=\"direct-link\" href=\"#8.-haben-sie-noch-fragen%3F\">#</a></h4>\n<p>Die Kandidaten ohne Stift und Block haben in der Regel eine oder zwei Fragen. Die anderen Fragen fallen ihnen nicht mehr ein. Das ist fatal. Wenn man keine Fragen hat, hat man sich nicht mit dem Unternehmen auseinandergesetzt. Es zeigt z.B.,</p>\n<ul>\n<li>dass man unvorbereitet kommt,</li>\n<li>dass man kein Interesse an der Arbeitsweise</li>\n<li>oder an der Unternehmensstruktur hat</li>\n</ul>\n<p>Mein schönstes Bewerbungsgespräch als Kandidat hatte ich als das potentielle neue Team mich in die Zange nehmen wollte. Ich saß alleine im Kreis, umringt vom Team. Da ich aber meinen Block mit unendlich vielen Fragen hatte, konnte ich den Spieß umdrehen.<br>\nFolgende Aspekte eignen sich gut für Fragen:</p>\n<ul>\n<li>Teamgröße und Arbeitsweise?</li>\n<li>Wie sieht ein Arbeitsalltag aus (von morgens bis abends)?</li>\n<li>Wie wird Agilität gelebt?</li>\n<li>Wie wird Qualität sichergestellt?</li>\n<li>Wie ist der Ablauf eines Features vom Konzept bis zum Live-Deployment?</li>\n<li>Wie, wann und womit wird deployed?</li>\n<li>Wie arbeiten die Teams miteinander und wie läuft die Kommunikation?</li>\n<li>Stellt euch euren optimalen Arbeitsalltag vor und stellt dazu Fragen auf.</li>\n</ul>\n<hr/>\n<h4 id=\"9.-gespr%C3%A4chs(n)ettikette\" tabindex=\"-1\">9. Gesprächs(n)ettikette <a class=\"direct-link\" href=\"#9.-gespr%C3%A4chs(n)ettikette\">#</a></h4>\n<p>Es hört sich zwar selbstverständlich an, ist es aber leider viel zu oft nicht:</p>\n<ul>\n<li>Pünktlichkeit</li>\n<li>aufrecht sitzen,</li>\n<li>kein Hibbeln</li>\n<li>Augenkontakt</li>\n<li>vollständige Sätze</li>\n<li>aussprechen lassen<br>\nViele Vergehen kann man sicherlich mit der Nervosität begründen und sie sind auch nachvollziehbar. Sie hinterlassen jedoch schnell einen negativen Eindruck beim Interviewer. Doch daran kann man arbeiten. Ich empfehle zur Übung ein kurzes Rollenspiel, das aufgenommen, oder durch Dritte beobachtet wird, die einem Feedback geben</li>\n</ul>\n<hr/>\n<h4 id=\"10.-was-motiviert-dich%3F\" tabindex=\"-1\">10. Was motiviert dich? <a class=\"direct-link\" href=\"#10.-was-motiviert-dich%3F\">#</a></h4>\n<p>Ich habe selten erlebt, dass unbedingt ein bestimmtes Skill-Set gesucht wird. Es geht immer um den Menschen dahinter. Man möchte eine bestimmte Einstellung/Attitüde finden. Alles andere kann man dem neuen Kollegen beibringen. Niemand wird (auf Dauer) einen genialen Entwickler, der nicht im Team arbeiten kann, keine anderen Meinungen akzeptiert und allen anderen das Leben zur Hölle macht, behalten oder überhaupt erst einstellen. Langer Rede, kurzer Sinn. Was treibt dich an? Was brauchst du zum Arbeiten? Was möchtest du lernen? In welche Richtung möchtest du dich weiterentwickeln? Beantworte diese Fragen für dich und bringe sie ungefragt in das Gespräch ein.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a></p>\n",
      "date_published": "2021-04-17T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0421/11nty-bullma-error/",
      "url": "https://derkuba.de/content/posts/0421/11nty-bullma-error/",
      "title": "Bulma und Prism.js erzeugen CSS-Fehler in der Darstellung",
      "content_html": "<p>Wer 11nty mit <a href=\"https://bulma.io/\">Bulma</a> als CSS-Framework nutzt und zusätzlich den Code-Highlighter <a href=\"https://prismjs.com/\">PrismJS </a> hinzufügt, bekommt folgenden Darstellungsfehler:</p>\n<p><img src=\"/content/img/0421/bulma-css-error.png\" alt=\"bulma css error\" title=\"Bulma-Prism-Css-Error\"></p>\n<p>Ich habe etwas recherchiert und bin auf folgdenen Artikel gestoßen:</p>\n<p><a href=\"https://www.darraghoriordan.com/2019/01/20/bulma-prismjs-in-gatsby-css-conflicts/\">https://www.darraghoriordan.com/2019/01/20/bulma-prismjs-in-gatsby-css-conflicts/</a></p>\n<p>Diesen Codeblog aus oben genanten Artikel in mein CSS kopiert und alles wird normalisieren. Alles funktioniert nun wie es soll:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.token.tag,<br><span class=\"highlight-line\">.token.content,</span><br>.token.number</span> <span class=\"token punctuation\">{</span><br><span class=\"highlight-line\">    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">white-space</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> inherit<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span></span></code></pre>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a>.</p>\n<p><br>\nTausend Dank fürs Lesen!</p>\n<p>Kuba</p>\n",
      "date_published": "2021-04-05T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0421/11nty-excerpt/",
      "url": "https://derkuba.de/content/posts/0421/11nty-excerpt/",
      "title": "11nty Inhalt anzeigen in der Liste",
      "content_html": "<p>Wer in der Liste aller Posts zusätzlich den Inhalt anzeigen möchte, hat out-of-the-box nur die Möglichkeit den gesamten Inhalt anzuzeigen. Wenn man z.B. nur den ersten Satz eines Posts anzeigen möchte, muss dies dem Javascript von Eleventy noch beibringen. <!-- endOfPreview --></p>\n<p>Als Grundlage wird der <a href=\"https://github.com/11ty/eleventy-base-blog\">11nty-Starter-Blog</a> verwendet.</p>\n<p>Wenn man diesen startet, erhält man folgendes Bild. Es zeigt die Post-Liste mit Titel, Datum und Tags, aber ohne Auszug des Inhalts.<br>\n<img src=\"/content/img/0421/excerpt-place.png\" alt=\"11nty starter\" title=\"11nty starter\"></p>\n<div class=\"has-text-right image-subline\">Bild 1: Post-Liste im Starter Template</div>\n<p>Die rote Schrift zeigt den Ort an, an dem der Inhalt eingefügt werden soll.<br>\nFür die Umsetzung habe ich mich an folgenden Seiten orientiert:</p>\n<p><a href=\"https://github.com/muenzpraeger/eleventy-chirpy-blog-template\">https://github.com/muenzpraeger/eleventy-chirpy-blog-template</a> und<br>\n<a href=\"https://keepinguptodate.com/pages/2019/06/creating-blog-with-eleventy/\">https://keepinguptodate.com/pages/2019/06/creating-blog-with-eleventy/</a> .</p>\n<p>Die Datei <strong>.eleventy.js</strong> benötigt folgende Funktion:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"highlight-line\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">extractExcerpt</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">post</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">,</span> <span class=\"token string\">\"templateContent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> post<span class=\"token punctuation\">.</span>templateContent<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  <span class=\"token keyword\">const</span> markerIndex <span class=\"token operator\">=</span> content<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;!-- endOfPreview -->\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">  </span><br><span class=\"highlight-line\">  <span class=\"token keyword\">return</span> markerIndex <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> content<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> markerIndex<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"...\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Zunächst wird geprüft ob das Post-Object das Feld &quot;templateContent&quot; besitzt. Dies sollte von Eleventy bereitgestellt werden. Anschließend wird es in der Content-Variable gecached. Der Inhalt wird zerschnitten vom Anfang bis zum Schnippsel <strong>&quot;<!-- endOfPreview -->&quot;</strong>. Hier kann natürlich jedes beliebiges, aber möglichst vom Inhalt abhebendes Tag verwendet werden. Das ist ein Marker, der das Ende der Auszuges, bzw. der Vorschau, beschreibt. Wenn kein Marker gefunden wird, wird ein leerer String zurückgegeben.</p>\n<p>Nun muss Eleventy beigebracht werden, diese Funktion zu werden. Es wäre z.B. als Filter möglich, aber ein &quot;Shortcut&quot; erscheint für mich praktischer. Ein Shortcut sieht aus wie folgt:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"highlight-line\"><span class=\"token comment\">// remove whitespace between {} and %</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span> excerpt pageObject <span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span></span></code></pre>\n<p><em>Bitte die Leerzeichen entfernen zwischen den runden Klammern und dem Prozentzeichen. Leider rendert 11nty den Ausschnitt ohne Leerzeichen!</em></p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"highlight-line\">eleventyConfig<span class=\"token punctuation\">.</span><span class=\"token function\">addShortcode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"excerpt\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">post</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span></span><br><span class=\"highlight-line\">    <span class=\"token function\">extractExcerpt</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">)</span></span><br><span class=\"highlight-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Das Eleventy-Config-Object nun ein neues Schlagwort &quot;excerpt&quot; (Auszug) und übergibt als Parameter wie im vorherigen Code-Snippet angezeigt das Postobjekt.</p>\n<p>Wenn man diesen Shortcut nun in der Datei <em>/_include/postlist.njk</em> innerhalb der Listen-Tags (&lt; li &gt; &lt;/ li &gt;) einfügt, erhält man seinen gewünschten Inhaltsauszug.</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"highlight-line\"> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span> excerpt post <span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span></span></code></pre>\n<p>Dieser Marker kann jetzt in den Markdown-Dateien der Blogposts verwendet werden(<strong>/posts/*.md</strong>). Einfach nach gewünschter Länge des Auszuges das <strong>&lt; !-- endOfPreview -- &gt;</strong> einfügen.</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"highlight-line\">Leverage agile frameworks to provide a robust <span class=\"token comment\">&lt;!-- endOfPreview --></span></span><br><span class=\"highlight-line\">synopsis for high level overviews. Iterative </span></code></pre>\n<p><img src=\"/content/img/0421/excerpt-final.png\" alt=\"11nty starter\" title=\"11nty starter\"><br>\n<img src=\"/content/img/0421/excerpt-place.png\" alt=\"11nty starter\" title=\"11nty starter\"></p>\n<div class=\"has-text-right image-subline\">Bild 2: Post-Liste mit Inhaltvorschau</div>\n<p><br>\nDie Codebeispiele findet ihr auf <a href=\"https://github.com/derKuba/eleventy-examples\">Github/derKuba</a>.</p>\n<p>Ihr habt Fragen oder Anregungen? Schreibt mir bei <a href=\"https://twitter.com/der_kuba\">Twitter</a></p>\n",
      "date_published": "2021-04-04T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0421/11nty-tutorial/",
      "url": "https://derkuba.de/content/posts/0421/11nty-tutorial/",
      "title": "11nty Blog mit eigenem Html-Template",
      "content_html": "<p>Seit langer Zeit sitzt in meinem Kopf der Gedanke einen Blog aufzusetzen. Die Umsetzung möchte ich direkt als ersten Post nutzen. <!-- endOfPreview --> Als Anforderung habe ich folgende Punkte:</p>\n<ul>\n<li>keine Datenbank</li>\n<li>keine aufwendigen, runtime-bedürftigen Programmiersprachen</li>\n<li>Output soll eine statische Seite sein.</li>\n</ul>\n<p>Die Google-Suche &quot;static site generator 2021&quot; hat folgende Seite hervorgebracht:</p>\n<p><a href=\"https://www.techradar.com/best/static-site-generators\">https://www.techradar.com/best/static-site-generators</a></p>\n<p>An erster Stelle steht Hugo. Ein sehr schneller Generator, der auf GO setzt. Hugo hatte ich bereits ausprobiert. Es ist sehr schnell und einfach, solange man ein fertiges Template verwendet. Möchte man dagegen ein eigenes, war relativ viel Gefrickel notwenig ( Stand Hugo 0.40 ). Das muss doch einfacher gehen.<br>\nDa ich ein großes Herz für JS habe, las sich 11nty sehr gut. Es sollte schnell, einfach und ohne Frameworks wie React oder Angular auskommen. Und siehe da es ging sehr gut.</p>\n<p>Techstack:</p>\n<ul>\n<li><a href=\"https://git-scm.com/\">git</a></li>\n<li><a href=\"https://nodejs.org/de/\">nodejs @v14.16.0</a></li>\n<li><a href=\"https://www.npmjs.com/\">npm @6.14.11</a></li>\n<li><a href=\"https://www.11ty.dev/\">11nty @0.12.1 </a></li>\n<li><a href=\"https://bulma.io/\">Bulma @0.9.2</a></li>\n<li><a href=\"https://prismjs.com/\">prism @1.23.0 </a></li>\n</ul>\n<p>Mit folgenden Schritten habe ich diesen Blog aufgesetzt:</p>\n<ol>\n<li>\n<p><strong>HTML-Template erstellen</strong></p>\n<ul>\n<li>HTML-Grundstruktur mit\n<ul>\n<li>Menu,</li>\n<li>Navigation,</li>\n<li>Blogdetail</li>\n<li>Footer</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>11nty Starter</strong> Blog download unter: <a href=\"https://github.com/11ty/eleventy-base-blog\">https://github.com/11ty/eleventy-base-blog</a></p>\n<ul>\n<li>Starter-Template klonen und installieren</li>\n<li>Aufbau und Struktur</li>\n<li>Custom-Template überführen</li>\n</ul>\n</li>\n<li>\n<p>das <strong>HTML-Template</strong> in das Startertemplate überführen</p>\n</li>\n</ol>\n<h3 id=\"los-gehts\" tabindex=\"-1\">Los gehts <a class=\"direct-link\" href=\"#los-gehts\">#</a></h3>\n<h4 id=\"vorbedingung\" tabindex=\"-1\">Vorbedingung <a class=\"direct-link\" href=\"#vorbedingung\">#</a></h4>\n<ul>\n<li>Nodejs und NPM sind installiert</li>\n</ul>\n<h4 id=\"1.-template-anlegen\" tabindex=\"-1\">1. Template anlegen <a class=\"direct-link\" href=\"#1.-template-anlegen\">#</a></h4>\n<p>Ein einfaches und klassisches HTML Layout ist schnell aufgesetzt. Um Zeit zu Sparen habe ich als CSS-Framework <a href=\"https://bulma.io/\">Bulma</a> genommen und das Template in folgende Teile geteilt:</p>\n<ul>\n<li><a href=\"https://bulma.io/documentation/components/navbar/\">Navigation</a></li>\n<li>Content</li>\n<li>Sidebar</li>\n<li><a href=\"https://bulma.io/documentation/layout/footer/\">Footer</a></li>\n</ul>\n<p><img src=\"/content/img/layout.png\" alt=\"html layout\" title=\"HTML Template\"></p>\n<div class=\"has-text-right image-subline\">Bild 1: Aufteilung Layout</div>\n<p><br>\nEs eignen sich auch andere Layouts und andere CSS-Frameworks. Ich hatte Lust auf eine Bootstrap-Alternative.</p>\n<h4 id=\"2.-11nty-starter-installieren\" tabindex=\"-1\">2. 11nty Starter installieren <a class=\"direct-link\" href=\"#2.-11nty-starter-installieren\">#</a></h4>\n<p><a href=\"https://github.com/11ty/eleventy-base-blog\">Unter der oben genannten Adresse</a> findet man das Standard 11nty Starter Paket. Wenn man auf den &quot;Clone&quot;-Button klickt, erhält man die Git-Url.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token comment\"># für ssh</span></span><br><span class=\"highlight-line\"><span class=\"token function\">git</span> clone git@github.com:11ty/eleventy-base-blog.git mein-neuer-blog</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># oder https</span></span><br><span class=\"highlight-line\"><span class=\"token function\">git</span> clone https://github.com/11ty/eleventy-base-blog.git mein-neuer-blog</span></code></pre>\n<p>Nun muss man in den Ordner navigieren und die Abhängigkeiten installieren:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> mein-neuer-blog</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span></span></code></pre>\n<p><br>\n<strong>11nty Starter-Blog starten</strong></p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run server</span><br><span class=\"highlight-line\"><span class=\"token comment\"># oder</span></span><br><span class=\"highlight-line\">npx eleventy --serve</span></code></pre>\n<p>und man sollte folgendes sehen:</p>\n<p><img src=\"/content/img/0421/11nty-starter.png\" alt=\"11nty starter\" title=\"11nty starter\"></p>\n<div class=\"has-text-right image-subline\">Bild 2: Ausschnitte Starter Template</div> \n<p><br>\nMan erkennt auf den ersten Blick, die dynamischen Elemente, die wir in unserem eigenen Template benötigen.</p>\n<ul>\n<li>Navigation: Menüpunkte</li>\n<li>Content: Posts</li>\n<li>Sidebar: die Tags</li>\n</ul>\n<p><img src=\"/content/img/0421/starter-elements.png\" alt=\"11nty starter elements\" title=\"11nty starter elements\"></p>\n<p><br>\n<strong>Aufbau und Dateistruktur</strong><br>\nFür etwas mehr Übersicht habe ich einige Dateien in Ordner aufgeteilt. CSS und JS habe ich in das Verzeichnis Template gezogen, Inhaltsspezifische Dateien in den Ordner &quot;Content&quot; und CI-spezifische Dateien habe ich gelöscht.</p>\n<p><img src=\"/content/img/0421/file-structure.png\" alt=\"Verzeichnisstruktur\" title=\"verzeichnisstruktur\"></p>\n<div class=\"has-text-right image-subline\">Bild 3: Verzeichnisstruktur</div> \n<p><br>\nDie Dateien untergliedern sich in</p>\n<ul>\n<li><strong>&quot;.njk&quot;</strong> (Template),</li>\n<li><strong>&quot;.md&quot;</strong> (Content / Posts)</li>\n<li><strong>&quot;.json&quot;</strong> ( Meta und Config )</li>\n<li><strong>&quot;.eleventy.js&quot;</strong> ( 11nty Konfiguration).</li>\n</ul>\n<p><br>\n<strong>Selbstgebautes Template verwenden</strong></p>\n<p>Navigation:</p>\n<ul>\n<li>neue Datei anlegen unter &quot;_includes/layouts/navigation.njk&quot;.</li>\n<li>inhalt der eigenen Navigation in diese Datei kopiert.</li>\n<li>unter &quot;_includes/layouts/base.njk&quot; findet man das Seitenlayout mit HTML-Struktur.<br>\nZeilen 13-23 beinhalten was wir benötigen. Wir entnehmen den metadata.title als Titel für unseren Blog und packen die for-Schleife (Z. 18-24)<br>\nin unsere nav-container.</li>\n</ul>\n<p>vorher:<br>\n<img src=\"/content/img/0421/starter-header.png\" alt=\"navigation\" title=\"Navigation\"><div class=\"has-text-right image-subline\">Bild 4: Code Starter-Header</div> (leider rendert an dieser Stelle 11nty den nunjuk-code und ich muss ein Bild verwenden. Vielleicht kennt jemand einen workaround?)</p>\n<p>nachher:<br>\n<img src=\"/content/img/0421/bulma-header.png\" alt=\"header\" title=\"Header\"></p>\n<div class=\"has-text-right image-subline\">Bild 5: Bulma Header</div>\nWir überführen die For-Schleife in den navigation-items container.\nAnschließend\n<ul>\n<li>in der &quot;base.njk&quot;-datei löschen wir nun den Inhalt wie er auf dem vorher-Bild zu sehen ist und ersetzen in durch <div class=\"clear-image\"><img src=\"/content/img/0421/include-header.png\" alt=\"Include Header\" title=\"Include Header\"></div> und die Datei sollte wie folgt aussehen:<br>\n<img src=\"/content/img/0421/base.png\" alt=\"Base Datei\" title=\"Base-Datei\"></li>\n</ul>\n<div class=\"has-text-right image-subline\">Bild 6: Starter-Template Base</div>\nNeben den eigenen CSS-Dateien, dem Bulma-Burger-Menu-Javascript, sieht man die Navigation und den Footer.\n<p><br>\n<strong>Content:</strong></p>\n<p>Der Content-Bereich unterscheidet sich jetzt je nachdem auf welcher Seite man sich befindet. Ich möchte, dass auf der Hauptseite die Sidebar sichtbar ist und auf den Post-Detailseiten nicht. Daher werden jetzt die vorgefertigten Dateien <strong>/_includes/layouts/</strong> <em>-home.njk</em> und <em>-postlist.njk</em> für die Hauptseite relevant und die<em>post.njk</em> Datei für die Detailseite.</p>\n<p>Für Content-Bereich wurde der Starter-Template Code mit dem eigenen Template verbunden:</p>\n<p><img src=\"/content/img/0421/content-area.png\" alt=\"content\" title=\"Content Bereicht\"></p>\n<div class=\"has-text-right image-subline\">Bild 7:Content Bereich</div>\n<p>Neben dem kopierten Standardcode entdeckt der findige Leser auch den Bereich in Zeile 19. Dort mappe ich anhand des Indexes die Bulma Tag Klassen an den Tag, um so ein wenig Farbe in den Seitenbereich zu bekommen. Dafür habe ich einen weiteren Short-Code angelegt in der <em>.eleventy.js-</em>Datei angelegt:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"highlight-line\">    eleventyConfig<span class=\"token punctuation\">.</span><span class=\"token function\">addPairedShortcode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"badge\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> badge <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-black\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-primary\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-link\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-success\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-dark\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-warning\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-danger\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> badge<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            <span class=\"token keyword\">return</span> badge<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> index <span class=\"token operator\">%</span> badge<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> badge<span class=\"token punctuation\">[</span>color<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Für den Detail-Bereich wurde der Starter-Template Code mit dem eigenen Template verbunden:</p>\n<p><img src=\"/content/img/0421/post-detail.png\" alt=\"post detail\" title=\"Post Detail Seite\"></p>\n<div class=\"has-text-right image-subline\">Bild 8: Detail Seite</div>\n<p>Für die List der Posts wurde der Starter-Template Code mit dem eigenen Template verbunden:</p>\n<p><img src=\"/content/img/0421/postlist.png\" alt=\"Post-List\" title=\"Liste aller Posts\"></p>\n<div class=\"has-text-right image-subline\">Bild 9: Detailseite Posts</div>\n<p>Auch hier verwende ich noch einen weitern Custom-Filter &quot;readingTime&quot;, den ich aus dem weiteren Starter-Template<br>\n<a href=\"https://github.com/muenzpraeger/eleventy-chirpy-blog-template/blob/main/.eleventy.js\">https://github.com/muenzpraeger/eleventy-chirpy-blog-template/blob/main/.eleventy.js</a> entnommen habe, um die Lesedauer anzuzeigen.</p>\n<p>Damit niemand den Code abtippen muss, habe ich die relevanten Dateien auf <a href=\"https://github.com/derKuba/eleventy-examples\">Github/derKuba</a> abgelegt.</p>\n",
      "date_published": "2021-03-30T00:00:00Z"
    },{
      "id": "https://derkuba.de/content/posts/0421/11nty-tutorial-part-one/",
      "url": "https://derkuba.de/content/posts/0421/11nty-tutorial-part-one/",
      "title": "11nty Blog mit eigenem Html-Template",
      "content_html": "<p>Seit langer Zeit sitzt in meinem Kopf der Gedanke einen Blog aufzusetzen. Die Umsetzung möchte ich direkt als ersten Post nutzen. <!-- endOfPreview --> Als Anforderung habe ich folgende Punkte:</p>\n<ul>\n<li>keine Datenbank</li>\n<li>keine aufwendigen, runtime-bedürftigen Programmiersprachen</li>\n<li>Output soll eine statische Seite sein.</li>\n</ul>\n<p>Die Google-Suche &quot;static site generator 2021&quot; hat folgende Seite hervorgebracht:</p>\n<p><a href=\"https://www.techradar.com/best/static-site-generators\">https://www.techradar.com/best/static-site-generators</a></p>\n<p>An erster Stelle steht Hugo. Ein sehr schneller Generator, der auf GO setzt. Hugo hatte ich bereits ausprobiert. Es ist sehr schnell und einfach, solange man ein fertiges Template verwendet. Möchte man dagegen ein eigenes, war relativ viel Gefrickel notwenig ( Stand Hugo 0.40 ). Das muss doch einfacher gehen.<br>\nDa ich ein großes Herz für JS habe, las sich 11nty sehr gut. Es sollte schnell, einfach und ohne Frameworks wie React oder Angular auskommen. Und siehe da es ging sehr gut.</p>\n<p>Techstack:</p>\n<ul>\n<li><a href=\"https://git-scm.com/\">git</a></li>\n<li><a href=\"https://nodejs.org/de/\">nodejs @v14.16.0</a></li>\n<li><a href=\"https://www.npmjs.com/\">npm @6.14.11</a></li>\n<li><a href=\"https://www.11ty.dev/\">11nty @0.12.1 </a></li>\n<li><a href=\"https://bulma.io/\">Bulma @0.9.2</a></li>\n<li><a href=\"https://prismjs.com/\">prism @1.23.0 </a></li>\n</ul>\n<p>Mit folgenden Schritten habe ich diesen Blog aufgesetzt:</p>\n<ol>\n<li>\n<p><strong>HTML-Template erstellen</strong></p>\n<ul>\n<li>HTML-Grundstruktur mit\n<ul>\n<li>Menu,</li>\n<li>Navigation,</li>\n<li>Blogdetail</li>\n<li>Footer</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>11nty Starter</strong> Blog download unter: <a href=\"https://github.com/11ty/eleventy-base-blog\">https://github.com/11ty/eleventy-base-blog</a></p>\n<ul>\n<li>Starter-Template klonen und installieren</li>\n<li>Aufbau und Struktur</li>\n<li>Custom-Template überführen</li>\n</ul>\n</li>\n<li>\n<p>das <strong>HTML-Template</strong> in das Startertemplate überführen</p>\n</li>\n</ol>\n<h3 id=\"los-gehts\" tabindex=\"-1\">Los gehts <a class=\"direct-link\" href=\"#los-gehts\">#</a></h3>\n<h4 id=\"vorbedingung\" tabindex=\"-1\">Vorbedingung <a class=\"direct-link\" href=\"#vorbedingung\">#</a></h4>\n<ul>\n<li>Nodejs und NPM sind installiert</li>\n</ul>\n<h4 id=\"1.-template-anlegen\" tabindex=\"-1\">1. Template anlegen <a class=\"direct-link\" href=\"#1.-template-anlegen\">#</a></h4>\n<p>Ein einfaches und klassisches HTML Layout ist schnell aufgesetzt. Um Zeit zu Sparen habe ich als CSS-Framework <a href=\"https://bulma.io/\">Bulma</a> genommen und das Template in folgende Teile geteilt:</p>\n<ul>\n<li><a href=\"https://bulma.io/documentation/components/navbar/\">Navigation</a></li>\n<li>Content</li>\n<li>Sidebar</li>\n<li><a href=\"https://bulma.io/documentation/layout/footer/\">Footer</a></li>\n</ul>\n<p><img src=\"/content/img/layout.png\" alt=\"html layout\" title=\"HTML Template\"></p>\n<div class=\"has-text-right image-subline\">Bild 1: Aufteilung Layout</div>\n<p><br>\nEs eignen sich auch andere Layouts und andere CSS-Frameworks. Ich hatte Lust auf eine Bootstrap-Alternative.</p>\n<h4 id=\"2.-11nty-starter-installieren\" tabindex=\"-1\">2. 11nty Starter installieren <a class=\"direct-link\" href=\"#2.-11nty-starter-installieren\">#</a></h4>\n<p><a href=\"https://github.com/11ty/eleventy-base-blog\">Unter der oben genannten Adresse</a> findet man das Standard 11nty Starter Paket. Wenn man auf den &quot;Clone&quot;-Button klickt, erhält man die Git-Url.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token comment\"># für ssh</span></span><br><span class=\"highlight-line\"><span class=\"token function\">git</span> clone git@github.com:11ty/eleventy-base-blog.git mein-neuer-blog</span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\"><span class=\"token comment\"># oder https</span></span><br><span class=\"highlight-line\"><span class=\"token function\">git</span> clone https://github.com/11ty/eleventy-base-blog.git mein-neuer-blog</span></code></pre>\n<p>Nun muss man in den Ordner navigieren und die Abhängigkeiten installieren:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token builtin class-name\">cd</span> mein-neuer-blog</span><br><span class=\"highlight-line\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span></span></code></pre>\n<p><br>\n<strong>11nty Starter-Blog starten</strong></p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"highlight-line\"><span class=\"token function\">npm</span> run server</span><br><span class=\"highlight-line\"><span class=\"token comment\"># oder</span></span><br><span class=\"highlight-line\">npx eleventy --serve</span></code></pre>\n<p>und man sollte folgendes sehen:</p>\n<p><img src=\"/content/img/0421/11nty-starter.png\" alt=\"11nty starter\" title=\"11nty starter\"></p>\n<div class=\"has-text-right image-subline\">Bild 2: Ausschnitte Starter Template</div> \n<p><br>\nMan erkennt auf den ersten Blick, die dynamischen Elemente, die wir in unserem eigenen Template benötigen.</p>\n<ul>\n<li>Navigation: Menüpunkte</li>\n<li>Content: Posts</li>\n<li>Sidebar: die Tags</li>\n</ul>\n<p><img src=\"/content/img/0421/starter-elements.png\" alt=\"11nty starter elements\" title=\"11nty starter elements\"></p>\n<p><br>\n<strong>Aufbau und Dateistruktur</strong><br>\nFür etwas mehr Übersicht habe ich einige Dateien in Ordner aufgeteilt. CSS und JS habe ich in das Verzeichnis Template gezogen, Inhaltsspezifische Dateien in den Ordner &quot;Content&quot; und CI-spezifische Dateien habe ich gelöscht.</p>\n<p><img src=\"/content/img/0421/file-structure.png\" alt=\"Verzeichnisstruktur\" title=\"verzeichnisstruktur\"></p>\n<div class=\"has-text-right image-subline\">Bild 3: Verzeichnisstruktur</div> \n<p><br>\nDie Dateien untergliedern sich in</p>\n<ul>\n<li><strong>&quot;.njk&quot;</strong> (Template),</li>\n<li><strong>&quot;.md&quot;</strong> (Content / Posts)</li>\n<li><strong>&quot;.json&quot;</strong> ( Meta und Config )</li>\n<li><strong>&quot;.eleventy.js&quot;</strong> ( 11nty Konfiguration).</li>\n</ul>\n<p><br>\n<strong>Selbstgebautes Template verwenden</strong></p>\n<p>Navigation:</p>\n<ul>\n<li>neue Datei anlegen unter &quot;_includes/layouts/navigation.njk&quot;.</li>\n<li>inhalt der eigenen Navigation in diese Datei kopiert.</li>\n<li>unter &quot;_includes/layouts/base.njk&quot; findet man das Seitenlayout mit HTML-Struktur.<br>\nZeilen 13-23 beinhalten was wir benötigen. Wir entnehmen den metadata.title als Titel für unseren Blog und packen die for-Schleife (Z. 18-24)<br>\nin unsere nav-container.</li>\n</ul>\n<p>vorher:<br>\n<img src=\"/content/img/0421/starter-header.png\" alt=\"navigation\" title=\"Navigation\"><div class=\"has-text-right image-subline\">Bild 4: Code Starter-Header</div> (leider rendert an dieser Stelle 11nty den nunjuk-code und ich muss ein Bild verwenden. Vielleicht kennt jemand einen workaround?)</p>\n<p>nachher:<br>\n<img src=\"/content/img/0421/bulma-header.png\" alt=\"header\" title=\"Header\"></p>\n<div class=\"has-text-right image-subline\">Bild 5: Bulma Header</div>\nWir überführen die For-Schleife in den navigation-items container.\nAnschließend\n<ul>\n<li>in der &quot;base.njk&quot;-datei löschen wir nun den Inhalt wie er auf dem vorher-Bild zu sehen ist und ersetzen in durch <div class=\"clear-image\"><img src=\"/content/img/0421/include-header.png\" alt=\"Include Header\" title=\"Include Header\"></div> und die Datei sollte wie folgt aussehen:<br>\n<img src=\"/content/img/0421/base.png\" alt=\"Base Datei\" title=\"Base-Datei\"></li>\n</ul>\n<div class=\"has-text-right image-subline\">Bild 6: Starter-Template Base</div>\nNeben den eigenen CSS-Dateien, dem Bulma-Burger-Menu-Javascript, sieht man die Navigation und den Footer.\n<p><br>\n<strong>Content:</strong></p>\n<p>Der Content-Bereich unterscheidet sich jetzt je nachdem auf welcher Seite man sich befindet. Ich möchte, dass auf der Hauptseite die Sidebar sichtbar ist und auf den Post-Detailseiten nicht. Daher werden jetzt die vorgefertigten Dateien <strong>/_includes/layouts/</strong> <em>-home.njk</em> und <em>-postlist.njk</em> für die Hauptseite relevant und die<em>post.njk</em> Datei für die Detailseite.</p>\n<p>Für Content-Bereich wurde der Starter-Template Code mit dem eigenen Template verbunden:</p>\n<p><img src=\"/content/img/0421/content-area.png\" alt=\"content\" title=\"Content Bereicht\"></p>\n<div class=\"has-text-right image-subline\">Bild 7:Content Bereich</div>\n<p>Neben dem kopierten Standardcode entdeckt der findige Leser auch den Bereich in Zeile 19. Dort mappe ich anhand des Indexes die Bulma Tag Klassen an den Tag, um so ein wenig Farbe in den Seitenbereich zu bekommen. Dafür habe ich einen weiteren Short-Code angelegt in der <em>.eleventy.js-</em>Datei angelegt:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"highlight-line\">    eleventyConfig<span class=\"token punctuation\">.</span><span class=\"token function\">addPairedShortcode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"badge\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> badge <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-black\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-primary\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-link\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-success\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-dark\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-warning\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">            <span class=\"token string\">\"is-danger\"</span><span class=\"token punctuation\">,</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> badge<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><br><span class=\"highlight-line\">            <span class=\"token keyword\">return</span> badge<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">        <span class=\"token punctuation\">}</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> index <span class=\"token operator\">%</span> badge<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\"></span><br><span class=\"highlight-line\">        <span class=\"token keyword\">return</span> badge<span class=\"token punctuation\">[</span>color<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><br><span class=\"highlight-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre>\n<p>Für den Detail-Bereich wurde der Starter-Template Code mit dem eigenen Template verbunden:</p>\n<p><img src=\"/content/img/0421/post-detail.png\" alt=\"post detail\" title=\"Post Detail Seite\"></p>\n<div class=\"has-text-right image-subline\">Bild 8: Detail Seite</div>\n<p>Für die List der Posts wurde der Starter-Template Code mit dem eigenen Template verbunden:</p>\n<p><img src=\"/content/img/0421/postlist.png\" alt=\"Post-List\" title=\"Liste aller Posts\"></p>\n<div class=\"has-text-right image-subline\">Bild 9: Detailseite Posts</div>\n<p>Auch hier verwende ich noch einen weitern Custom-Filter &quot;readingTime&quot;, den ich aus dem weiteren Starter-Template<br>\n<a href=\"https://github.com/muenzpraeger/eleventy-chirpy-blog-template/blob/main/.eleventy.js\">https://github.com/muenzpraeger/eleventy-chirpy-blog-template/blob/main/.eleventy.js</a> entnommen habe, um die Lesedauer anzuzeigen.</p>\n<p>Damit niemand den Code abtippen muss, habe ich die relevanten Dateien auf <a href=\"https://github.com/derKuba/eleventy-examples\">Github/derKuba</a> abgelegt.</p>\n",
      "date_published": "2021-03-30T00:00:00Z"
    }
  ]
}
